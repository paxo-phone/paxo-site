import{e,_ as t,o as i,i as r,x as o,a,n as s,t as n,m as l,b as d,E as c,c as h,s as p,D as u,d as f,f as m,r as v,g,h as b,j as _,k as y,B as w,l as x,p as k,q as E,u as S,T as A,v as C,w as T,y as R}from"./styles-XdZATt8s.js";let I;function $(e,t=B){const i=F(e,t);return i&&(i.tabIndex=0,i.focus()),i}function L(e,t=B){const i=P(e,t);return i&&(i.tabIndex=0,i.focus()),i}function D(e,t=B){for(let i=0;i<e.length;i++){const r=e[i];if(0===r.tabIndex&&t(r))return{item:r,index:i}}return null}function F(e,t=B){for(const i of e)if(t(i))return i;return null}function P(e,t=B){for(let i=e.length-1;i>=0;i--){const r=e[i];if(t(r))return r}return null}function O(e,t,i=B,r=!0){if(t){const o=function(e,t,i=B,r=!0){for(let o=1;o<e.length;o++){const a=(o+t)%e.length;if(a<t&&!r)return null;const s=e[a];if(i(s))return s}return e[t]?e[t]:null}(e,t.index,i,r);return o&&(o.tabIndex=0,o.focus()),o}return $(e,i)}function z(e,t,i=B,r=!0){if(t){const o=function(e,t,i=B,r=!0){for(let o=1;o<e.length;o++){const a=(t-o+e.length)%e.length;if(a>t&&!r)return null;const s=e[a];if(i(s))return s}return e[t]?e[t]:null}(e,t.index,i,r);return o&&(o.tabIndex=0,o.focus()),o}return L(e,i)}function B(e){return!e.disabled}const U={ArrowDown:"ArrowDown",ArrowLeft:"ArrowLeft",ArrowUp:"ArrowUp",ArrowRight:"ArrowRight",Home:"Home",End:"End"};class M{constructor(e){this.handleKeydown=e=>{const t=e.key;if(e.defaultPrevented||!this.isNavigableKey(t))return;const i=this.items;if(!i.length)return;const r=D(i,this.isActivatable);e.preventDefault();const o=this.isRtl();let a=null;switch(t){case U.ArrowDown:case o?U.ArrowLeft:U.ArrowRight:a=O(i,r,this.isActivatable,this.wrapNavigation());break;case U.ArrowUp:case o?U.ArrowRight:U.ArrowLeft:a=z(i,r,this.isActivatable,this.wrapNavigation());break;case U.Home:a=$(i,this.isActivatable);break;case U.End:a=L(i,this.isActivatable)}a&&r&&r.item!==a&&(r.item.tabIndex=-1)},this.onDeactivateItems=()=>{const e=this.items;for(const t of e)this.deactivateItem(t)},this.onRequestActivation=e=>{this.onDeactivateItems();const t=e.target;this.activateItem(t),t.focus()},this.onSlotchange=()=>{const e=this.items;let t=!1;for(const i of e){!(!i.disabled&&i.tabIndex>-1)||t?i.tabIndex=-1:(t=!0,i.tabIndex=0)}if(t)return;const i=F(e,this.isActivatable);i&&(i.tabIndex=0)};const{isItem:t,getPossibleItems:i,isRtl:r,deactivateItem:o,activateItem:a,isNavigableKey:s,isActivatable:n,wrapNavigation:l}=e;this.isItem=t,this.getPossibleItems=i,this.isRtl=r,this.deactivateItem=o,this.activateItem=a,this.isNavigableKey=s,this.isActivatable=n,this.wrapNavigation=l??(()=>!0)}get items(){const e=this.getPossibleItems(),t=[];for(const i of e){if(this.isItem(i)){t.push(i);continue}const e=i.item;e&&this.isItem(e)&&t.push(e)}return t}activateNextItem(){const e=this.items,t=D(e,this.isActivatable);return t&&(t.item.tabIndex=-1),O(e,t,this.isActivatable,this.wrapNavigation())}activatePreviousItem(){const e=this.items,t=D(e,this.isActivatable);return t&&(t.item.tabIndex=-1),z(e,t,this.isActivatable,this.wrapNavigation())}}const N=new Set(Object.values(U));class H extends r{get items(){return this.listController.items}constructor(){super(),this.listController=new M({isItem:e=>e.hasAttribute("md-list-item"),getPossibleItems:()=>this.slotItems,isRtl:()=>"rtl"===getComputedStyle(this).direction,deactivateItem:e=>{e.tabIndex=-1},activateItem:e=>{e.tabIndex=0},isNavigableKey:e=>N.has(e),isActivatable:e=>!e.disabled&&"text"!==e.type}),this.internals=this.attachInternals(),this.internals.role="list",this.addEventListener("keydown",this.listController.handleKeydown)}render(){return o`
      <slot
        @deactivate-items=${this.listController.onDeactivateItems}
        @request-activation=${this.listController.onRequestActivation}
        @slotchange=${this.listController.onSlotchange}>
      </slot>
    `}activateNextItem(){return this.listController.activateNextItem()}activatePreviousItem(){return this.listController.activatePreviousItem()}}t([i({flatten:!0})],H.prototype,"slotItems",void 0);const q=a`:host{background:var(--md-list-container-color, var(--md-sys-color-surface, #fef7ff));color:unset;display:flex;flex-direction:column;outline:none;padding:8px 0;position:relative}
`;class W extends H{}W.styles=[q],customElements.define("ew-list",W);class Z extends r{constructor(){super(...arguments),this.multiline=!1}render(){return o`
      <slot name="container"></slot>
      <slot class="non-text" name="start"></slot>
      <div class="text">
        <slot name="overline" @slotchange=${this.handleTextSlotChange}></slot>
        <slot
          class="default-slot"
          @slotchange=${this.handleTextSlotChange}></slot>
        <slot name="headline" @slotchange=${this.handleTextSlotChange}></slot>
        <slot
          name="supporting-text"
          @slotchange=${this.handleTextSlotChange}></slot>
      </div>
      <slot class="non-text" name="trailing-supporting-text"></slot>
      <slot class="non-text" name="end"></slot>
    `}handleTextSlotChange(){let e=!1,t=0;for(const i of this.textSlots)if(V(i)&&(t+=1),t>1){e=!0;break}this.multiline=e}}function V(e){for(const i of e.assignedNodes({flatten:!0})){var t;const e=i.nodeType===Node.ELEMENT_NODE,r=i.nodeType===Node.TEXT_NODE&&(null===(t=i.textContent)||void 0===t?void 0:t.match(/\S/));if(e||r)return!0}return!1}t([s({type:Boolean,reflect:!0})],Z.prototype,"multiline",void 0),t([function(t){return(i,r)=>e(i,r,{get(){return(this.renderRoot??I??(I=document.createDocumentFragment())).querySelectorAll(t)}})}(".text slot")],Z.prototype,"textSlots",void 0);const j=a`:host{color:var(--md-sys-color-on-surface, #1d1b20);font-family:var(--md-sys-typescale-body-large-font, var(--md-ref-typeface-plain, Roboto));font-size:var(--md-sys-typescale-body-large-size, 1rem);font-weight:var(--md-sys-typescale-body-large-weight, var(--md-ref-typeface-weight-regular, 400));line-height:var(--md-sys-typescale-body-large-line-height, 1.5rem);align-items:center;box-sizing:border-box;display:flex;gap:16px;min-height:56px;overflow:hidden;padding:12px 16px;position:relative;text-overflow:ellipsis}:host([multiline]){min-height:72px}[name=overline]{color:var(--md-sys-color-on-surface-variant, #49454f);font-family:var(--md-sys-typescale-label-small-font, var(--md-ref-typeface-plain, Roboto));font-size:var(--md-sys-typescale-label-small-size, 0.6875rem);font-weight:var(--md-sys-typescale-label-small-weight, var(--md-ref-typeface-weight-medium, 500));line-height:var(--md-sys-typescale-label-small-line-height, 1rem)}[name=supporting-text]{color:var(--md-sys-color-on-surface-variant, #49454f);font-family:var(--md-sys-typescale-body-medium-font, var(--md-ref-typeface-plain, Roboto));font-size:var(--md-sys-typescale-body-medium-size, 0.875rem);font-weight:var(--md-sys-typescale-body-medium-weight, var(--md-ref-typeface-weight-regular, 400));line-height:var(--md-sys-typescale-body-medium-line-height, 1.25rem)}[name=trailing-supporting-text]{color:var(--md-sys-color-on-surface-variant, #49454f);font-family:var(--md-sys-typescale-label-small-font, var(--md-ref-typeface-plain, Roboto));font-size:var(--md-sys-typescale-label-small-size, 0.6875rem);font-weight:var(--md-sys-typescale-label-small-weight, var(--md-ref-typeface-weight-medium, 500));line-height:var(--md-sys-typescale-label-small-line-height, 1rem)}[name=container]::slotted(*){inset:0;position:absolute}.default-slot{display:inline}.default-slot,.text ::slotted(*){overflow:hidden;text-overflow:ellipsis}.text{display:flex;flex:1;flex-direction:column;overflow:hidden}
`;let G=class extends Z{};G.styles=[j],G=t([n("md-item")],G);const K=Symbol.for(""),Y=e=>{if((null==e?void 0:e.r)===K)return null==e?void 0:e._$litStatic$},J=(e,...t)=>({_$litStatic$:t.reduce(((t,i,r)=>t+(e=>{if(void 0!==e._$litStatic$)return e._$litStatic$;throw Error(`Value passed to 'literal' function must be a 'literal' result: ${e}. Use 'unsafeStatic' to pass non-literal values, but\n            take care to ensure page security.`)})(i)+e[r+1]),e[0]),r:K}),X=new Map,Q=(e=>(t,...i)=>{const r=i.length;let o,a;const s=[],n=[];let l,d=0,c=!1;for(;d<r;){for(l=t[d];d<r&&void 0!==(a=i[d],o=Y(a));)l+=o+t[++d],c=!0;d!==r&&n.push(a),s.push(l),d++}if(d===r&&s.push(t[r]),c){const e=s.join("$$lit$$");void 0===(t=X.get(e))&&(s.raw=s,X.set(e,t=s)),i=n}return e(t,...i)})(o),ee=l(r);class te extends ee{constructor(){super(...arguments),this.disabled=!1,this.type="text",this.isListItem=!0,this.href="",this.target=""}get isDisabled(){return this.disabled&&"link"!==this.type}willUpdate(e){this.href&&(this.type="link"),super.willUpdate(e)}render(){return this.renderListItem(o`
      <md-item>
        <div slot="container">
          ${this.renderRipple()} ${this.renderFocusRing()}
        </div>
        <slot name="start" slot="start"></slot>
        <slot name="end" slot="end"></slot>
        ${this.renderBody()}
      </md-item>
    `)}renderListItem(e){const t="link"===this.type;let i;switch(this.type){case"link":i=J`a`;break;case"button":i=J`button`;break;default:i=J`li`}const r="text"!==this.type,o=t&&this.target?this.target:c;return Q`
      <${i}
        id="item"
        tabindex="${this.isDisabled||!r?-1:0}"
        ?disabled=${this.isDisabled}
        role="listitem"
        aria-selected=${this.ariaSelected||c}
        aria-checked=${this.ariaChecked||c}
        aria-expanded=${this.ariaExpanded||c}
        aria-haspopup=${this.ariaHasPopup||c}
        class="list-item ${h(this.getRenderClasses())}"
        href=${this.href||c}
        target=${o}
        @focus=${this.onFocus}
      >${e}</${i}>
    `}renderRipple(){return"text"===this.type?c:o` <md-ripple
      part="ripple"
      for="item"
      ?disabled=${this.isDisabled}></md-ripple>`}renderFocusRing(){return"text"===this.type?c:o` <md-focus-ring
      @visibility-changed=${this.onFocusRingVisibilityChanged}
      part="focus-ring"
      for="item"
      inward></md-focus-ring>`}onFocusRingVisibilityChanged(e){}getRenderClasses(){return{disabled:this.isDisabled}}renderBody(){return o`
      <slot></slot>
      <slot name="overline" slot="overline"></slot>
      <slot name="headline" slot="headline"></slot>
      <slot name="supporting-text" slot="supporting-text"></slot>
      <slot
        name="trailing-supporting-text"
        slot="trailing-supporting-text"></slot>
    `}onFocus(){-1===this.tabIndex&&this.dispatchEvent(new Event("request-activation",{bubbles:!0,composed:!0}))}focus(){var e;null===(e=this.listItemRoot)||void 0===e||e.focus()}click(){this.listItemRoot?this.listItemRoot.click():super.click()}}te.shadowRootOptions={...r.shadowRootOptions,delegatesFocus:!0},t([s({type:Boolean,reflect:!0})],te.prototype,"disabled",void 0),t([s({reflect:!0})],te.prototype,"type",void 0),t([s({type:Boolean,attribute:"md-list-item",reflect:!0})],te.prototype,"isListItem",void 0),t([s()],te.prototype,"href",void 0),t([s()],te.prototype,"target",void 0),t([d(".list-item")],te.prototype,"listItemRoot",void 0);const ie=a`:host{display:flex;-webkit-tap-highlight-color:rgba(0,0,0,0);--md-ripple-hover-color: var(--md-list-item-hover-state-layer-color, var(--md-sys-color-on-surface, #1d1b20));--md-ripple-hover-opacity: var(--md-list-item-hover-state-layer-opacity, 0.08);--md-ripple-pressed-color: var(--md-list-item-pressed-state-layer-color, var(--md-sys-color-on-surface, #1d1b20));--md-ripple-pressed-opacity: var(--md-list-item-pressed-state-layer-opacity, 0.12)}:host(:is([type=button]:not([disabled]),[type=link])){cursor:pointer}md-focus-ring{z-index:1;--md-focus-ring-shape: 8px}a,button,li{background:none;border:none;cursor:inherit;padding:0;margin:0;text-align:unset;text-decoration:none}.list-item{border-radius:inherit;display:flex;flex:1;max-width:inherit;min-width:inherit;outline:none;-webkit-tap-highlight-color:rgba(0,0,0,0);width:100%}.list-item.interactive{cursor:pointer}.list-item.disabled{opacity:var(--md-list-item-disabled-opacity, 0.3);pointer-events:none}[slot=container]{pointer-events:none}md-ripple{border-radius:inherit}md-item{border-radius:inherit;flex:1;height:100%;color:var(--md-list-item-label-text-color, var(--md-sys-color-on-surface, #1d1b20));font-family:var(--md-list-item-label-text-font, var(--md-sys-typescale-body-large-font, var(--md-ref-typeface-plain, Roboto)));font-size:var(--md-list-item-label-text-size, var(--md-sys-typescale-body-large-size, 1rem));line-height:var(--md-list-item-label-text-line-height, var(--md-sys-typescale-body-large-line-height, 1.5rem));font-weight:var(--md-list-item-label-text-weight, var(--md-sys-typescale-body-large-weight, var(--md-ref-typeface-weight-regular, 400)));min-height:var(--md-list-item-one-line-container-height, 56px);padding-top:var(--md-list-item-top-space, 12px);padding-bottom:var(--md-list-item-bottom-space, 12px);padding-inline-start:var(--md-list-item-leading-space, 16px);padding-inline-end:var(--md-list-item-trailing-space, 16px)}md-item[multiline]{min-height:var(--md-list-item-two-line-container-height, 72px)}[slot=supporting-text]{color:var(--md-list-item-supporting-text-color, var(--md-sys-color-on-surface-variant, #49454f));font-family:var(--md-list-item-supporting-text-font, var(--md-sys-typescale-body-medium-font, var(--md-ref-typeface-plain, Roboto)));font-size:var(--md-list-item-supporting-text-size, var(--md-sys-typescale-body-medium-size, 0.875rem));line-height:var(--md-list-item-supporting-text-line-height, var(--md-sys-typescale-body-medium-line-height, 1.25rem));font-weight:var(--md-list-item-supporting-text-weight, var(--md-sys-typescale-body-medium-weight, var(--md-ref-typeface-weight-regular, 400)))}[slot=trailing-supporting-text]{color:var(--md-list-item-trailing-supporting-text-color, var(--md-sys-color-on-surface-variant, #49454f));font-family:var(--md-list-item-trailing-supporting-text-font, var(--md-sys-typescale-label-small-font, var(--md-ref-typeface-plain, Roboto)));font-size:var(--md-list-item-trailing-supporting-text-size, var(--md-sys-typescale-label-small-size, 0.6875rem));line-height:var(--md-list-item-trailing-supporting-text-line-height, var(--md-sys-typescale-label-small-line-height, 1rem));font-weight:var(--md-list-item-trailing-supporting-text-weight, var(--md-sys-typescale-label-small-weight, var(--md-ref-typeface-weight-medium, 500)))}:is([slot=start],[slot=end])::slotted(*){fill:currentColor}[slot=start]{color:var(--md-list-item-leading-icon-color, var(--md-sys-color-on-surface-variant, #49454f))}[slot=end]{color:var(--md-list-item-trailing-icon-color, var(--md-sys-color-on-surface-variant, #49454f))}@media(forced-colors: active){.disabled slot{color:GrayText}.list-item.disabled{color:GrayText;opacity:1}}
`;class re extends te{}re.styles=[ie],customElements.define("ew-list-item",re);class oe extends u{}oe.styles=[p],customElements.define("ew-divider",oe);const ae=Symbol("createValidator"),se=Symbol("getValidityAnchor"),ne=Symbol("privateValidator"),le=Symbol("privateSyncValidity"),de=Symbol("privateCustomValidationMessage");function ce(e){var t;class i extends e{constructor(){super(...arguments),this[t]=""}get validity(){return this[le](),this[f].validity}get validationMessage(){return this[le](),this[f].validationMessage}get willValidate(){return this[le](),this[f].willValidate}checkValidity(){return this[le](),this[f].checkValidity()}reportValidity(){return this[le](),this[f].reportValidity()}setCustomValidity(e){this[de]=e,this[le]()}requestUpdate(e,t,i){super.requestUpdate(e,t,i),this[le]()}firstUpdated(e){super.firstUpdated(e),this[le]()}[(t=de,le)](){this[ne]||(this[ne]=this[ae]());const{validity:e,validationMessage:t}=this[ne].getValidity(),i=!!this[de],r=this[de]||t;this[f].setValidity({...e,customError:i},r,this[se]()??void 0)}[ae](){throw new Error("Implement [createValidator]")}[se](){throw new Error("Implement [getValidityAnchor]")}}return i}const he=Symbol("getFormValue"),pe=Symbol("getFormState");function ue(e){class i extends e{get form(){return this[f].form}get labels(){return this[f].labels}get name(){return this.getAttribute("name")??""}set name(e){this.setAttribute("name",e)}get disabled(){return this.hasAttribute("disabled")}set disabled(e){this.toggleAttribute("disabled",e)}attributeChangedCallback(e,t,i){if("name"!==e&&"disabled"!==e)super.attributeChangedCallback(e,t,i);else{const i="disabled"===e?null!==t:t;this.requestUpdate(e,i)}}requestUpdate(e,t,i){super.requestUpdate(e,t,i),this[f].setFormValue(this[he](),this[pe]())}[he](){throw new Error("Implement [getFormValue]")}[pe](){return this[he]()}formDisabledCallback(e){this.disabled=e}}return i.formAssociated=!0,t([s({noAccessor:!0})],i.prototype,"name",null),t([s({type:Boolean,noAccessor:!0})],i.prototype,"disabled",null),i}class fe{constructor(e){this.getCurrentState=e,this.currentValidity={validity:{},validationMessage:""}}getValidity(){const e=this.getCurrentState();if(!(!this.prevState||!this.equals(this.prevState,e)))return this.currentValidity;const{validity:t,validationMessage:i}=this.computeValidity(e);return this.prevState=this.copy(e),this.currentValidity={validationMessage:i,validity:{badInput:t.badInput,customError:t.customError,patternMismatch:t.patternMismatch,rangeOverflow:t.rangeOverflow,rangeUnderflow:t.rangeUnderflow,stepMismatch:t.stepMismatch,tooLong:t.tooLong,tooShort:t.tooShort,typeMismatch:t.typeMismatch,valueMissing:t.valueMissing}},this.currentValidity}}class me extends fe{computeValidity(e){return this.checkboxControl||(this.checkboxControl=document.createElement("input"),this.checkboxControl.type="checkbox"),this.checkboxControl.checked=e.checked,this.checkboxControl.required=e.required,{validity:this.checkboxControl.validity,validationMessage:this.checkboxControl.validationMessage}}equals(e,t){return e.checked===t.checked&&e.required===t.required}copy({checked:e,required:t}){return{checked:e,required:t}}}const ve=l(ce(ue(m(r))));class ge extends ve{constructor(){super(),this.checked=!1,this.indeterminate=!1,this.required=!1,this.value="on",this.prevChecked=!1,this.prevDisabled=!1,this.prevIndeterminate=!1,this.addEventListener("click",(e=>{g(e)&&this.input&&(this.focus(),b(this.input))}))}update(e){(e.has("checked")||e.has("disabled")||e.has("indeterminate"))&&(this.prevChecked=e.get("checked")??this.checked,this.prevDisabled=e.get("disabled")??this.disabled,this.prevIndeterminate=e.get("indeterminate")??this.indeterminate),super.update(e)}render(){const e=!this.prevChecked&&!this.prevIndeterminate,t=this.prevChecked&&!this.prevIndeterminate,i=this.prevIndeterminate,r=this.checked&&!this.indeterminate,a=this.indeterminate,s=h({disabled:this.disabled,selected:r||a,unselected:!r&&!a,checked:r,indeterminate:a,"prev-unselected":e,"prev-checked":t,"prev-indeterminate":i,"prev-disabled":this.prevDisabled}),{ariaLabel:n,ariaInvalid:l}=this;return o`
      <div class="container ${s}">
        <input
          type="checkbox"
          id="input"
          aria-checked=${a?"mixed":c}
          aria-label=${n||c}
          aria-invalid=${l||c}
          ?disabled=${this.disabled}
          ?required=${this.required}
          .indeterminate=${this.indeterminate}
          .checked=${this.checked}
          @input=${this.handleInput}
          @change=${this.handleChange} />

        <div class="outline"></div>
        <div class="background"></div>
        <md-focus-ring part="focus-ring" for="input"></md-focus-ring>
        <md-ripple for="input" ?disabled=${this.disabled}></md-ripple>
        <svg class="icon" viewBox="0 0 18 18" aria-hidden="true">
          <rect class="mark short" />
          <rect class="mark long" />
        </svg>
      </div>
    `}handleInput(e){const t=e.target;this.checked=t.checked,this.indeterminate=t.indeterminate}handleChange(e){_(this,e)}[he](){return!this.checked||this.indeterminate?null:this.value}[pe](){return String(this.checked)}formResetCallback(){this.checked=this.hasAttribute("checked")}formStateRestoreCallback(e){this.checked="true"===e}[ae](){return new me((()=>this))}[se](){return this.input}}ge.shadowRootOptions={...r.shadowRootOptions,delegatesFocus:!0},t([s({type:Boolean})],ge.prototype,"checked",void 0),t([s({type:Boolean})],ge.prototype,"indeterminate",void 0),t([s({type:Boolean})],ge.prototype,"required",void 0),t([s()],ge.prototype,"value",void 0),t([v()],ge.prototype,"prevChecked",void 0),t([v()],ge.prototype,"prevDisabled",void 0),t([v()],ge.prototype,"prevIndeterminate",void 0),t([d("input")],ge.prototype,"input",void 0);const be=a`:host{border-start-start-radius:var(--md-checkbox-container-shape-start-start, var(--md-checkbox-container-shape, 2px));border-start-end-radius:var(--md-checkbox-container-shape-start-end, var(--md-checkbox-container-shape, 2px));border-end-end-radius:var(--md-checkbox-container-shape-end-end, var(--md-checkbox-container-shape, 2px));border-end-start-radius:var(--md-checkbox-container-shape-end-start, var(--md-checkbox-container-shape, 2px));display:inline-flex;height:var(--md-checkbox-container-size, 18px);position:relative;vertical-align:top;width:var(--md-checkbox-container-size, 18px);-webkit-tap-highlight-color:rgba(0,0,0,0);cursor:pointer}:host([disabled]){cursor:default}:host([touch-target=wrapper]){margin:max(0px,(48px - var(--md-checkbox-container-size, 18px))/2)}md-focus-ring{height:44px;inset:unset;width:44px}input{appearance:none;height:48px;margin:0;opacity:0;outline:none;position:absolute;width:48px;z-index:1;cursor:inherit}:host([touch-target=none]) input{height:100%;width:100%}.container{border-radius:inherit;display:flex;height:100%;place-content:center;place-items:center;position:relative;width:100%}.outline,.background,.icon{inset:0;position:absolute}.outline,.background{border-radius:inherit}.outline{border-color:var(--md-checkbox-outline-color, var(--md-sys-color-on-surface-variant, #49454f));border-style:solid;border-width:var(--md-checkbox-outline-width, 2px);box-sizing:border-box}.background{background-color:var(--md-checkbox-selected-container-color, var(--md-sys-color-primary, #6750a4))}.background,.icon{opacity:0;transition-duration:150ms,50ms;transition-property:transform,opacity;transition-timing-function:cubic-bezier(0.3, 0, 0.8, 0.15),linear;transform:scale(0.6)}:where(.selected) :is(.background,.icon){opacity:1;transition-duration:350ms,50ms;transition-timing-function:cubic-bezier(0.05, 0.7, 0.1, 1),linear;transform:scale(1)}md-ripple{border-radius:var(--md-checkbox-state-layer-shape, var(--md-sys-shape-corner-full, 9999px));height:var(--md-checkbox-state-layer-size, 40px);inset:unset;width:var(--md-checkbox-state-layer-size, 40px);--md-ripple-hover-color: var(--md-checkbox-hover-state-layer-color, var(--md-sys-color-on-surface, #1d1b20));--md-ripple-hover-opacity: var(--md-checkbox-hover-state-layer-opacity, 0.08);--md-ripple-pressed-color: var(--md-checkbox-pressed-state-layer-color, var(--md-sys-color-primary, #6750a4));--md-ripple-pressed-opacity: var(--md-checkbox-pressed-state-layer-opacity, 0.12)}.selected md-ripple{--md-ripple-hover-color: var(--md-checkbox-selected-hover-state-layer-color, var(--md-sys-color-primary, #6750a4));--md-ripple-hover-opacity: var(--md-checkbox-selected-hover-state-layer-opacity, 0.08);--md-ripple-pressed-color: var(--md-checkbox-selected-pressed-state-layer-color, var(--md-sys-color-on-surface, #1d1b20));--md-ripple-pressed-opacity: var(--md-checkbox-selected-pressed-state-layer-opacity, 0.12)}.icon{fill:var(--md-checkbox-selected-icon-color, var(--md-sys-color-on-primary, #fff));height:var(--md-checkbox-icon-size, 18px);width:var(--md-checkbox-icon-size, 18px)}.mark.short{height:2px;transition-property:transform,height;width:2px}.mark.long{height:2px;transition-property:transform,width;width:10px}.mark{animation-duration:150ms;animation-timing-function:cubic-bezier(0.3, 0, 0.8, 0.15);transition-duration:150ms;transition-timing-function:cubic-bezier(0.3, 0, 0.8, 0.15)}.selected .mark{animation-duration:350ms;animation-timing-function:cubic-bezier(0.05, 0.7, 0.1, 1);transition-duration:350ms;transition-timing-function:cubic-bezier(0.05, 0.7, 0.1, 1)}.checked .mark,.prev-checked.unselected .mark{transform:scaleY(-1) translate(7px, -14px) rotate(45deg)}.checked .mark.short,.prev-checked.unselected .mark.short{height:5.6568542495px}.checked .mark.long,.prev-checked.unselected .mark.long{width:11.313708499px}.indeterminate .mark,.prev-indeterminate.unselected .mark{transform:scaleY(-1) translate(4px, -10px) rotate(0deg)}.prev-unselected .mark{transition-property:none}.prev-unselected.checked .mark.long{animation-name:prev-unselected-to-checked}@keyframes prev-unselected-to-checked{from{width:0}}:where(:hover) .outline{border-color:var(--md-checkbox-hover-outline-color, var(--md-sys-color-on-surface, #1d1b20));border-width:var(--md-checkbox-hover-outline-width, 2px)}:where(:hover) .background{background:var(--md-checkbox-selected-hover-container-color, var(--md-sys-color-primary, #6750a4))}:where(:hover) .icon{fill:var(--md-checkbox-selected-hover-icon-color, var(--md-sys-color-on-primary, #fff))}:where(:focus-within) .outline{border-color:var(--md-checkbox-focus-outline-color, var(--md-sys-color-on-surface, #1d1b20));border-width:var(--md-checkbox-focus-outline-width, 2px)}:where(:focus-within) .background{background:var(--md-checkbox-selected-focus-container-color, var(--md-sys-color-primary, #6750a4))}:where(:focus-within) .icon{fill:var(--md-checkbox-selected-focus-icon-color, var(--md-sys-color-on-primary, #fff))}:where(:active) .outline{border-color:var(--md-checkbox-pressed-outline-color, var(--md-sys-color-on-surface, #1d1b20));border-width:var(--md-checkbox-pressed-outline-width, 2px)}:where(:active) .background{background:var(--md-checkbox-selected-pressed-container-color, var(--md-sys-color-primary, #6750a4))}:where(:active) .icon{fill:var(--md-checkbox-selected-pressed-icon-color, var(--md-sys-color-on-primary, #fff))}:where(.disabled,.prev-disabled) :is(.background,.icon,.mark){animation-duration:0s;transition-duration:0s}:where(.disabled) .outline{border-color:var(--md-checkbox-disabled-outline-color, var(--md-sys-color-on-surface, #1d1b20));border-width:var(--md-checkbox-disabled-outline-width, 2px);opacity:var(--md-checkbox-disabled-container-opacity, 0.38)}:where(.selected.disabled) .outline{visibility:hidden}:where(.selected.disabled) .background{background:var(--md-checkbox-selected-disabled-container-color, var(--md-sys-color-on-surface, #1d1b20));opacity:var(--md-checkbox-selected-disabled-container-opacity, 0.38)}:where(.disabled) .icon{fill:var(--md-checkbox-selected-disabled-icon-color, var(--md-sys-color-surface, #fef7ff))}@media(forced-colors: active){.background{background-color:CanvasText}.selected.disabled .background{background-color:GrayText;opacity:1}.outline{border-color:CanvasText}.disabled .outline{border-color:GrayText;opacity:1}.icon{fill:Canvas}}
`;class _e extends ge{}_e.styles=[be],customElements.define("ew-checkbox",_e);class ye{constructor(e){this.targetElement=e,this.state={bold:!1,italic:!1,underline:!1,strikethrough:!1,foregroundColor:null,backgroundColor:null,carriageReturn:!1,lines:[],secret:!1}}logs(){return this.targetElement.innerText}processLine(e){const t=/(?:\033|\\033)(?:\[(.*?)[@-~]|\].*?(?:\007|\033\\))/g;let i=0;const r=document.createElement("span");r.classList.add("line");const o=e=>{if(""===e)return;const t=document.createElement("span");if(this.state.bold&&t.classList.add("log-bold"),this.state.italic&&t.classList.add("log-italic"),this.state.underline&&t.classList.add("log-underline"),this.state.strikethrough&&t.classList.add("log-strikethrough"),this.state.secret&&t.classList.add("log-secret"),null!==this.state.foregroundColor&&t.classList.add(`log-fg-${this.state.foregroundColor}`),null!==this.state.backgroundColor&&t.classList.add(`log-bg-${this.state.backgroundColor}`),t.appendChild(document.createTextNode(e)),r.appendChild(t),this.state.secret){const e=document.createElement("span");e.classList.add("log-secret-redacted"),e.appendChild(document.createTextNode("[redacted]")),r.appendChild(e)}};for(;;){const r=t.exec(e);if(null===r)break;const a=r.index;if(o(e.substring(i,a)),i=a+r[0].length,void 0!==r[1])for(const e of r[1].split(";"))switch(parseInt(e)){case 0:this.state.bold=!1,this.state.italic=!1,this.state.underline=!1,this.state.strikethrough=!1,this.state.foregroundColor=null,this.state.backgroundColor=null,this.state.secret=!1;break;case 1:this.state.bold=!0;break;case 3:this.state.italic=!0;break;case 4:this.state.underline=!0;break;case 5:this.state.secret=!0;break;case 6:this.state.secret=!1;break;case 9:this.state.strikethrough=!0;break;case 22:this.state.bold=!1;break;case 23:this.state.italic=!1;break;case 24:this.state.underline=!1;break;case 29:this.state.strikethrough=!1;break;case 30:this.state.foregroundColor="black";break;case 31:this.state.foregroundColor="red";break;case 32:this.state.foregroundColor="green";break;case 33:this.state.foregroundColor="yellow";break;case 34:this.state.foregroundColor="blue";break;case 35:this.state.foregroundColor="magenta";break;case 36:this.state.foregroundColor="cyan";break;case 37:this.state.foregroundColor="white";break;case 39:this.state.foregroundColor=null;break;case 41:this.state.backgroundColor="red";break;case 42:this.state.backgroundColor="green";break;case 43:this.state.backgroundColor="yellow";break;case 44:this.state.backgroundColor="blue";break;case 45:this.state.backgroundColor="magenta";break;case 46:this.state.backgroundColor="cyan";break;case 47:this.state.backgroundColor="white";break;case 40:case 49:this.state.backgroundColor=null}}return o(e.substring(i)),r}processLines(){const e=this.targetElement.scrollTop>this.targetElement.scrollHeight-this.targetElement.offsetHeight-50,t=this.state.carriageReturn,i=document.createDocumentFragment();if(0!=this.state.lines.length){for(const e of this.state.lines)this.state.carriageReturn&&"\n"!==e&&i.childElementCount&&i.removeChild(i.lastChild),i.appendChild(this.processLine(e)),this.state.carriageReturn=e.includes("\r");t&&"\n"!==this.state.lines[0]?this.targetElement.replaceChild(i,this.targetElement.lastChild):this.targetElement.appendChild(i),this.state.lines=[],e&&(this.targetElement.scrollTop=this.targetElement.scrollHeight)}}addLine(e){0==this.state.lines.length&&setTimeout((()=>this.processLines()),0),this.state.lines.push(e)}}const we=e=>new Promise((t=>setTimeout(t,e))),xe=(e,t,i=0)=>{const r=e.length,o=t.length;if(0!==o)for(let a=i;a<=r-o;a++){let i=!0;for(let r=0;r<o;r++)if(e[a+r]!==t[r]){i=!1;break}if(i)return a}};class ke{constructor(){this.chunks=""}transform(e,t){this.chunks+=e;const i=this.chunks.split(/\r?\n/);this.chunks=i.pop(),i.forEach((e=>t.enqueue(e+"\r\n")))}flush(e){e.enqueue(this.chunks)}}class Ee{constructor(){this.chunks=new Uint8Array}transform(e,t){const i=new Uint8Array(this.chunks.length+e.length);i.set(this.chunks,0),i.set(e,this.chunks.length),this.chunks=i;let r=xe(this.chunks,new Uint8Array([13,10]));for(;void 0!==r;){const e=this.chunks.slice(0,r),t=this.chunks.slice(r+2);this.chunks=new Uint8Array(this.chunks.length-1),this.chunks.set(e,0),this.chunks.set([10],e.length),this.chunks.set(t,e.length+1),r=xe(this.chunks,new Uint8Array([13,10]),r-1)}t.enqueue(this.chunks),this.chunks=new Uint8Array}flush(e){this.chunks.length>0&&e.enqueue(this.chunks)}}class Se{transform(e,t){const i=new Date,r=i.getHours().toString().padStart(2,"0"),o=i.getMinutes().toString().padStart(2,"0"),a=i.getSeconds().toString().padStart(2,"0");t.enqueue(`[${r}:${o}:${a}]${e}`)}}class Ae extends HTMLElement{constructor(){super(...arguments),this.allowInput=!0}logs(){var e;return(null===(e=this._console)||void 0===e?void 0:e.logs())||""}connectedCallback(){if(this._console)return;if(this.attachShadow({mode:"open"}).innerHTML=`\n      <style>\n        :host, input {\n          background-color: #1c1c1c;\n          color: #ddd;\n          font-family: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier,\n            monospace;\n          line-height: 1.45;\n          display: flex;\n          flex-direction: column;\n        }\n        form {\n          display: flex;\n          align-items: center;\n          padding: 0 8px 0 16px;\n        }\n        input {\n          flex: 1;\n          padding: 4px;\n          margin: 0 8px;\n          border: 0;\n          outline: none;\n        }\n        \n  .log {\n    flex: 1;\n    background-color: #1c1c1c;\n    font-family: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier,\n      monospace;\n    font-size: 12px;\n    padding: 16px;\n    overflow: auto;\n    line-height: 1.45;\n    border-radius: 3px;\n    white-space: pre-wrap;\n    overflow-wrap: break-word;\n    color: #ddd;\n  }\n\n  .log-bold {\n    font-weight: bold;\n  }\n  .log-italic {\n    font-style: italic;\n  }\n  .log-underline {\n    text-decoration: underline;\n  }\n  .log-strikethrough {\n    text-decoration: line-through;\n  }\n  .log-underline.log-strikethrough {\n    text-decoration: underline line-through;\n  }\n  .log-secret {\n    -webkit-user-select: none;\n    -moz-user-select: none;\n    -ms-user-select: none;\n    user-select: none;\n  }\n  .log-secret-redacted {\n    opacity: 0;\n    width: 1px;\n    font-size: 1px;\n  }\n  .log-fg-black {\n    color: rgb(128, 128, 128);\n  }\n  .log-fg-red {\n    color: rgb(255, 0, 0);\n  }\n  .log-fg-green {\n    color: rgb(0, 255, 0);\n  }\n  .log-fg-yellow {\n    color: rgb(255, 255, 0);\n  }\n  .log-fg-blue {\n    color: rgb(0, 0, 255);\n  }\n  .log-fg-magenta {\n    color: rgb(255, 0, 255);\n  }\n  .log-fg-cyan {\n    color: rgb(0, 255, 255);\n  }\n  .log-fg-white {\n    color: rgb(187, 187, 187);\n  }\n  .log-bg-black {\n    background-color: rgb(0, 0, 0);\n  }\n  .log-bg-red {\n    background-color: rgb(255, 0, 0);\n  }\n  .log-bg-green {\n    background-color: rgb(0, 255, 0);\n  }\n  .log-bg-yellow {\n    background-color: rgb(255, 255, 0);\n  }\n  .log-bg-blue {\n    background-color: rgb(0, 0, 255);\n  }\n  .log-bg-magenta {\n    background-color: rgb(255, 0, 255);\n  }\n  .log-bg-cyan {\n    background-color: rgb(0, 255, 255);\n  }\n  .log-bg-white {\n    background-color: rgb(255, 255, 255);\n  }\n\n      </style>\n      <div class="log"></div>\n      ${this.allowInput?"<form>\n                >\n                <input autofocus>\n              </form>\n            ":""}\n    `,this._console=new ye(this.shadowRoot.querySelector("div")),this.allowInput){const e=this.shadowRoot.querySelector("input");this.addEventListener("click",(()=>{var t;""===(null===(t=getSelection())||void 0===t?void 0:t.toString())&&e.focus()})),e.addEventListener("keydown",(e=>{"Enter"===e.key&&(e.preventDefault(),e.stopPropagation(),this._sendCommand())}))}const e=new AbortController,t=this._connect(e.signal);this._cancelConnection=()=>(e.abort(),t)}async _connect(e){this.logger.debug("Starting console read loop");try{await this.port.readable.pipeThrough(new TextDecoderStream,{signal:e}).pipeThrough(new TransformStream(new ke)).pipeThrough(new TransformStream(new Se)).pipeTo(new WritableStream({write:e=>{this._console.addLine(e.replace("\r",""))}})),e.aborted||(this._console.addLine(""),this._console.addLine(""),this._console.addLine("Terminal disconnected"))}catch(e){this._console.addLine(""),this._console.addLine(""),this._console.addLine(`Terminal disconnected: ${e}`)}finally{await we(100),this.logger.debug("Finished console read loop")}}async _sendCommand(){const e=this.shadowRoot.querySelector("input"),t=e.value,i=new TextEncoder,r=this.port.writable.getWriter();await r.write(i.encode(t+"\n")),this._console.addLine(`> ${t}\r\n`),e.value="",e.focus();try{r.releaseLock()}catch(e){console.error("Ignoring release lock error",e)}}async disconnect(){this._cancelConnection&&(await this._cancelConnection(),this._cancelConnection=void 0)}async reset(){this.logger.debug("Triggering reset"),await this.port.setSignals({dataTerminalReady:!1,requestToSend:!0}),await we(250),await this.port.setSignals({dataTerminalReady:!1,requestToSend:!1}),await we(250),await new Promise((e=>setTimeout(e,1e3)))}}customElements.define("ewt-console",Ae);class Ce{constructor(e,t,i,r){this.targetElement=e,this._downloadCallback=t,this._deleteCallback=i,this._goToDirectory=r,this._path=""}setFilesAndDirectories(e,t,i){this._path=i,this.targetElement.innerHTML="";const r=document.createElement("div");r.classList.add("path"),r.textContent="←"+i,r.onclick=()=>{const e=i.split("/").slice(0,-1).join("/");this._goToDirectory(e)},this.targetElement.appendChild(r);for(const e of t)this.targetElement.appendChild(this._createDirectoryElement(e));for(const t of e)this.targetElement.appendChild(this._createFileElement(t))}_createDirectoryElement(e){const t=document.createElement("div");t.classList.add("directory"),t.textContent=e;const i=document.createElement("span");i.classList.add("icon"),i.textContent="🗑",i.onclick=()=>{this._deleteCallback(this._getFilePath(e))},t.appendChild(i);const r=document.createElement("span");return r.classList.add("icon"),r.textContent="→",r.onclick=()=>{this._goToDirectory(this._getFilePath(e))},t.appendChild(r),t}_createFileElement(e){const t=document.createElement("div");t.classList.add("file"),t.textContent=e;const i=document.createElement("span");i.classList.add("icon"),i.textContent="🗑",i.onclick=()=>{this._deleteCallback(this._getFilePath(e))},t.appendChild(i);const r=document.createElement("span");return r.classList.add("icon"),r.textContent="⬇️",r.onclick=()=>{this._downloadCallback(this._getFilePath(e))},t.appendChild(r),t}_getFilePath(e){return"/"==this._path[-1]?this._path+e:this._path+"/"+e}}class Te extends HTMLElement{constructor(){super(...arguments),this.allowInput=!0,this._path="",this.__consoleBuffer=new Uint8Array,this._receivedPackets=new Map,this.debug=!0}get _consoleBuffer(){return this.__consoleBuffer}set _consoleBuffer(e){const{packets:t,rest:i}=this._getPackets(e);for(const e of t){const t=e.commandId,i=e.packetContent;this._receivedPackets.set(t,i)}this.__consoleBuffer=i}_getPackets(e){let t=[];for(var i=e;;){const e=xe(i,new Uint8Array([255,254,253]));if(void 0===e)break;let r=i.slice(e+3);if(r.length<16)break;let o=0;const a=(new TextDecoder).decode(r.slice(o,o+8));o+=8;const s=r[o++]+(r[o++]<<8),n=r[o++]+(r[o++]<<8),l=r[o++]+(r[o++]<<8)+(r[o++]<<16)+(r[o++]<<24);if(r=r.slice(o),r.length<s)break;i=r.slice(s),r=r.slice(0,s),this.debug&&console.log("Found packet with command ID: ",a,Array.from((new TextEncoder).encode(a)).map((e=>e.toString(16).padStart(2,"0"))).join(""),", length: ",s,", options: ",n,", pseudoHash: ",l,r);let d=0;for(let e=0;e<s;e++)d=(d+r[e])%4294967295;d===l?t.push({commandId:a,packetContent:r}):console.log("Hashes do not match, data corrupted")}return{packets:t,rest:i}}connectedCallback(){this.attachShadow({mode:"open"}).innerHTML='\n      <style>\n        :host, input {\n          background-color: #1c1c1c;\n          color: #ddd;\n          font-family: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier,\n            monospace;\n          line-height: 1.45;\n          display: flex;\n          flex-direction: column;\n        }\n        form {\n          display: flex;\n          align-items: center;\n          padding: 0 8px 0 16px;\n        }\n        input {\n          flex: 1;\n          padding: 4px;\n          margin: 0 8px;\n          border: 0;\n          outline: none;\n        }\n      </style>\n      <button id="addDirectory">+</button>\n      <div class="file-browser" ></div>\n    ',this._fileBrowser=new Ce(this.shadowRoot.querySelector(".file-browser"),this._downloadFile.bind(this),this._deleteFile.bind(this),this._goToDirectory.bind(this)),this.shadowRoot.querySelector("#addDirectory").addEventListener("click",(()=>{let e=prompt("Enter the name of the new directory.");e&&this._createDirectory(this._path+"/"+e)})),this._fileBrowser.targetElement.addEventListener("dragover",(e=>{e.preventDefault(),e.stopPropagation()})),this._fileBrowser.targetElement.addEventListener("dragleave",(e=>{e.preventDefault(),e.stopPropagation()})),this._fileBrowser.targetElement.addEventListener("drop",(e=>{e.preventDefault();const t=e.dataTransfer.items;let i=[],r=[];if("webkitGetAsEntry"in DataTransferItem.prototype)for(let e=0;e<t.length;e++){let o=t[e].webkitGetAsEntry();if(o.isDirectory)r.push(o);else if(o.isFile){let r=t[e].webkitGetAsEntry();r&&i.push(r)}}(async()=>{for(let e=0;e<i.length;e++){const t=i[e];console.log("Uploading file: "+t.name);const r=await new Promise(((e,i)=>{t.file((t=>{e(t)}))}));await this._uploadFile(r)}for(let e=0;e<r.length;e++){const t=r[e];console.log("Uploading directory: "+t.name),await this._uploadDirectory(t)}})()}),!1);const e=new AbortController,t=this._connect(e.signal);this._cancelConnection=()=>(e.abort(),t);(async()=>{const e=await this._sendCommand("sm disable");await this._getCommandResult(e);const t=await this._sendCommand("console lock");console.log("console lock",await this._getCommandResult(t)),await this._fetchFilesAndDirectories()})()}async _connect(e){this.logger.debug("Starting console read loop"),this.logger.debug("Fetching files");try{let t=new TransformStream(new Ee);t.writable.getWriter().write().then((()=>{t.readable.getReader().read().then((({value:e,done:t})=>{t?console.log("Stream closed"):console.log("Received chunk: "+e)}))}));const i=this.port.readable.getReader();for(;;){const{value:e,done:t}=await i.read();if(t)break;if(e)if(this.debug&&(console.log("Received raw bytes:",e),console.log("Raw bytes text: "+(new TextDecoder).decode(e))),13===this._consoleBuffer[this._consoleBuffer.length-1]&&10===e[0]){let t=Array.from(this._consoleBuffer.subarray(0,this._consoleBuffer.length-1)).concat(Array.from(e));this._consoleBuffer=new Uint8Array(t)}else{let t=Array.from(this._consoleBuffer).concat(Array.from(e));this._consoleBuffer=new Uint8Array(t)}}e.aborted||console.log("Terminal disconnected")}catch(e){console.log(`Terminal disconnected: ${e}`)}finally{await we(100),this.logger.debug("Finished console read loop")}}async _fetchFilesAndDirectories(){const e=await this._fetchFilesAndDirectoriesForPath(this._path);void 0!==e&&this._fileBrowser.setFilesAndDirectories(e.files,e.directories,this._path)}async _fetchFilesAndDirectoriesForPath(e,t=0){this._consoleBuffer=new Uint8Array;const i=await this._sendCommand(""==e?"ls":'ls "'+e+'"'),r=await this._getCommandResult(i);if(void 0===r||75==r[0]&&79==r[1])return t<3?(console.log("Failed to fetch files, retrying..."),this._fetchFilesAndDirectoriesForPath(e,t+1)):void console.log("Failed to fetch files after 3 retries, giving up.");const o=(new TextDecoder).decode(r),a=JSON.parse(o);return{files:a.files,directories:a.directories}}async _goToDirectory(e){this._path=e,await this._fetchFilesAndDirectories()}async _createDirectory(e){const t=await this._sendCommand('mkdir "'+e+'"'),i=await this._getCommandResult(t);void 0===i||75==i[0]&&79==i[1]?console.log("Failed to create directory"):await this._fetchFilesAndDirectories()}async _deleteFile(e){const t=await this._sendCommand('rm "'+e+'"'),i=await this._getCommandResult(t);void 0===i||75==i[0]&&79==i[1]?console.log("Failed to delete file"):await this._fetchFilesAndDirectories()}async _downloadFile(e){console.log("Downloading file: "+e),this._consoleBuffer=new Uint8Array;let t=Math.random().toString(36).substring(2,9),i=(new TextEncoder).encode(t);i=new Uint8Array([...i,0]),t=(new TextDecoder).decode(i),await this._sendCommand('download "'+e+'"',t);let r=await this._getCommandResult(t);if(void 0===r)return void console.log("Failed to download file");if(79!=r[0]||75!=r[1])return void console.log("Failed to download file");const o=r[2]+(r[3]<<8)+(r[4]<<16)+(r[5]<<24);let a=new Uint8Array,s=1;for(;a.length<o;){let e=i.slice(0,6),t=new Uint8Array(2);t[0]=s>>8&255,t[1]=255&s,e=new Uint8Array([...e,...t]),s++,console.log("expecting packet with command ID: ",Array.from(e).map((e=>e.toString(16).padStart(2,"0"))).join(""));const r=await this._getCommandResult((new TextDecoder).decode(e));if(void 0===r)return void console.log("Failed to download file");a=new Uint8Array([...a,...r])}const n=new Blob([a],{type:"application/octet-stream"}),l=URL.createObjectURL(n),d=document.createElement("a");d.href=l,d.download=e.split("/").pop(),d.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window})),setTimeout((()=>{window.URL.revokeObjectURL(l),d.remove()}),100)}async _uploadDirectory(e,t=this._path){let i=await this._fetchFilesAndDirectoriesForPath(t);if(void 0===i)return void console.log("Failed to upload directory");if(i.files.includes(e.name))return void console.log("File with the same name already exists, skipping...");i.directories.includes(e.name)||await this._createDirectory(t+"/"+e.name);const r=await new Promise(((t,i)=>{e.createReader().readEntries((e=>{t(e)}))}));this._path=t+"/"+e.name,await this._fetchFilesAndDirectories();for(let i=0;i<r.length;i++){const o=r[i];if(o.isFile){const i=o,r=await new Promise(((e,t)=>{i.file((t=>{e(t)}))}));await this._uploadFile(r,t+"/"+e.name)}else if(o.isDirectory){const i=o;await this._uploadDirectory(i,t+"/"+e.name)}}}async _uploadFile(e,t=this._path,i=0){const r=await new Promise(((t,i)=>{const r=new FileReader;r.readAsArrayBuffer(e),r.onloadend=()=>{r.error?i(r.error):t(new Uint8Array(r.result))}})),o=r.length;let a=[],s=0;for(;s<o;){console.log("creating chunk");const e=Math.min(1024,o-s);let t=r.slice(s,s+e),i=0;for(let e=0;e<t.length;e++)i=(i+t[e])%4294967295;const n=new Uint8Array([255&e,e>>8&255]),l=new Uint8Array([0,0]),d=new Uint8Array([255&i,i>>8&255,i>>16&255,i>>24&255]),c=new Uint8Array([0,0]);a.push(new Uint8Array([...n,...l,...d,...c,...t])),s+=e}console.log("Chunks prepared for upload"),this._consoleBuffer=new Uint8Array;const n=await this._sendCommand('upload "'+t+"/"+e.name+'" '+o);console.log("Command ID: %s",n);let l=await this._getCommandResult(n);if(void 0===l||75==l[0]&&79==l[1])return i<3?(console.log("Failed to upload file, retrying..."),void this._uploadFile(e,t,i+1)):void console.log("Failed to upload file after 3 retries, giving up.");console.log("Upload confirmed");for(let e=0;e<a.length;e++){const t=a[e];await this._sendRawCommand(t,n),console.log("Sent chunk "+(e+1)+" of "+a.length);let i=await this._getCommandResult(n);if(void 0===i)return void console.log("Failed to upload file");if(82!=Number(i[0])||69!=Number(i[1])){if(79!=i[0]||75!=i[1])return void console.log("Failed to upload file");console.log("Chunk sent successfully")}else e--,console.log("Failed to upload chunk, retrying...")}const d=await this._getCommandResult(n);if(null==d||75==d[0]&&79==d[1])return i<3?(await this._deleteFile(t+"/"+e.name),console.log("Failed to upload file, retrying..."),void await this._uploadFile(e,t,i+1)):void console.log("Failed to upload file after 3 retries, giving up.");await this._fetchFilesAndDirectories()}async _sendCommand(e,t=void 0){const i=new TextEncoder;return console.log("Sending command: ",e),await this._sendRawCommand(i.encode(e+"\n"),t)}async _sendRawCommand(e,t=void 0,i=!0){void 0===t&&(t=Math.random().toString(36).substring(2,10));let r=(new TextEncoder).encode(t.substring(0,8));r=new Uint8Array([...r,...new Uint8Array(8-r.length)]),this.debug&&(console.log("trying to aquire lock for command",t,"with command",e),console.trace());const o=this.port.writable.getWriter();this.debug&&(i?console.log("Sending command: ",t,new Uint8Array([255,254,253,...r,...e])):console.log("Sending command without ID: ",new Uint8Array([255,254,253,...e]))),i?await o.write(new Uint8Array([255,254,253,...r,...e])):await o.write(new Uint8Array([255,254,253,...e])),await we(20);try{o.releaseLock(),this.debug&&console.log("Lock for command",t,"released successfully")}catch(e){console.error("Ignoring release lock error",e)}return this.debug&&console.log("Command",t,"sent successfully",e),t}async _getCommandResult(e){this.logger.debug("Waiting for command result for command ID: ",e);const t=Date.now();for(;;){if(this._receivedPackets.has(e)){const t=this._receivedPackets.get(e);return this._receivedPackets.delete(e),this.logger.debug("Received command result for command ID: ",e),t}if(Date.now()-t>5e3)return void console.log("Timeout waiting for command result for command ID: ",e);await we(10)}}async disconnect(){this._cancelConnection&&(await this._cancelConnection(),this._cancelConnection=void 0)}async reset(){this.logger.debug("Triggering reset"),await this.port.setSignals({dataTerminalReady:!1,requestToSend:!0}),await we(250),await this.port.setSignals({dataTerminalReady:!1,requestToSend:!1}),await we(250),await new Promise((e=>setTimeout(e,1e3)))}}function Re(e,t=!0){return t&&"rtl"===getComputedStyle(e).getPropertyValue("direction").trim()}customElements.define("ewt-file-browser",Te);const Ie=l(m(r));class $e extends Ie{get name(){return this.getAttribute("name")??""}set name(e){this.setAttribute("name",e)}get form(){return this[f].form}get labels(){return this[f].labels}constructor(){super(),this.disabled=!1,this.softDisabled=!1,this.flipIconInRtl=!1,this.href="",this.download="",this.target="",this.ariaLabelSelected="",this.toggle=!1,this.selected=!1,this.type="submit",this.value="",this.flipIcon=Re(this,this.flipIconInRtl),this.addEventListener("click",this.handleClick.bind(this))}willUpdate(){this.href&&(this.disabled=!1,this.softDisabled=!1)}render(){const e=this.href?J`div`:J`button`,{ariaLabel:t,ariaHasPopup:i,ariaExpanded:r}=this,o=t&&this.ariaLabelSelected,a=this.toggle?this.selected:c;let s=c;return this.href||(s=o&&this.selected?this.ariaLabelSelected:t),Q`<${e}
        class="icon-button ${h(this.getRenderClasses())}"
        id="button"
        aria-label="${s||c}"
        aria-haspopup="${!this.href&&i||c}"
        aria-expanded="${!this.href&&r||c}"
        aria-pressed="${a}"
        aria-disabled=${!this.href&&this.softDisabled||c}
        ?disabled="${!this.href&&this.disabled}"
        @click="${this.handleClickOnChild}">
        ${this.renderFocusRing()}
        ${this.renderRipple()}
        ${this.selected?c:this.renderIcon()}
        ${this.selected?this.renderSelectedIcon():c}
        ${this.href?this.renderLink():this.renderTouchTarget()}
  </${e}>`}renderLink(){const{ariaLabel:e}=this;return o`
      <a
        class="link"
        id="link"
        href="${this.href}"
        download="${this.download||c}"
        target="${this.target||c}"
        aria-label="${e||c}">
        ${this.renderTouchTarget()}
      </a>
    `}getRenderClasses(){return{"flip-icon":this.flipIcon,selected:this.toggle&&this.selected}}renderIcon(){return o`<span class="icon"><slot></slot></span>`}renderSelectedIcon(){return o`<span class="icon icon--selected"
      ><slot name="selected"><slot></slot></slot
    ></span>`}renderTouchTarget(){return o`<span class="touch"></span>`}renderFocusRing(){return o`<md-focus-ring
      part="focus-ring"
      for=${this.href?"link":"button"}></md-focus-ring>`}renderRipple(){const e=!this.href&&(this.disabled||this.softDisabled);return o`<md-ripple
      for=${this.href?"link":c}
      ?disabled="${e}"></md-ripple>`}connectedCallback(){this.flipIcon=Re(this,this.flipIconInRtl),super.connectedCallback()}handleClick(e){if(!this.href&&this.softDisabled)return e.stopImmediatePropagation(),void e.preventDefault()}async handleClickOnChild(e){await 0,!this.toggle||this.disabled||this.softDisabled||e.defaultPrevented||(this.selected=!this.selected,this.dispatchEvent(new InputEvent("input",{bubbles:!0,composed:!0})),this.dispatchEvent(new Event("change",{bubbles:!0})))}}y($e),$e.formAssociated=!0,$e.shadowRootOptions={mode:"open",delegatesFocus:!0},t([s({type:Boolean,reflect:!0})],$e.prototype,"disabled",void 0),t([s({type:Boolean,attribute:"soft-disabled",reflect:!0})],$e.prototype,"softDisabled",void 0),t([s({type:Boolean,attribute:"flip-icon-in-rtl"})],$e.prototype,"flipIconInRtl",void 0),t([s()],$e.prototype,"href",void 0),t([s()],$e.prototype,"download",void 0),t([s()],$e.prototype,"target",void 0),t([s({attribute:"aria-label-selected"})],$e.prototype,"ariaLabelSelected",void 0),t([s({type:Boolean})],$e.prototype,"toggle",void 0),t([s({type:Boolean,reflect:!0})],$e.prototype,"selected",void 0),t([s()],$e.prototype,"type",void 0),t([s({reflect:!0})],$e.prototype,"value",void 0),t([v()],$e.prototype,"flipIcon",void 0);const Le=a`:host{display:inline-flex;outline:none;-webkit-tap-highlight-color:rgba(0,0,0,0);height:var(--_container-height);width:var(--_container-width);justify-content:center}:host([touch-target=wrapper]){margin:max(0px,(48px - var(--_container-height))/2) max(0px,(48px - var(--_container-width))/2)}md-focus-ring{--md-focus-ring-shape-start-start: var(--_container-shape-start-start);--md-focus-ring-shape-start-end: var(--_container-shape-start-end);--md-focus-ring-shape-end-end: var(--_container-shape-end-end);--md-focus-ring-shape-end-start: var(--_container-shape-end-start)}:host(:is([disabled],[soft-disabled])){pointer-events:none}.icon-button{place-items:center;background:none;border:none;box-sizing:border-box;cursor:pointer;display:flex;place-content:center;outline:none;padding:0;position:relative;text-decoration:none;user-select:none;z-index:0;flex:1;border-start-start-radius:var(--_container-shape-start-start);border-start-end-radius:var(--_container-shape-start-end);border-end-start-radius:var(--_container-shape-end-start);border-end-end-radius:var(--_container-shape-end-end)}.icon ::slotted(*){font-size:var(--_icon-size);height:var(--_icon-size);width:var(--_icon-size);font-weight:inherit}md-ripple{z-index:-1;border-start-start-radius:var(--_container-shape-start-start);border-start-end-radius:var(--_container-shape-start-end);border-end-start-radius:var(--_container-shape-end-start);border-end-end-radius:var(--_container-shape-end-end)}.flip-icon .icon{transform:scaleX(-1)}.icon{display:inline-flex}.link{display:grid;height:100%;outline:none;place-items:center;position:absolute;width:100%}.touch{position:absolute;height:max(48px,100%);width:max(48px,100%)}:host([touch-target=none]) .touch{display:none}@media(forced-colors: active){:host(:is([disabled],[soft-disabled])){--_disabled-icon-color: GrayText;--_disabled-icon-opacity: 1}}
`,De=a`:host{--_disabled-icon-color: var(--md-icon-button-disabled-icon-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-icon-opacity: var(--md-icon-button-disabled-icon-opacity, 0.38);--_icon-size: var(--md-icon-button-icon-size, 24px);--_selected-focus-icon-color: var(--md-icon-button-selected-focus-icon-color, var(--md-sys-color-primary, #6750a4));--_selected-hover-icon-color: var(--md-icon-button-selected-hover-icon-color, var(--md-sys-color-primary, #6750a4));--_selected-hover-state-layer-color: var(--md-icon-button-selected-hover-state-layer-color, var(--md-sys-color-primary, #6750a4));--_selected-hover-state-layer-opacity: var(--md-icon-button-selected-hover-state-layer-opacity, 0.08);--_selected-icon-color: var(--md-icon-button-selected-icon-color, var(--md-sys-color-primary, #6750a4));--_selected-pressed-icon-color: var(--md-icon-button-selected-pressed-icon-color, var(--md-sys-color-primary, #6750a4));--_selected-pressed-state-layer-color: var(--md-icon-button-selected-pressed-state-layer-color, var(--md-sys-color-primary, #6750a4));--_selected-pressed-state-layer-opacity: var(--md-icon-button-selected-pressed-state-layer-opacity, 0.12);--_state-layer-height: var(--md-icon-button-state-layer-height, 40px);--_state-layer-shape: var(--md-icon-button-state-layer-shape, var(--md-sys-shape-corner-full, 9999px));--_state-layer-width: var(--md-icon-button-state-layer-width, 40px);--_focus-icon-color: var(--md-icon-button-focus-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_hover-icon-color: var(--md-icon-button-hover-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_hover-state-layer-color: var(--md-icon-button-hover-state-layer-color, var(--md-sys-color-on-surface-variant, #49454f));--_hover-state-layer-opacity: var(--md-icon-button-hover-state-layer-opacity, 0.08);--_icon-color: var(--md-icon-button-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_pressed-icon-color: var(--md-icon-button-pressed-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_pressed-state-layer-color: var(--md-icon-button-pressed-state-layer-color, var(--md-sys-color-on-surface-variant, #49454f));--_pressed-state-layer-opacity: var(--md-icon-button-pressed-state-layer-opacity, 0.12);--_container-shape-start-start: 0;--_container-shape-start-end: 0;--_container-shape-end-end: 0;--_container-shape-end-start: 0;--_container-height: 0;--_container-width: 0;height:var(--_state-layer-height);width:var(--_state-layer-width)}:host([touch-target=wrapper]){margin:max(0px,(48px - var(--_state-layer-height))/2) max(0px,(48px - var(--_state-layer-width))/2)}md-focus-ring{--md-focus-ring-shape-start-start: var(--_state-layer-shape);--md-focus-ring-shape-start-end: var(--_state-layer-shape);--md-focus-ring-shape-end-end: var(--_state-layer-shape);--md-focus-ring-shape-end-start: var(--_state-layer-shape)}.standard{background-color:rgba(0,0,0,0);color:var(--_icon-color);--md-ripple-hover-color: var(--_hover-state-layer-color);--md-ripple-hover-opacity: var(--_hover-state-layer-opacity);--md-ripple-pressed-color: var(--_pressed-state-layer-color);--md-ripple-pressed-opacity: var(--_pressed-state-layer-opacity)}.standard:hover{color:var(--_hover-icon-color)}.standard:focus{color:var(--_focus-icon-color)}.standard:active{color:var(--_pressed-icon-color)}.standard:is(:disabled,[aria-disabled=true]){color:var(--_disabled-icon-color)}md-ripple{border-radius:var(--_state-layer-shape)}.standard:is(:disabled,[aria-disabled=true]){opacity:var(--_disabled-icon-opacity)}.selected{--md-ripple-hover-color: var(--_selected-hover-state-layer-color);--md-ripple-hover-opacity: var(--_selected-hover-state-layer-opacity);--md-ripple-pressed-color: var(--_selected-pressed-state-layer-color);--md-ripple-pressed-opacity: var(--_selected-pressed-state-layer-opacity)}.selected:not(:disabled,[aria-disabled=true]){color:var(--_selected-icon-color)}.selected:not(:disabled,[aria-disabled=true]):hover{color:var(--_selected-hover-icon-color)}.selected:not(:disabled,[aria-disabled=true]):focus{color:var(--_selected-focus-icon-color)}.selected:not(:disabled,[aria-disabled=true]):active{color:var(--_selected-pressed-icon-color)}
`;class Fe extends $e{}Fe.styles=[Le,De],customElements.define("ew-icon-button",Fe);const Pe=a`:host{--_active-indicator-color: var(--md-filled-text-field-active-indicator-color, var(--md-sys-color-on-surface-variant, #49454f));--_active-indicator-height: var(--md-filled-text-field-active-indicator-height, 1px);--_caret-color: var(--md-filled-text-field-caret-color, var(--md-sys-color-primary, #6750a4));--_container-color: var(--md-filled-text-field-container-color, var(--md-sys-color-surface-container-highest, #e6e0e9));--_disabled-active-indicator-color: var(--md-filled-text-field-disabled-active-indicator-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-active-indicator-height: var(--md-filled-text-field-disabled-active-indicator-height, 1px);--_disabled-active-indicator-opacity: var(--md-filled-text-field-disabled-active-indicator-opacity, 0.38);--_disabled-container-color: var(--md-filled-text-field-disabled-container-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-container-opacity: var(--md-filled-text-field-disabled-container-opacity, 0.04);--_disabled-input-text-color: var(--md-filled-text-field-disabled-input-text-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-input-text-opacity: var(--md-filled-text-field-disabled-input-text-opacity, 0.38);--_disabled-label-text-color: var(--md-filled-text-field-disabled-label-text-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-label-text-opacity: var(--md-filled-text-field-disabled-label-text-opacity, 0.38);--_disabled-leading-icon-color: var(--md-filled-text-field-disabled-leading-icon-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-leading-icon-opacity: var(--md-filled-text-field-disabled-leading-icon-opacity, 0.38);--_disabled-supporting-text-color: var(--md-filled-text-field-disabled-supporting-text-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-supporting-text-opacity: var(--md-filled-text-field-disabled-supporting-text-opacity, 0.38);--_disabled-trailing-icon-color: var(--md-filled-text-field-disabled-trailing-icon-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-trailing-icon-opacity: var(--md-filled-text-field-disabled-trailing-icon-opacity, 0.38);--_error-active-indicator-color: var(--md-filled-text-field-error-active-indicator-color, var(--md-sys-color-error, #b3261e));--_error-focus-active-indicator-color: var(--md-filled-text-field-error-focus-active-indicator-color, var(--md-sys-color-error, #b3261e));--_error-focus-caret-color: var(--md-filled-text-field-error-focus-caret-color, var(--md-sys-color-error, #b3261e));--_error-focus-input-text-color: var(--md-filled-text-field-error-focus-input-text-color, var(--md-sys-color-on-surface, #1d1b20));--_error-focus-label-text-color: var(--md-filled-text-field-error-focus-label-text-color, var(--md-sys-color-error, #b3261e));--_error-focus-leading-icon-color: var(--md-filled-text-field-error-focus-leading-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_error-focus-supporting-text-color: var(--md-filled-text-field-error-focus-supporting-text-color, var(--md-sys-color-error, #b3261e));--_error-focus-trailing-icon-color: var(--md-filled-text-field-error-focus-trailing-icon-color, var(--md-sys-color-error, #b3261e));--_error-hover-active-indicator-color: var(--md-filled-text-field-error-hover-active-indicator-color, var(--md-sys-color-on-error-container, #410e0b));--_error-hover-input-text-color: var(--md-filled-text-field-error-hover-input-text-color, var(--md-sys-color-on-surface, #1d1b20));--_error-hover-label-text-color: var(--md-filled-text-field-error-hover-label-text-color, var(--md-sys-color-on-error-container, #410e0b));--_error-hover-leading-icon-color: var(--md-filled-text-field-error-hover-leading-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_error-hover-state-layer-color: var(--md-filled-text-field-error-hover-state-layer-color, var(--md-sys-color-on-surface, #1d1b20));--_error-hover-state-layer-opacity: var(--md-filled-text-field-error-hover-state-layer-opacity, 0.08);--_error-hover-supporting-text-color: var(--md-filled-text-field-error-hover-supporting-text-color, var(--md-sys-color-error, #b3261e));--_error-hover-trailing-icon-color: var(--md-filled-text-field-error-hover-trailing-icon-color, var(--md-sys-color-on-error-container, #410e0b));--_error-input-text-color: var(--md-filled-text-field-error-input-text-color, var(--md-sys-color-on-surface, #1d1b20));--_error-label-text-color: var(--md-filled-text-field-error-label-text-color, var(--md-sys-color-error, #b3261e));--_error-leading-icon-color: var(--md-filled-text-field-error-leading-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_error-supporting-text-color: var(--md-filled-text-field-error-supporting-text-color, var(--md-sys-color-error, #b3261e));--_error-trailing-icon-color: var(--md-filled-text-field-error-trailing-icon-color, var(--md-sys-color-error, #b3261e));--_focus-active-indicator-color: var(--md-filled-text-field-focus-active-indicator-color, var(--md-sys-color-primary, #6750a4));--_focus-active-indicator-height: var(--md-filled-text-field-focus-active-indicator-height, 3px);--_focus-input-text-color: var(--md-filled-text-field-focus-input-text-color, var(--md-sys-color-on-surface, #1d1b20));--_focus-label-text-color: var(--md-filled-text-field-focus-label-text-color, var(--md-sys-color-primary, #6750a4));--_focus-leading-icon-color: var(--md-filled-text-field-focus-leading-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_focus-supporting-text-color: var(--md-filled-text-field-focus-supporting-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_focus-trailing-icon-color: var(--md-filled-text-field-focus-trailing-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_hover-active-indicator-color: var(--md-filled-text-field-hover-active-indicator-color, var(--md-sys-color-on-surface, #1d1b20));--_hover-active-indicator-height: var(--md-filled-text-field-hover-active-indicator-height, 1px);--_hover-input-text-color: var(--md-filled-text-field-hover-input-text-color, var(--md-sys-color-on-surface, #1d1b20));--_hover-label-text-color: var(--md-filled-text-field-hover-label-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_hover-leading-icon-color: var(--md-filled-text-field-hover-leading-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_hover-state-layer-color: var(--md-filled-text-field-hover-state-layer-color, var(--md-sys-color-on-surface, #1d1b20));--_hover-state-layer-opacity: var(--md-filled-text-field-hover-state-layer-opacity, 0.08);--_hover-supporting-text-color: var(--md-filled-text-field-hover-supporting-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_hover-trailing-icon-color: var(--md-filled-text-field-hover-trailing-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_input-text-color: var(--md-filled-text-field-input-text-color, var(--md-sys-color-on-surface, #1d1b20));--_input-text-font: var(--md-filled-text-field-input-text-font, var(--md-sys-typescale-body-large-font, var(--md-ref-typeface-plain, Roboto)));--_input-text-line-height: var(--md-filled-text-field-input-text-line-height, var(--md-sys-typescale-body-large-line-height, 1.5rem));--_input-text-placeholder-color: var(--md-filled-text-field-input-text-placeholder-color, var(--md-sys-color-on-surface-variant, #49454f));--_input-text-prefix-color: var(--md-filled-text-field-input-text-prefix-color, var(--md-sys-color-on-surface-variant, #49454f));--_input-text-size: var(--md-filled-text-field-input-text-size, var(--md-sys-typescale-body-large-size, 1rem));--_input-text-suffix-color: var(--md-filled-text-field-input-text-suffix-color, var(--md-sys-color-on-surface-variant, #49454f));--_input-text-weight: var(--md-filled-text-field-input-text-weight, var(--md-sys-typescale-body-large-weight, var(--md-ref-typeface-weight-regular, 400)));--_label-text-color: var(--md-filled-text-field-label-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_label-text-font: var(--md-filled-text-field-label-text-font, var(--md-sys-typescale-body-large-font, var(--md-ref-typeface-plain, Roboto)));--_label-text-line-height: var(--md-filled-text-field-label-text-line-height, var(--md-sys-typescale-body-large-line-height, 1.5rem));--_label-text-populated-line-height: var(--md-filled-text-field-label-text-populated-line-height, var(--md-sys-typescale-body-small-line-height, 1rem));--_label-text-populated-size: var(--md-filled-text-field-label-text-populated-size, var(--md-sys-typescale-body-small-size, 0.75rem));--_label-text-size: var(--md-filled-text-field-label-text-size, var(--md-sys-typescale-body-large-size, 1rem));--_label-text-weight: var(--md-filled-text-field-label-text-weight, var(--md-sys-typescale-body-large-weight, var(--md-ref-typeface-weight-regular, 400)));--_leading-icon-color: var(--md-filled-text-field-leading-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_leading-icon-size: var(--md-filled-text-field-leading-icon-size, 24px);--_supporting-text-color: var(--md-filled-text-field-supporting-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_supporting-text-font: var(--md-filled-text-field-supporting-text-font, var(--md-sys-typescale-body-small-font, var(--md-ref-typeface-plain, Roboto)));--_supporting-text-line-height: var(--md-filled-text-field-supporting-text-line-height, var(--md-sys-typescale-body-small-line-height, 1rem));--_supporting-text-size: var(--md-filled-text-field-supporting-text-size, var(--md-sys-typescale-body-small-size, 0.75rem));--_supporting-text-weight: var(--md-filled-text-field-supporting-text-weight, var(--md-sys-typescale-body-small-weight, var(--md-ref-typeface-weight-regular, 400)));--_trailing-icon-color: var(--md-filled-text-field-trailing-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_trailing-icon-size: var(--md-filled-text-field-trailing-icon-size, 24px);--_container-shape-start-start: var(--md-filled-text-field-container-shape-start-start, var(--md-filled-text-field-container-shape, var(--md-sys-shape-corner-extra-small, 4px)));--_container-shape-start-end: var(--md-filled-text-field-container-shape-start-end, var(--md-filled-text-field-container-shape, var(--md-sys-shape-corner-extra-small, 4px)));--_container-shape-end-end: var(--md-filled-text-field-container-shape-end-end, var(--md-filled-text-field-container-shape, var(--md-sys-shape-corner-none, 0px)));--_container-shape-end-start: var(--md-filled-text-field-container-shape-end-start, var(--md-filled-text-field-container-shape, var(--md-sys-shape-corner-none, 0px)));--_icon-input-space: var(--md-filled-text-field-icon-input-space, 16px);--_leading-space: var(--md-filled-text-field-leading-space, 16px);--_trailing-space: var(--md-filled-text-field-trailing-space, 16px);--_top-space: var(--md-filled-text-field-top-space, 16px);--_bottom-space: var(--md-filled-text-field-bottom-space, 16px);--_input-text-prefix-trailing-space: var(--md-filled-text-field-input-text-prefix-trailing-space, 2px);--_input-text-suffix-leading-space: var(--md-filled-text-field-input-text-suffix-leading-space, 2px);--_with-label-top-space: var(--md-filled-text-field-with-label-top-space, 8px);--_with-label-bottom-space: var(--md-filled-text-field-with-label-bottom-space, 8px);--_focus-caret-color: var(--md-filled-text-field-focus-caret-color, var(--md-sys-color-primary, #6750a4));--_with-leading-icon-leading-space: var(--md-filled-text-field-with-leading-icon-leading-space, 12px);--_with-trailing-icon-trailing-space: var(--md-filled-text-field-with-trailing-icon-trailing-space, 12px);--md-filled-field-active-indicator-color: var(--_active-indicator-color);--md-filled-field-active-indicator-height: var(--_active-indicator-height);--md-filled-field-bottom-space: var(--_bottom-space);--md-filled-field-container-color: var(--_container-color);--md-filled-field-container-shape-end-end: var(--_container-shape-end-end);--md-filled-field-container-shape-end-start: var(--_container-shape-end-start);--md-filled-field-container-shape-start-end: var(--_container-shape-start-end);--md-filled-field-container-shape-start-start: var(--_container-shape-start-start);--md-filled-field-content-color: var(--_input-text-color);--md-filled-field-content-font: var(--_input-text-font);--md-filled-field-content-line-height: var(--_input-text-line-height);--md-filled-field-content-size: var(--_input-text-size);--md-filled-field-content-space: var(--_icon-input-space);--md-filled-field-content-weight: var(--_input-text-weight);--md-filled-field-disabled-active-indicator-color: var(--_disabled-active-indicator-color);--md-filled-field-disabled-active-indicator-height: var(--_disabled-active-indicator-height);--md-filled-field-disabled-active-indicator-opacity: var(--_disabled-active-indicator-opacity);--md-filled-field-disabled-container-color: var(--_disabled-container-color);--md-filled-field-disabled-container-opacity: var(--_disabled-container-opacity);--md-filled-field-disabled-content-color: var(--_disabled-input-text-color);--md-filled-field-disabled-content-opacity: var(--_disabled-input-text-opacity);--md-filled-field-disabled-label-text-color: var(--_disabled-label-text-color);--md-filled-field-disabled-label-text-opacity: var(--_disabled-label-text-opacity);--md-filled-field-disabled-leading-content-color: var(--_disabled-leading-icon-color);--md-filled-field-disabled-leading-content-opacity: var(--_disabled-leading-icon-opacity);--md-filled-field-disabled-supporting-text-color: var(--_disabled-supporting-text-color);--md-filled-field-disabled-supporting-text-opacity: var(--_disabled-supporting-text-opacity);--md-filled-field-disabled-trailing-content-color: var(--_disabled-trailing-icon-color);--md-filled-field-disabled-trailing-content-opacity: var(--_disabled-trailing-icon-opacity);--md-filled-field-error-active-indicator-color: var(--_error-active-indicator-color);--md-filled-field-error-content-color: var(--_error-input-text-color);--md-filled-field-error-focus-active-indicator-color: var(--_error-focus-active-indicator-color);--md-filled-field-error-focus-content-color: var(--_error-focus-input-text-color);--md-filled-field-error-focus-label-text-color: var(--_error-focus-label-text-color);--md-filled-field-error-focus-leading-content-color: var(--_error-focus-leading-icon-color);--md-filled-field-error-focus-supporting-text-color: var(--_error-focus-supporting-text-color);--md-filled-field-error-focus-trailing-content-color: var(--_error-focus-trailing-icon-color);--md-filled-field-error-hover-active-indicator-color: var(--_error-hover-active-indicator-color);--md-filled-field-error-hover-content-color: var(--_error-hover-input-text-color);--md-filled-field-error-hover-label-text-color: var(--_error-hover-label-text-color);--md-filled-field-error-hover-leading-content-color: var(--_error-hover-leading-icon-color);--md-filled-field-error-hover-state-layer-color: var(--_error-hover-state-layer-color);--md-filled-field-error-hover-state-layer-opacity: var(--_error-hover-state-layer-opacity);--md-filled-field-error-hover-supporting-text-color: var(--_error-hover-supporting-text-color);--md-filled-field-error-hover-trailing-content-color: var(--_error-hover-trailing-icon-color);--md-filled-field-error-label-text-color: var(--_error-label-text-color);--md-filled-field-error-leading-content-color: var(--_error-leading-icon-color);--md-filled-field-error-supporting-text-color: var(--_error-supporting-text-color);--md-filled-field-error-trailing-content-color: var(--_error-trailing-icon-color);--md-filled-field-focus-active-indicator-color: var(--_focus-active-indicator-color);--md-filled-field-focus-active-indicator-height: var(--_focus-active-indicator-height);--md-filled-field-focus-content-color: var(--_focus-input-text-color);--md-filled-field-focus-label-text-color: var(--_focus-label-text-color);--md-filled-field-focus-leading-content-color: var(--_focus-leading-icon-color);--md-filled-field-focus-supporting-text-color: var(--_focus-supporting-text-color);--md-filled-field-focus-trailing-content-color: var(--_focus-trailing-icon-color);--md-filled-field-hover-active-indicator-color: var(--_hover-active-indicator-color);--md-filled-field-hover-active-indicator-height: var(--_hover-active-indicator-height);--md-filled-field-hover-content-color: var(--_hover-input-text-color);--md-filled-field-hover-label-text-color: var(--_hover-label-text-color);--md-filled-field-hover-leading-content-color: var(--_hover-leading-icon-color);--md-filled-field-hover-state-layer-color: var(--_hover-state-layer-color);--md-filled-field-hover-state-layer-opacity: var(--_hover-state-layer-opacity);--md-filled-field-hover-supporting-text-color: var(--_hover-supporting-text-color);--md-filled-field-hover-trailing-content-color: var(--_hover-trailing-icon-color);--md-filled-field-label-text-color: var(--_label-text-color);--md-filled-field-label-text-font: var(--_label-text-font);--md-filled-field-label-text-line-height: var(--_label-text-line-height);--md-filled-field-label-text-populated-line-height: var(--_label-text-populated-line-height);--md-filled-field-label-text-populated-size: var(--_label-text-populated-size);--md-filled-field-label-text-size: var(--_label-text-size);--md-filled-field-label-text-weight: var(--_label-text-weight);--md-filled-field-leading-content-color: var(--_leading-icon-color);--md-filled-field-leading-space: var(--_leading-space);--md-filled-field-supporting-text-color: var(--_supporting-text-color);--md-filled-field-supporting-text-font: var(--_supporting-text-font);--md-filled-field-supporting-text-line-height: var(--_supporting-text-line-height);--md-filled-field-supporting-text-size: var(--_supporting-text-size);--md-filled-field-supporting-text-weight: var(--_supporting-text-weight);--md-filled-field-top-space: var(--_top-space);--md-filled-field-trailing-content-color: var(--_trailing-icon-color);--md-filled-field-trailing-space: var(--_trailing-space);--md-filled-field-with-label-bottom-space: var(--_with-label-bottom-space);--md-filled-field-with-label-top-space: var(--_with-label-top-space);--md-filled-field-with-leading-content-leading-space: var(--_with-leading-icon-leading-space);--md-filled-field-with-trailing-content-trailing-space: var(--_with-trailing-icon-trailing-space)}
`;class Oe extends r{constructor(){super(...arguments),this.disabled=!1,this.error=!1,this.focused=!1,this.label="",this.noAsterisk=!1,this.populated=!1,this.required=!1,this.resizable=!1,this.supportingText="",this.errorText="",this.count=-1,this.max=-1,this.hasStart=!1,this.hasEnd=!1,this.isAnimating=!1,this.refreshErrorAlert=!1,this.disableTransitions=!1}get counterText(){const e=this.count??-1,t=this.max??-1;return e<0||t<=0?"":`${e} / ${t}`}get supportingOrErrorText(){return this.error&&this.errorText?this.errorText:this.supportingText}reannounceError(){this.refreshErrorAlert=!0}update(e){e.has("disabled")&&void 0!==e.get("disabled")&&(this.disableTransitions=!0),this.disabled&&this.focused&&(e.set("focused",!0),this.focused=!1),this.animateLabelIfNeeded({wasFocused:e.get("focused"),wasPopulated:e.get("populated")}),super.update(e)}render(){var e,t,i,r;const a=this.renderLabel(!0),s=this.renderLabel(!1),n=null===(e=this.renderOutline)||void 0===e?void 0:e.call(this,a),l={disabled:this.disabled,"disable-transitions":this.disableTransitions,error:this.error&&!this.disabled,focused:this.focused,"with-start":this.hasStart,"with-end":this.hasEnd,populated:this.populated,resizable:this.resizable,required:this.required,"no-label":!this.label};return o`
      <div class="field ${h(l)}">
        <div class="container-overflow">
          ${null===(t=this.renderBackground)||void 0===t?void 0:t.call(this)}
          <slot name="container"></slot>
          ${null===(i=this.renderStateLayer)||void 0===i?void 0:i.call(this)} ${null===(r=this.renderIndicator)||void 0===r?void 0:r.call(this)} ${n}
          <div class="container">
            <div class="start">
              <slot name="start"></slot>
            </div>
            <div class="middle">
              <div class="label-wrapper">
                ${s} ${n?c:a}
              </div>
              <div class="content">
                <slot></slot>
              </div>
            </div>
            <div class="end">
              <slot name="end"></slot>
            </div>
          </div>
        </div>
        ${this.renderSupportingText()}
      </div>
    `}updated(e){(e.has("supportingText")||e.has("errorText")||e.has("count")||e.has("max"))&&this.updateSlottedAriaDescribedBy(),this.refreshErrorAlert&&requestAnimationFrame((()=>{this.refreshErrorAlert=!1})),this.disableTransitions&&requestAnimationFrame((()=>{this.disableTransitions=!1}))}renderSupportingText(){const{supportingOrErrorText:e,counterText:t}=this;if(!e&&!t)return c;const i=o`<span>${e}</span>`,r=t?o`<span class="counter">${t}</span>`:c,a=this.error&&this.errorText&&!this.refreshErrorAlert;return o`
      <div class="supporting-text" role=${a?"alert":c}>${i}${r}</div>
      <slot
        name="aria-describedby"
        @slotchange=${this.updateSlottedAriaDescribedBy}></slot>
    `}updateSlottedAriaDescribedBy(){for(const e of this.slottedAriaDescribedBy)w(o`${this.supportingOrErrorText} ${this.counterText}`,e),e.setAttribute("hidden","")}renderLabel(e){if(!this.label)return c;let t;t=e?this.focused||this.populated||this.isAnimating:!this.focused&&!this.populated&&!this.isAnimating;const i={hidden:!t,floating:e,resting:!e},r=`${this.label}${this.required&&!this.noAsterisk?"*":""}`;return o`
      <span class="label ${h(i)}" aria-hidden=${!t}
        >${r}</span
      >
    `}animateLabelIfNeeded({wasFocused:e,wasPopulated:t}){var i,r,o;if(!this.label)return;e??(e=this.focused),t??(t=this.populated);(e||t)!==(this.focused||this.populated)&&(this.isAnimating=!0,null===(i=this.labelAnimation)||void 0===i||i.cancel(),this.labelAnimation=null===(r=this.floatingLabelEl)||void 0===r?void 0:r.animate(this.getLabelKeyframes(),{duration:150,easing:x.STANDARD}),null===(o=this.labelAnimation)||void 0===o||o.addEventListener("finish",(()=>{this.isAnimating=!1})))}getLabelKeyframes(){const{floatingLabelEl:e,restingLabelEl:t}=this;if(!e||!t)return[];const{x:i,y:r,height:o}=e.getBoundingClientRect(),{x:a,y:s,height:n}=t.getBoundingClientRect(),l=e.scrollWidth,d=t.scrollWidth,c=d/l,h=`translateX(${a-i}px) translateY(${s-r+Math.round((n-o*c)/2)}px) scale(${c})`,p="translateX(0) translateY(0) scale(1)",u=t.clientWidth,f=d>u?u/c+"px":"";return this.focused||this.populated?[{transform:h,width:f},{transform:p,width:f}]:[{transform:p,width:f},{transform:h,width:f}]}getSurfacePositionClientRect(){return this.containerEl.getBoundingClientRect()}}t([s({type:Boolean})],Oe.prototype,"disabled",void 0),t([s({type:Boolean})],Oe.prototype,"error",void 0),t([s({type:Boolean})],Oe.prototype,"focused",void 0),t([s()],Oe.prototype,"label",void 0),t([s({type:Boolean,attribute:"no-asterisk"})],Oe.prototype,"noAsterisk",void 0),t([s({type:Boolean})],Oe.prototype,"populated",void 0),t([s({type:Boolean})],Oe.prototype,"required",void 0),t([s({type:Boolean})],Oe.prototype,"resizable",void 0),t([s({attribute:"supporting-text"})],Oe.prototype,"supportingText",void 0),t([s({attribute:"error-text"})],Oe.prototype,"errorText",void 0),t([s({type:Number})],Oe.prototype,"count",void 0),t([s({type:Number})],Oe.prototype,"max",void 0),t([s({type:Boolean,attribute:"has-start"})],Oe.prototype,"hasStart",void 0),t([s({type:Boolean,attribute:"has-end"})],Oe.prototype,"hasEnd",void 0),t([i({slot:"aria-describedby"})],Oe.prototype,"slottedAriaDescribedBy",void 0),t([v()],Oe.prototype,"isAnimating",void 0),t([v()],Oe.prototype,"refreshErrorAlert",void 0),t([v()],Oe.prototype,"disableTransitions",void 0),t([d(".label.floating")],Oe.prototype,"floatingLabelEl",void 0),t([d(".label.resting")],Oe.prototype,"restingLabelEl",void 0),t([d(".container")],Oe.prototype,"containerEl",void 0);class ze extends Oe{renderBackground(){return o` <div class="background"></div> `}renderStateLayer(){return o` <div class="state-layer"></div> `}renderIndicator(){return o`<div class="active-indicator"></div>`}}const Be=a`@layer styles{:host{--_active-indicator-color: var(--md-filled-field-active-indicator-color, var(--md-sys-color-on-surface-variant, #49454f));--_active-indicator-height: var(--md-filled-field-active-indicator-height, 1px);--_bottom-space: var(--md-filled-field-bottom-space, 16px);--_container-color: var(--md-filled-field-container-color, var(--md-sys-color-surface-container-highest, #e6e0e9));--_content-color: var(--md-filled-field-content-color, var(--md-sys-color-on-surface, #1d1b20));--_content-font: var(--md-filled-field-content-font, var(--md-sys-typescale-body-large-font, var(--md-ref-typeface-plain, Roboto)));--_content-line-height: var(--md-filled-field-content-line-height, var(--md-sys-typescale-body-large-line-height, 1.5rem));--_content-size: var(--md-filled-field-content-size, var(--md-sys-typescale-body-large-size, 1rem));--_content-space: var(--md-filled-field-content-space, 16px);--_content-weight: var(--md-filled-field-content-weight, var(--md-sys-typescale-body-large-weight, var(--md-ref-typeface-weight-regular, 400)));--_disabled-active-indicator-color: var(--md-filled-field-disabled-active-indicator-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-active-indicator-height: var(--md-filled-field-disabled-active-indicator-height, 1px);--_disabled-active-indicator-opacity: var(--md-filled-field-disabled-active-indicator-opacity, 0.38);--_disabled-container-color: var(--md-filled-field-disabled-container-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-container-opacity: var(--md-filled-field-disabled-container-opacity, 0.04);--_disabled-content-color: var(--md-filled-field-disabled-content-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-content-opacity: var(--md-filled-field-disabled-content-opacity, 0.38);--_disabled-label-text-color: var(--md-filled-field-disabled-label-text-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-label-text-opacity: var(--md-filled-field-disabled-label-text-opacity, 0.38);--_disabled-leading-content-color: var(--md-filled-field-disabled-leading-content-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-leading-content-opacity: var(--md-filled-field-disabled-leading-content-opacity, 0.38);--_disabled-supporting-text-color: var(--md-filled-field-disabled-supporting-text-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-supporting-text-opacity: var(--md-filled-field-disabled-supporting-text-opacity, 0.38);--_disabled-trailing-content-color: var(--md-filled-field-disabled-trailing-content-color, var(--md-sys-color-on-surface, #1d1b20));--_disabled-trailing-content-opacity: var(--md-filled-field-disabled-trailing-content-opacity, 0.38);--_error-active-indicator-color: var(--md-filled-field-error-active-indicator-color, var(--md-sys-color-error, #b3261e));--_error-content-color: var(--md-filled-field-error-content-color, var(--md-sys-color-on-surface, #1d1b20));--_error-focus-active-indicator-color: var(--md-filled-field-error-focus-active-indicator-color, var(--md-sys-color-error, #b3261e));--_error-focus-content-color: var(--md-filled-field-error-focus-content-color, var(--md-sys-color-on-surface-variant, #49454f));--_error-focus-label-text-color: var(--md-filled-field-error-focus-label-text-color, var(--md-sys-color-error, #b3261e));--_error-focus-leading-content-color: var(--md-filled-field-error-focus-leading-content-color, var(--md-sys-color-on-surface-variant, #49454f));--_error-focus-supporting-text-color: var(--md-filled-field-error-focus-supporting-text-color, var(--md-sys-color-error, #b3261e));--_error-focus-trailing-content-color: var(--md-filled-field-error-focus-trailing-content-color, var(--md-sys-color-error, #b3261e));--_error-hover-active-indicator-color: var(--md-filled-field-error-hover-active-indicator-color, var(--md-sys-color-on-error-container, #410e0b));--_error-hover-content-color: var(--md-filled-field-error-hover-content-color, var(--md-sys-color-on-surface, #1d1b20));--_error-hover-label-text-color: var(--md-filled-field-error-hover-label-text-color, var(--md-sys-color-on-error-container, #410e0b));--_error-hover-leading-content-color: var(--md-filled-field-error-hover-leading-content-color, var(--md-sys-color-on-surface-variant, #49454f));--_error-hover-state-layer-color: var(--md-filled-field-error-hover-state-layer-color, var(--md-sys-color-on-surface, #1d1b20));--_error-hover-state-layer-opacity: var(--md-filled-field-error-hover-state-layer-opacity, 0.08);--_error-hover-supporting-text-color: var(--md-filled-field-error-hover-supporting-text-color, var(--md-sys-color-error, #b3261e));--_error-hover-trailing-content-color: var(--md-filled-field-error-hover-trailing-content-color, var(--md-sys-color-on-error-container, #410e0b));--_error-label-text-color: var(--md-filled-field-error-label-text-color, var(--md-sys-color-error, #b3261e));--_error-leading-content-color: var(--md-filled-field-error-leading-content-color, var(--md-sys-color-on-surface-variant, #49454f));--_error-supporting-text-color: var(--md-filled-field-error-supporting-text-color, var(--md-sys-color-error, #b3261e));--_error-trailing-content-color: var(--md-filled-field-error-trailing-content-color, var(--md-sys-color-error, #b3261e));--_focus-active-indicator-color: var(--md-filled-field-focus-active-indicator-color, var(--md-sys-color-primary, #6750a4));--_focus-active-indicator-height: var(--md-filled-field-focus-active-indicator-height, 3px);--_focus-content-color: var(--md-filled-field-focus-content-color, var(--md-sys-color-on-surface, #1d1b20));--_focus-label-text-color: var(--md-filled-field-focus-label-text-color, var(--md-sys-color-primary, #6750a4));--_focus-leading-content-color: var(--md-filled-field-focus-leading-content-color, var(--md-sys-color-on-surface-variant, #49454f));--_focus-supporting-text-color: var(--md-filled-field-focus-supporting-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_focus-trailing-content-color: var(--md-filled-field-focus-trailing-content-color, var(--md-sys-color-on-surface-variant, #49454f));--_hover-active-indicator-color: var(--md-filled-field-hover-active-indicator-color, var(--md-sys-color-on-surface, #1d1b20));--_hover-active-indicator-height: var(--md-filled-field-hover-active-indicator-height, 1px);--_hover-content-color: var(--md-filled-field-hover-content-color, var(--md-sys-color-on-surface, #1d1b20));--_hover-label-text-color: var(--md-filled-field-hover-label-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_hover-leading-content-color: var(--md-filled-field-hover-leading-content-color, var(--md-sys-color-on-surface-variant, #49454f));--_hover-state-layer-color: var(--md-filled-field-hover-state-layer-color, var(--md-sys-color-on-surface, #1d1b20));--_hover-state-layer-opacity: var(--md-filled-field-hover-state-layer-opacity, 0.08);--_hover-supporting-text-color: var(--md-filled-field-hover-supporting-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_hover-trailing-content-color: var(--md-filled-field-hover-trailing-content-color, var(--md-sys-color-on-surface-variant, #49454f));--_label-text-color: var(--md-filled-field-label-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_label-text-font: var(--md-filled-field-label-text-font, var(--md-sys-typescale-body-large-font, var(--md-ref-typeface-plain, Roboto)));--_label-text-line-height: var(--md-filled-field-label-text-line-height, var(--md-sys-typescale-body-large-line-height, 1.5rem));--_label-text-populated-line-height: var(--md-filled-field-label-text-populated-line-height, var(--md-sys-typescale-body-small-line-height, 1rem));--_label-text-populated-size: var(--md-filled-field-label-text-populated-size, var(--md-sys-typescale-body-small-size, 0.75rem));--_label-text-size: var(--md-filled-field-label-text-size, var(--md-sys-typescale-body-large-size, 1rem));--_label-text-weight: var(--md-filled-field-label-text-weight, var(--md-sys-typescale-body-large-weight, var(--md-ref-typeface-weight-regular, 400)));--_leading-content-color: var(--md-filled-field-leading-content-color, var(--md-sys-color-on-surface-variant, #49454f));--_leading-space: var(--md-filled-field-leading-space, 16px);--_supporting-text-color: var(--md-filled-field-supporting-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_supporting-text-font: var(--md-filled-field-supporting-text-font, var(--md-sys-typescale-body-small-font, var(--md-ref-typeface-plain, Roboto)));--_supporting-text-leading-space: var(--md-filled-field-supporting-text-leading-space, 16px);--_supporting-text-line-height: var(--md-filled-field-supporting-text-line-height, var(--md-sys-typescale-body-small-line-height, 1rem));--_supporting-text-size: var(--md-filled-field-supporting-text-size, var(--md-sys-typescale-body-small-size, 0.75rem));--_supporting-text-top-space: var(--md-filled-field-supporting-text-top-space, 4px);--_supporting-text-trailing-space: var(--md-filled-field-supporting-text-trailing-space, 16px);--_supporting-text-weight: var(--md-filled-field-supporting-text-weight, var(--md-sys-typescale-body-small-weight, var(--md-ref-typeface-weight-regular, 400)));--_top-space: var(--md-filled-field-top-space, 16px);--_trailing-content-color: var(--md-filled-field-trailing-content-color, var(--md-sys-color-on-surface-variant, #49454f));--_trailing-space: var(--md-filled-field-trailing-space, 16px);--_with-label-bottom-space: var(--md-filled-field-with-label-bottom-space, 8px);--_with-label-top-space: var(--md-filled-field-with-label-top-space, 8px);--_with-leading-content-leading-space: var(--md-filled-field-with-leading-content-leading-space, 12px);--_with-trailing-content-trailing-space: var(--md-filled-field-with-trailing-content-trailing-space, 12px);--_container-shape-start-start: var(--md-filled-field-container-shape-start-start, var(--md-filled-field-container-shape, var(--md-sys-shape-corner-extra-small, 4px)));--_container-shape-start-end: var(--md-filled-field-container-shape-start-end, var(--md-filled-field-container-shape, var(--md-sys-shape-corner-extra-small, 4px)));--_container-shape-end-end: var(--md-filled-field-container-shape-end-end, var(--md-filled-field-container-shape, var(--md-sys-shape-corner-none, 0px)));--_container-shape-end-start: var(--md-filled-field-container-shape-end-start, var(--md-filled-field-container-shape, var(--md-sys-shape-corner-none, 0px)))}.background,.state-layer{border-radius:inherit;inset:0;pointer-events:none;position:absolute}.background{background:var(--_container-color)}.state-layer{visibility:hidden}.field:not(.disabled):hover .state-layer{visibility:visible}.label.floating{position:absolute;top:var(--_with-label-top-space)}.field:not(.with-start) .label-wrapper{margin-inline-start:var(--_leading-space)}.field:not(.with-end) .label-wrapper{margin-inline-end:var(--_trailing-space)}.active-indicator{inset:auto 0 0 0;pointer-events:none;position:absolute;width:100%;z-index:1}.active-indicator::before,.active-indicator::after{border-bottom:var(--_active-indicator-height) solid var(--_active-indicator-color);inset:auto 0 0 0;content:"";position:absolute;width:100%}.active-indicator::after{opacity:0;transition:opacity 150ms cubic-bezier(0.2, 0, 0, 1)}.focused .active-indicator::after{opacity:1}.field:not(.with-start) .content ::slotted(*){padding-inline-start:var(--_leading-space)}.field:not(.with-end) .content ::slotted(*){padding-inline-end:var(--_trailing-space)}.field:not(.no-label) .content ::slotted(:not(textarea)){padding-bottom:var(--_with-label-bottom-space);padding-top:calc(var(--_with-label-top-space) + var(--_label-text-populated-line-height))}.field:not(.no-label) .content ::slotted(textarea){margin-bottom:var(--_with-label-bottom-space);margin-top:calc(var(--_with-label-top-space) + var(--_label-text-populated-line-height))}:hover .active-indicator::before{border-bottom-color:var(--_hover-active-indicator-color);border-bottom-width:var(--_hover-active-indicator-height)}.active-indicator::after{border-bottom-color:var(--_focus-active-indicator-color);border-bottom-width:var(--_focus-active-indicator-height)}:hover .state-layer{background:var(--_hover-state-layer-color);opacity:var(--_hover-state-layer-opacity)}.disabled .active-indicator::before{border-bottom-color:var(--_disabled-active-indicator-color);border-bottom-width:var(--_disabled-active-indicator-height);opacity:var(--_disabled-active-indicator-opacity)}.disabled .background{background:var(--_disabled-container-color);opacity:var(--_disabled-container-opacity)}.error .active-indicator::before{border-bottom-color:var(--_error-active-indicator-color)}.error:hover .active-indicator::before{border-bottom-color:var(--_error-hover-active-indicator-color)}.error:hover .state-layer{background:var(--_error-hover-state-layer-color);opacity:var(--_error-hover-state-layer-opacity)}.error .active-indicator::after{border-bottom-color:var(--_error-focus-active-indicator-color)}.resizable .container{bottom:var(--_focus-active-indicator-height);clip-path:inset(var(--_focus-active-indicator-height) 0 0 0)}.resizable .container>*{top:var(--_focus-active-indicator-height)}}@layer hcm{@media(forced-colors: active){.disabled .active-indicator::before{border-color:GrayText;opacity:1}}}
`,Ue=a`:host{display:inline-flex;resize:both}.field{display:flex;flex:1;flex-direction:column;writing-mode:horizontal-tb;max-width:100%}.container-overflow{border-start-start-radius:var(--_container-shape-start-start);border-start-end-radius:var(--_container-shape-start-end);border-end-end-radius:var(--_container-shape-end-end);border-end-start-radius:var(--_container-shape-end-start);display:flex;height:100%;position:relative}.container{align-items:center;border-radius:inherit;display:flex;flex:1;max-height:100%;min-height:100%;min-width:min-content;position:relative}.field,.container-overflow{resize:inherit}.resizable:not(.disabled) .container{resize:inherit;overflow:hidden}.disabled{pointer-events:none}slot[name=container]{border-radius:inherit}slot[name=container]::slotted(*){border-radius:inherit;inset:0;pointer-events:none;position:absolute}@layer styles{.start,.middle,.end{display:flex;box-sizing:border-box;height:100%;position:relative}.start{color:var(--_leading-content-color)}.end{color:var(--_trailing-content-color)}.start,.end{align-items:center;justify-content:center}.with-start .start{margin-inline:var(--_with-leading-content-leading-space) var(--_content-space)}.with-end .end{margin-inline:var(--_content-space) var(--_with-trailing-content-trailing-space)}.middle{align-items:stretch;align-self:baseline;flex:1}.content{color:var(--_content-color);display:flex;flex:1;opacity:0;transition:opacity 83ms cubic-bezier(0.2, 0, 0, 1)}.no-label .content,.focused .content,.populated .content{opacity:1;transition-delay:67ms}:is(.disabled,.disable-transitions) .content{transition:none}.content ::slotted(*){all:unset;color:currentColor;font-family:var(--_content-font);font-size:var(--_content-size);line-height:var(--_content-line-height);font-weight:var(--_content-weight);width:100%;overflow-wrap:revert;white-space:revert}.content ::slotted(:not(textarea)){padding-top:var(--_top-space);padding-bottom:var(--_bottom-space)}.content ::slotted(textarea){margin-top:var(--_top-space);margin-bottom:var(--_bottom-space)}:hover .content{color:var(--_hover-content-color)}:hover .start{color:var(--_hover-leading-content-color)}:hover .end{color:var(--_hover-trailing-content-color)}.focused .content{color:var(--_focus-content-color)}.focused .start{color:var(--_focus-leading-content-color)}.focused .end{color:var(--_focus-trailing-content-color)}.disabled .content{color:var(--_disabled-content-color)}.disabled.no-label .content,.disabled.focused .content,.disabled.populated .content{opacity:var(--_disabled-content-opacity)}.disabled .start{color:var(--_disabled-leading-content-color);opacity:var(--_disabled-leading-content-opacity)}.disabled .end{color:var(--_disabled-trailing-content-color);opacity:var(--_disabled-trailing-content-opacity)}.error .content{color:var(--_error-content-color)}.error .start{color:var(--_error-leading-content-color)}.error .end{color:var(--_error-trailing-content-color)}.error:hover .content{color:var(--_error-hover-content-color)}.error:hover .start{color:var(--_error-hover-leading-content-color)}.error:hover .end{color:var(--_error-hover-trailing-content-color)}.error.focused .content{color:var(--_error-focus-content-color)}.error.focused .start{color:var(--_error-focus-leading-content-color)}.error.focused .end{color:var(--_error-focus-trailing-content-color)}}@layer hcm{@media(forced-colors: active){.disabled :is(.start,.content,.end){color:GrayText;opacity:1}}}@layer styles{.label{box-sizing:border-box;color:var(--_label-text-color);overflow:hidden;max-width:100%;text-overflow:ellipsis;white-space:nowrap;z-index:1;font-family:var(--_label-text-font);font-size:var(--_label-text-size);line-height:var(--_label-text-line-height);font-weight:var(--_label-text-weight);width:min-content}.label-wrapper{inset:0;pointer-events:none;position:absolute}.label.resting{position:absolute;top:var(--_top-space)}.label.floating{font-size:var(--_label-text-populated-size);line-height:var(--_label-text-populated-line-height);transform-origin:top left}.label.hidden{opacity:0}.no-label .label{display:none}.label-wrapper{inset:0;position:absolute;text-align:initial}:hover .label{color:var(--_hover-label-text-color)}.focused .label{color:var(--_focus-label-text-color)}.disabled .label{color:var(--_disabled-label-text-color)}.disabled .label:not(.hidden){opacity:var(--_disabled-label-text-opacity)}.error .label{color:var(--_error-label-text-color)}.error:hover .label{color:var(--_error-hover-label-text-color)}.error.focused .label{color:var(--_error-focus-label-text-color)}}@layer hcm{@media(forced-colors: active){.disabled .label:not(.hidden){color:GrayText;opacity:1}}}@layer styles{.supporting-text{color:var(--_supporting-text-color);display:flex;font-family:var(--_supporting-text-font);font-size:var(--_supporting-text-size);line-height:var(--_supporting-text-line-height);font-weight:var(--_supporting-text-weight);gap:16px;justify-content:space-between;padding-inline-start:var(--_supporting-text-leading-space);padding-inline-end:var(--_supporting-text-trailing-space);padding-top:var(--_supporting-text-top-space)}.supporting-text :nth-child(2){flex-shrink:0}:hover .supporting-text{color:var(--_hover-supporting-text-color)}.focus .supporting-text{color:var(--_focus-supporting-text-color)}.disabled .supporting-text{color:var(--_disabled-supporting-text-color);opacity:var(--_disabled-supporting-text-opacity)}.error .supporting-text{color:var(--_error-supporting-text-color)}.error:hover .supporting-text{color:var(--_error-hover-supporting-text-color)}.error.focus .supporting-text{color:var(--_error-focus-supporting-text-color)}}@layer hcm{@media(forced-colors: active){.disabled .supporting-text{color:GrayText;opacity:1}}}
`;let Me=class extends ze{};Me.styles=[Ue,Be],Me=t([n("md-filled-field")],Me);const Ne={},He=k(class extends E{constructor(e){if(super(e),e.type!==S.PROPERTY&&e.type!==S.ATTRIBUTE&&e.type!==S.BOOLEAN_ATTRIBUTE)throw Error("The `live` directive is not allowed on child or event bindings");if(!(e=>void 0===e.strings)(e))throw Error("`live` bindings can only contain a single expression")}render(e){return e}update(e,[t]){if(t===A||t===c)return t;const i=e.element,r=e.name;if(e.type===S.PROPERTY){if(t===i[r])return A}else if(e.type===S.BOOLEAN_ATTRIBUTE){if(!!t===i.hasAttribute(r))return A}else if(e.type===S.ATTRIBUTE&&i.getAttribute(r)===t+"")return A;return((e,t=Ne)=>{e._$AH=t})(e),t}}),qe="important",We=" !"+qe,Ze=k(class extends E{constructor(e){var t;if(super(e),e.type!==S.ATTRIBUTE||"style"!==e.name||(null===(t=e.strings)||void 0===t?void 0:t.length)>2)throw Error("The `styleMap` directive must be used in the `style` attribute and must be the only part in the attribute.")}render(e){return Object.keys(e).reduce(((t,i)=>{const r=e[i];return null==r?t:t+`${i=i.includes("-")?i:i.replace(/(?:^(webkit|moz|ms|o)|)(?=[A-Z])/g,"-$&").toLowerCase()}:${r};`}),"")}update(e,[t]){const{style:i}=e.element;if(void 0===this.ft)return this.ft=new Set(Object.keys(t)),this.render(t);for(const e of this.ft)null==t[e]&&(this.ft.delete(e),e.includes("-")?i.removeProperty(e):i[e]=null);for(const e in t){const r=t[e];if(null!=r){this.ft.add(e);const t="string"==typeof r&&r.endsWith(We);e.includes("-")||t?i.setProperty(e,t?r.slice(0,-11):r,t?qe:""):i[e]=r}}return A}}),Ve={fromAttribute:e=>e??"",toAttribute:e=>e||null},je=Symbol("onReportValidity"),Ge=Symbol("privateCleanupFormListeners"),Ke=Symbol("privateDoNotReportInvalid"),Ye=Symbol("privateIsSelfReportingValidity"),Je=Symbol("privateCallOnReportValidity");function Xe(e){var t,i,r;class o extends e{constructor(...e){super(...e),this[t]=new AbortController,this[i]=!1,this[r]=!1,this.addEventListener("invalid",(e=>{!this[Ke]&&e.isTrusted&&this.addEventListener("invalid",(()=>{this[Je](e)}),{once:!0})}),{capture:!0})}checkValidity(){this[Ke]=!0;const e=super.checkValidity();return this[Ke]=!1,e}reportValidity(){this[Ye]=!0;const e=super.reportValidity();return e&&this[Je](null),this[Ye]=!1,e}[(t=Ge,i=Ke,r=Ye,Je)](e){const t=null==e?void 0:e.defaultPrevented;if(t)return;this[je](e);!t&&(null==e?void 0:e.defaultPrevented)&&(this[Ye]||function(e,t){if(!e)return!0;let i;for(const t of e.elements)if(t.matches(":invalid")){i=t;break}return i===t}(this[f].form,this))&&this.focus()}[je](e){throw new Error("Implement [onReportValidity]")}formAssociatedCallback(e){super.formAssociatedCallback&&super.formAssociatedCallback(e),this[Ge].abort(),e&&(this[Ge]=new AbortController,function(e,t,i,r){const o=function(e){if(!Qe.has(e)){const t=new EventTarget;Qe.set(e,t);for(const i of["reportValidity","requestSubmit"]){const r=e[i];e[i]=function(){t.dispatchEvent(new Event("before"));const e=Reflect.apply(r,this,arguments);return t.dispatchEvent(new Event("after")),e}}}return Qe.get(e)}(t);let a,s=!1,n=!1;o.addEventListener("before",(()=>{n=!0,a=new AbortController,s=!1,e.addEventListener("invalid",(()=>{s=!0}),{signal:a.signal})}),{signal:r}),o.addEventListener("after",(()=>{var e;n=!1,null===(e=a)||void 0===e||e.abort(),s||i()}),{signal:r}),t.addEventListener("submit",(()=>{n||i()}),{signal:r})}(this,e,(()=>{this[Je](null)}),this[Ge].signal))}}return o}const Qe=new WeakMap;class et extends fe{computeValidity({state:e,renderedControl:t}){let i=t;tt(e)&&!i?(i=this.inputControl||document.createElement("input"),this.inputControl=i):i||(i=this.textAreaControl||document.createElement("textarea"),this.textAreaControl=i);const r=tt(e)?i:null;if(r&&(r.type=e.type),i.value!==e.value&&(i.value=e.value),i.required=e.required,r){const t=e;t.pattern?r.pattern=t.pattern:r.removeAttribute("pattern"),t.min?r.min=t.min:r.removeAttribute("min"),t.max?r.max=t.max:r.removeAttribute("max"),t.step?r.step=t.step:r.removeAttribute("step")}return(e.minLength??-1)>-1?i.setAttribute("minlength",String(e.minLength)):i.removeAttribute("minlength"),(e.maxLength??-1)>-1?i.setAttribute("maxlength",String(e.maxLength)):i.removeAttribute("maxlength"),{validity:i.validity,validationMessage:i.validationMessage}}equals({state:e},{state:t}){const i=e.type===t.type&&e.value===t.value&&e.required===t.required&&e.minLength===t.minLength&&e.maxLength===t.maxLength;return tt(e)&&tt(t)?i&&e.pattern===t.pattern&&e.min===t.min&&e.max===t.max&&e.step===t.step:i}copy({state:e}){return{state:tt(e)?this.copyInput(e):this.copyTextArea(e),renderedControl:null}}copyInput(e){const{type:t,pattern:i,min:r,max:o,step:a}=e;return{...this.copySharedState(e),type:t,pattern:i,min:r,max:o,step:a}}copyTextArea(e){return{...this.copySharedState(e),type:e.type}}copySharedState({value:e,required:t,minLength:i,maxLength:r}){return{value:e,required:t,minLength:i,maxLength:r}}}function tt(e){return"textarea"!==e.type}const it=l(Xe(ce(ue(m(r)))));class rt extends it{constructor(){super(...arguments),this.error=!1,this.errorText="",this.label="",this.noAsterisk=!1,this.required=!1,this.value="",this.prefixText="",this.suffixText="",this.hasLeadingIcon=!1,this.hasTrailingIcon=!1,this.supportingText="",this.textDirection="",this.rows=2,this.cols=20,this.inputMode="",this.max="",this.maxLength=-1,this.min="",this.minLength=-1,this.noSpinner=!1,this.pattern="",this.placeholder="",this.readOnly=!1,this.multiple=!1,this.step="",this.type="text",this.autocomplete="",this.dirty=!1,this.focused=!1,this.nativeError=!1,this.nativeErrorText=""}get selectionDirection(){return this.getInputOrTextarea().selectionDirection}set selectionDirection(e){this.getInputOrTextarea().selectionDirection=e}get selectionEnd(){return this.getInputOrTextarea().selectionEnd}set selectionEnd(e){this.getInputOrTextarea().selectionEnd=e}get selectionStart(){return this.getInputOrTextarea().selectionStart}set selectionStart(e){this.getInputOrTextarea().selectionStart=e}get valueAsNumber(){const e=this.getInput();return e?e.valueAsNumber:NaN}set valueAsNumber(e){const t=this.getInput();t&&(t.valueAsNumber=e,this.value=t.value)}get valueAsDate(){const e=this.getInput();return e?e.valueAsDate:null}set valueAsDate(e){const t=this.getInput();t&&(t.valueAsDate=e,this.value=t.value)}get hasError(){return this.error||this.nativeError}select(){this.getInputOrTextarea().select()}setRangeText(...e){this.getInputOrTextarea().setRangeText(...e),this.value=this.getInputOrTextarea().value}setSelectionRange(e,t,i){this.getInputOrTextarea().setSelectionRange(e,t,i)}showPicker(){const e=this.getInput();e&&e.showPicker()}stepDown(e){const t=this.getInput();t&&(t.stepDown(e),this.value=t.value)}stepUp(e){const t=this.getInput();t&&(t.stepUp(e),this.value=t.value)}reset(){this.dirty=!1,this.value=this.getAttribute("value")??"",this.nativeError=!1,this.nativeErrorText=""}attributeChangedCallback(e,t,i){"value"===e&&this.dirty||super.attributeChangedCallback(e,t,i)}render(){const e={disabled:this.disabled,error:!this.disabled&&this.hasError,textarea:"textarea"===this.type,"no-spinner":this.noSpinner};return o`
      <span class="text-field ${h(e)}">
        ${this.renderField()}
      </span>
    `}updated(e){const t=this.getInputOrTextarea().value;this.value!==t&&(this.value=t)}renderField(){return Q`<${this.fieldTag}
      class="field"
      count=${this.value.length}
      ?disabled=${this.disabled}
      ?error=${this.hasError}
      error-text=${this.getErrorText()}
      ?focused=${this.focused}
      ?has-end=${this.hasTrailingIcon}
      ?has-start=${this.hasLeadingIcon}
      label=${this.label}
      ?no-asterisk=${this.noAsterisk}
      max=${this.maxLength}
      ?populated=${!!this.value}
      ?required=${this.required}
      ?resizable=${"textarea"===this.type}
      supporting-text=${this.supportingText}
    >
      ${this.renderLeadingIcon()}
      ${this.renderInputOrTextarea()}
      ${this.renderTrailingIcon()}
      <div id="description" slot="aria-describedby"></div>
      <slot name="container" slot="container"></slot>
    </${this.fieldTag}>`}renderLeadingIcon(){return o`
      <span class="icon leading" slot="start">
        <slot name="leading-icon" @slotchange=${this.handleIconChange}></slot>
      </span>
    `}renderTrailingIcon(){return o`
      <span class="icon trailing" slot="end">
        <slot name="trailing-icon" @slotchange=${this.handleIconChange}></slot>
      </span>
    `}renderInputOrTextarea(){const e={direction:this.textDirection},t=this.ariaLabel||this.label||c,i=this.autocomplete,r=(this.maxLength??-1)>-1,a=(this.minLength??-1)>-1;if("textarea"===this.type)return o`
        <textarea
          class="input"
          style=${Ze(e)}
          aria-describedby="description"
          aria-invalid=${this.hasError}
          aria-label=${t}
          autocomplete=${i||c}
          name=${this.name||c}
          ?disabled=${this.disabled}
          maxlength=${r?this.maxLength:c}
          minlength=${a?this.minLength:c}
          placeholder=${this.placeholder||c}
          ?readonly=${this.readOnly}
          ?required=${this.required}
          rows=${this.rows}
          cols=${this.cols}
          .value=${He(this.value)}
          @change=${this.redispatchEvent}
          @focus=${this.handleFocusChange}
          @blur=${this.handleFocusChange}
          @input=${this.handleInput}
          @select=${this.redispatchEvent}></textarea>
      `;const s=this.renderPrefix(),n=this.renderSuffix(),l=this.inputMode;return o`
      <div class="input-wrapper">
        ${s}
        <input
          class="input"
          style=${Ze(e)}
          aria-describedby="description"
          aria-invalid=${this.hasError}
          aria-label=${t}
          autocomplete=${i||c}
          name=${this.name||c}
          ?disabled=${this.disabled}
          inputmode=${l||c}
          max=${this.max||c}
          maxlength=${r?this.maxLength:c}
          min=${this.min||c}
          minlength=${a?this.minLength:c}
          pattern=${this.pattern||c}
          placeholder=${this.placeholder||c}
          ?readonly=${this.readOnly}
          ?required=${this.required}
          ?multiple=${this.multiple}
          step=${this.step||c}
          type=${this.type}
          .value=${He(this.value)}
          @change=${this.redispatchEvent}
          @focus=${this.handleFocusChange}
          @blur=${this.handleFocusChange}
          @input=${this.handleInput}
          @select=${this.redispatchEvent} />
        ${n}
      </div>
    `}renderPrefix(){return this.renderAffix(this.prefixText,!1)}renderSuffix(){return this.renderAffix(this.suffixText,!0)}renderAffix(e,t){if(!e)return c;return o`<span class="${h({suffix:t,prefix:!t})}">${e}</span>`}getErrorText(){return this.error?this.errorText:this.nativeErrorText}handleFocusChange(){var e;this.focused=(null===(e=this.inputOrTextarea)||void 0===e?void 0:e.matches(":focus"))??!1}handleInput(e){this.dirty=!0,this.value=e.target.value}redispatchEvent(e){_(this,e)}getInputOrTextarea(){return this.inputOrTextarea||(this.connectedCallback(),this.scheduleUpdate()),this.isUpdatePending&&this.scheduleUpdate(),this.inputOrTextarea}getInput(){return"textarea"===this.type?null:this.getInputOrTextarea()}handleIconChange(){this.hasLeadingIcon=this.leadingIcons.length>0,this.hasTrailingIcon=this.trailingIcons.length>0}[he](){return this.value}formResetCallback(){this.reset()}formStateRestoreCallback(e){this.value=e}focus(){this.getInputOrTextarea().focus()}[ae](){return new et((()=>({state:this,renderedControl:this.inputOrTextarea})))}[se](){return this.inputOrTextarea}[je](e){null==e||e.preventDefault();const t=this.getErrorText();var i;(this.nativeError=!!e,this.nativeErrorText=this.validationMessage,t===this.getErrorText())&&(null===(i=this.field)||void 0===i||i.reannounceError())}}rt.shadowRootOptions={...r.shadowRootOptions,delegatesFocus:!0},t([s({type:Boolean,reflect:!0})],rt.prototype,"error",void 0),t([s({attribute:"error-text"})],rt.prototype,"errorText",void 0),t([s()],rt.prototype,"label",void 0),t([s({type:Boolean,attribute:"no-asterisk"})],rt.prototype,"noAsterisk",void 0),t([s({type:Boolean,reflect:!0})],rt.prototype,"required",void 0),t([s()],rt.prototype,"value",void 0),t([s({attribute:"prefix-text"})],rt.prototype,"prefixText",void 0),t([s({attribute:"suffix-text"})],rt.prototype,"suffixText",void 0),t([s({type:Boolean,attribute:"has-leading-icon"})],rt.prototype,"hasLeadingIcon",void 0),t([s({type:Boolean,attribute:"has-trailing-icon"})],rt.prototype,"hasTrailingIcon",void 0),t([s({attribute:"supporting-text"})],rt.prototype,"supportingText",void 0),t([s({attribute:"text-direction"})],rt.prototype,"textDirection",void 0),t([s({type:Number})],rt.prototype,"rows",void 0),t([s({type:Number})],rt.prototype,"cols",void 0),t([s({reflect:!0})],rt.prototype,"inputMode",void 0),t([s()],rt.prototype,"max",void 0),t([s({type:Number})],rt.prototype,"maxLength",void 0),t([s()],rt.prototype,"min",void 0),t([s({type:Number})],rt.prototype,"minLength",void 0),t([s({type:Boolean,attribute:"no-spinner"})],rt.prototype,"noSpinner",void 0),t([s()],rt.prototype,"pattern",void 0),t([s({reflect:!0,converter:Ve})],rt.prototype,"placeholder",void 0),t([s({type:Boolean,reflect:!0})],rt.prototype,"readOnly",void 0),t([s({type:Boolean,reflect:!0})],rt.prototype,"multiple",void 0),t([s()],rt.prototype,"step",void 0),t([s({reflect:!0})],rt.prototype,"type",void 0),t([s({reflect:!0})],rt.prototype,"autocomplete",void 0),t([v()],rt.prototype,"dirty",void 0),t([v()],rt.prototype,"focused",void 0),t([v()],rt.prototype,"nativeError",void 0),t([v()],rt.prototype,"nativeErrorText",void 0),t([d(".input")],rt.prototype,"inputOrTextarea",void 0),t([d(".field")],rt.prototype,"field",void 0),t([i({slot:"leading-icon"})],rt.prototype,"leadingIcons",void 0),t([i({slot:"trailing-icon"})],rt.prototype,"trailingIcons",void 0);class ot extends rt{constructor(){super(...arguments),this.fieldTag=J`md-filled-field`}}const at=a`:host{display:inline-flex;outline:none;resize:both;text-align:start;-webkit-tap-highlight-color:rgba(0,0,0,0)}.text-field,.field{width:100%}.text-field{display:inline-flex}.field{cursor:text}.disabled .field{cursor:default}.text-field,.textarea .field{resize:inherit}slot[name=container]{border-radius:inherit}.icon{color:currentColor;display:flex;align-items:center;justify-content:center;fill:currentColor;position:relative}.icon ::slotted(*){display:flex;position:absolute}[has-start] .icon.leading{font-size:var(--_leading-icon-size);height:var(--_leading-icon-size);width:var(--_leading-icon-size)}[has-end] .icon.trailing{font-size:var(--_trailing-icon-size);height:var(--_trailing-icon-size);width:var(--_trailing-icon-size)}.input-wrapper{display:flex}.input-wrapper>*{all:inherit;padding:0}.input{caret-color:var(--_caret-color);overflow-x:hidden;text-align:inherit}.input::placeholder{color:currentColor;opacity:1}.input::-webkit-calendar-picker-indicator{display:none}.input::-webkit-search-decoration,.input::-webkit-search-cancel-button{display:none}@media(forced-colors: active){.input{background:none}}.no-spinner .input::-webkit-inner-spin-button,.no-spinner .input::-webkit-outer-spin-button{display:none}.no-spinner .input[type=number]{-moz-appearance:textfield}:focus-within .input{caret-color:var(--_focus-caret-color)}.error:focus-within .input{caret-color:var(--_error-focus-caret-color)}.text-field:not(.disabled) .prefix{color:var(--_input-text-prefix-color)}.text-field:not(.disabled) .suffix{color:var(--_input-text-suffix-color)}.text-field:not(.disabled) .input::placeholder{color:var(--_input-text-placeholder-color)}.prefix,.suffix{text-wrap:nowrap;width:min-content}.prefix{padding-inline-end:var(--_input-text-prefix-trailing-space)}.suffix{padding-inline-start:var(--_input-text-suffix-leading-space)}
`;class st extends ot{constructor(){super(...arguments),this.fieldTag=J`md-filled-field`}}st.styles=[at,Pe],customElements.define("ew-filled-text-field",st);class nt extends r{connectedCallback(){super.connectedCallback(),this.setAttribute("aria-hidden","true")}render(){return o`<span class="shadow"></span>`}}const lt=a`:host,.shadow,.shadow::before,.shadow::after{border-radius:inherit;inset:0;position:absolute;transition-duration:inherit;transition-property:inherit;transition-timing-function:inherit}:host{display:flex;pointer-events:none;transition-property:box-shadow,opacity}.shadow::before,.shadow::after{content:"";transition-property:box-shadow,opacity;--_level: var(--md-elevation-level, 0);--_shadow-color: var(--md-elevation-shadow-color, var(--md-sys-color-shadow, #000))}.shadow::before{box-shadow:0px calc(1px*(clamp(0,var(--_level),1) + clamp(0,var(--_level) - 3,1) + 2*clamp(0,var(--_level) - 4,1))) calc(1px*(2*clamp(0,var(--_level),1) + clamp(0,var(--_level) - 2,1) + clamp(0,var(--_level) - 4,1))) 0px var(--_shadow-color);opacity:.3}.shadow::after{box-shadow:0px calc(1px*(clamp(0,var(--_level),1) + clamp(0,var(--_level) - 1,1) + 2*clamp(0,var(--_level) - 2,3))) calc(1px*(3*clamp(0,var(--_level),2) + 2*clamp(0,var(--_level) - 2,3))) calc(1px*(clamp(0,var(--_level),4) + 2*clamp(0,var(--_level) - 4,1))) var(--_shadow-color);opacity:.15}
`;let dt=class extends nt{};dt.styles=[lt],dt=t([n("md-elevation")],dt);const ct=function(e,t){return new CustomEvent("close-menu",{bubbles:!0,composed:!0,detail:{initiator:e,reason:t,itemPath:[e]}})},ht={SPACE:"Space",ENTER:"Enter"},pt="click-selection",ut="keydown",ft={ESCAPE:"Escape",SPACE:ht.SPACE,ENTER:ht.ENTER};function mt(e){return Object.values(ft).some((t=>t===e))}function vt(e,t){const i=new Event("md-contains",{bubbles:!0,composed:!0});let r=[];const o=e=>{r=e.composedPath()};t.addEventListener("md-contains",o),e.dispatchEvent(i),t.removeEventListener("md-contains",o);return r.length>0}const gt="none",bt="list-root",_t="first-item",yt="last-item",wt="end-start",xt="start-start";class kt{constructor(e,t){this.host=e,this.getProperties=t,this.surfaceStylesInternal={display:"none"},this.lastValues={isOpen:!1},this.host.addController(this)}get surfaceStyles(){return this.surfaceStylesInternal}async position(){const{surfaceEl:e,anchorEl:t,anchorCorner:i,surfaceCorner:r,positioning:o,xOffset:a,yOffset:s,disableBlockFlip:n,disableInlineFlip:l,repositionStrategy:d}=this.getProperties(),c=i.toLowerCase().trim(),h=r.toLowerCase().trim();if(!e||!t)return;const p=window.innerWidth,u=window.innerHeight,f=document.createElement("div");f.style.opacity="0",f.style.position="fixed",f.style.display="block",f.style.inset="0",document.body.appendChild(f);const m=f.getBoundingClientRect();f.remove();const v=window.innerHeight-m.bottom,g=window.innerWidth-m.right;this.surfaceStylesInternal={display:"block",opacity:"0"},this.host.requestUpdate(),await this.host.updateComplete,e.popover&&e.isConnected&&e.showPopover();const b=e.getSurfacePositionClientRect?e.getSurfacePositionClientRect():e.getBoundingClientRect(),_=t.getSurfacePositionClientRect?t.getSurfacePositionClientRect():t.getBoundingClientRect(),[y,w]=h.split("-"),[x,k]=c.split("-"),E="ltr"===getComputedStyle(e).direction;let{blockInset:S,blockOutOfBoundsCorrection:A,surfaceBlockProperty:C}=this.calculateBlock({surfaceRect:b,anchorRect:_,anchorBlock:x,surfaceBlock:y,yOffset:s,positioning:o,windowInnerHeight:u,blockScrollbarHeight:v});if(A&&!n){const e="start"===y?"end":"start",t="start"===x?"end":"start",i=this.calculateBlock({surfaceRect:b,anchorRect:_,anchorBlock:t,surfaceBlock:e,yOffset:s,positioning:o,windowInnerHeight:u,blockScrollbarHeight:v});A>i.blockOutOfBoundsCorrection&&(S=i.blockInset,A=i.blockOutOfBoundsCorrection,C=i.surfaceBlockProperty)}let{inlineInset:T,inlineOutOfBoundsCorrection:R,surfaceInlineProperty:I}=this.calculateInline({surfaceRect:b,anchorRect:_,anchorInline:k,surfaceInline:w,xOffset:a,positioning:o,isLTR:E,windowInnerWidth:p,inlineScrollbarWidth:g});if(R&&!l){const e="start"===w?"end":"start",t="start"===k?"end":"start",i=this.calculateInline({surfaceRect:b,anchorRect:_,anchorInline:t,surfaceInline:e,xOffset:a,positioning:o,isLTR:E,windowInnerWidth:p,inlineScrollbarWidth:g});Math.abs(R)>Math.abs(i.inlineOutOfBoundsCorrection)&&(T=i.inlineInset,R=i.inlineOutOfBoundsCorrection,I=i.surfaceInlineProperty)}"move"===d&&(S-=A,T-=R),this.surfaceStylesInternal={display:"block",opacity:"1",[C]:`${S}px`,[I]:`${T}px`},"resize"===d&&(A&&(this.surfaceStylesInternal.height=b.height-A+"px"),R&&(this.surfaceStylesInternal.width=b.width-R+"px")),this.host.requestUpdate()}calculateBlock(e){const{surfaceRect:t,anchorRect:i,anchorBlock:r,surfaceBlock:o,yOffset:a,positioning:s,windowInnerHeight:n,blockScrollbarHeight:l}=e,d="fixed"===s||"document"===s?1:0,c="document"===s?1:0,h="start"===o?1:0,p="end"===o?1:0,u=(r!==o?1:0)*i.height+a,f=h*i.top+p*(n-i.bottom-l);return{blockInset:d*f+c*(h*window.scrollY-p*window.scrollY)+u,blockOutOfBoundsCorrection:Math.abs(Math.min(0,n-f-u-t.height)),surfaceBlockProperty:"start"===o?"inset-block-start":"inset-block-end"}}calculateInline(e){const{isLTR:t,surfaceInline:i,anchorInline:r,anchorRect:o,surfaceRect:a,xOffset:s,positioning:n,windowInnerWidth:l,inlineScrollbarWidth:d}=e,c="fixed"===n||"document"===n?1:0,h="document"===n?1:0,p=t?1:0,u=t?0:1,f="start"===i?1:0,m="end"===i?1:0,v=(r!==i?1:0)*o.width+s,g=p*(f*o.left+m*(l-o.right-d))+u*(f*(l-o.right-d)+m*o.left);let b="start"===i?"inset-inline-start":"inset-inline-end";return"document"!==n&&"fixed"!==n||(b="start"===i&&t||"end"===i&&!t?"left":"right"),{inlineInset:c*g+v+h*(p*(f*window.scrollX-m*window.scrollX)+u*(m*window.scrollX-f*window.scrollX)),inlineOutOfBoundsCorrection:Math.abs(Math.min(0,l-g-v-a.width)),surfaceInlineProperty:b}}hostUpdate(){this.onUpdate()}hostUpdated(){this.onUpdate()}async onUpdate(){const e=this.getProperties();let t=!1;for(const[i,r]of Object.entries(e))if(t=t||r!==this.lastValues[i],t)break;const i=this.lastValues.isOpen!==e.isOpen,r=!!e.anchorEl,o=!!e.surfaceEl;t&&r&&o&&(this.lastValues.isOpen=e.isOpen,e.isOpen?(this.lastValues=e,await this.position(),e.onOpen()):i&&(await e.beforeClose(),this.close(),e.onClose()))}close(){this.surfaceStylesInternal={display:"none"},this.host.requestUpdate();const e=this.getProperties().surfaceEl;null!=e&&e.popover&&null!=e&&e.isConnected&&e.hidePopover()}}const Et=0,St=1,At=2;class Ct{constructor(e){this.getProperties=e,this.typeaheadRecords=[],this.typaheadBuffer="",this.cancelTypeaheadTimeout=0,this.isTypingAhead=!1,this.lastActiveRecord=null,this.onKeydown=e=>{this.isTypingAhead?this.typeahead(e):this.beginTypeahead(e)},this.endTypeahead=()=>{this.isTypingAhead=!1,this.typaheadBuffer="",this.typeaheadRecords=[]}}get items(){return this.getProperties().getItems()}get active(){return this.getProperties().active}beginTypeahead(e){this.active&&("Space"===e.code||"Enter"===e.code||e.code.startsWith("Arrow")||"Escape"===e.code||(this.isTypingAhead=!0,this.typeaheadRecords=this.items.map(((e,t)=>[t,e,e.typeaheadText.trim().toLowerCase()])),this.lastActiveRecord=this.typeaheadRecords.find((e=>0===e[St].tabIndex))??null,this.lastActiveRecord&&(this.lastActiveRecord[St].tabIndex=-1),this.typeahead(e)))}typeahead(e){if(e.defaultPrevented)return;if(clearTimeout(this.cancelTypeaheadTimeout),"Enter"===e.code||e.code.startsWith("Arrow")||"Escape"===e.code)return this.endTypeahead(),void(this.lastActiveRecord&&(this.lastActiveRecord[St].tabIndex=-1));"Space"===e.code&&e.preventDefault(),this.cancelTypeaheadTimeout=setTimeout(this.endTypeahead,this.getProperties().typeaheadBufferTime),this.typaheadBuffer+=e.key.toLowerCase();const t=this.lastActiveRecord?this.lastActiveRecord[Et]:-1,i=this.typeaheadRecords.length,r=e=>(e[Et]+i-t)%i,o=this.typeaheadRecords.filter((e=>!e[St].disabled&&e[At].startsWith(this.typaheadBuffer))).sort(((e,t)=>r(e)-r(t)));if(0===o.length)return clearTimeout(this.cancelTypeaheadTimeout),this.lastActiveRecord&&(this.lastActiveRecord[St].tabIndex=-1),void this.endTypeahead();const a=1===this.typaheadBuffer.length;let s;s=this.lastActiveRecord===o[0]&&a?o[1]??o[0]:o[0],this.lastActiveRecord&&(this.lastActiveRecord[St].tabIndex=-1),this.lastActiveRecord=s,s[St].tabIndex=0,s[St].focus()}}const Tt=new Set([U.ArrowDown,U.ArrowUp,U.Home,U.End]),Rt=new Set([U.ArrowLeft,U.ArrowRight,...Tt]);class It extends r{get openDirection(){return"start"===this.menuCorner.split("-")[0]?"DOWN":"UP"}get anchorElement(){return this.anchor?this.getRootNode().querySelector(`#${this.anchor}`):this.currentAnchorElement}set anchorElement(e){this.currentAnchorElement=e,this.requestUpdate("anchorElement")}constructor(){super(),this.anchor="",this.positioning="absolute",this.quick=!1,this.hasOverflow=!1,this.open=!1,this.xOffset=0,this.yOffset=0,this.noHorizontalFlip=!1,this.noVerticalFlip=!1,this.typeaheadDelay=200,this.anchorCorner=wt,this.menuCorner=xt,this.stayOpenOnOutsideClick=!1,this.stayOpenOnFocusout=!1,this.skipRestoreFocus=!1,this.defaultFocus=_t,this.noNavigationWrap=!1,this.typeaheadActive=!0,this.isSubmenu=!1,this.pointerPath=[],this.isRepositioning=!1,this.openCloseAnimationSignal=C(),this.listController=new M({isItem:e=>e.hasAttribute("md-menu-item"),getPossibleItems:()=>this.slotItems,isRtl:()=>"rtl"===getComputedStyle(this).direction,deactivateItem:e=>{e.selected=!1,e.tabIndex=-1},activateItem:e=>{e.selected=!0,e.tabIndex=0},isNavigableKey:e=>{if(!this.isSubmenu)return Rt.has(e);return e===("rtl"===getComputedStyle(this).direction?U.ArrowLeft:U.ArrowRight)||Tt.has(e)},wrapNavigation:()=>!this.noNavigationWrap}),this.lastFocusedElement=null,this.typeaheadController=new Ct((()=>({getItems:()=>this.items,typeaheadBufferTime:this.typeaheadDelay,active:this.typeaheadActive}))),this.currentAnchorElement=null,this.internals=this.attachInternals(),this.menuPositionController=new kt(this,(()=>({anchorCorner:this.anchorCorner,surfaceCorner:this.menuCorner,surfaceEl:this.surfaceEl,anchorEl:this.anchorElement,positioning:"popover"===this.positioning?"document":this.positioning,isOpen:this.open,xOffset:this.xOffset,yOffset:this.yOffset,disableBlockFlip:this.noVerticalFlip,disableInlineFlip:this.noHorizontalFlip,onOpen:this.onOpened,beforeClose:this.beforeClose,onClose:this.onClosed,repositionStrategy:this.hasOverflow&&"popover"!==this.positioning?"move":"resize"}))),this.onWindowResize=()=>{this.isRepositioning||"document"!==this.positioning&&"fixed"!==this.positioning&&"popover"!==this.positioning||(this.isRepositioning=!0,this.reposition(),this.isRepositioning=!1)},this.handleFocusout=async e=>{const t=this.anchorElement;if(this.stayOpenOnFocusout||!this.open||this.pointerPath.includes(t))return;if(e.relatedTarget){if(vt(e.relatedTarget,this)||0!==this.pointerPath.length&&vt(e.relatedTarget,t))return}else if(this.pointerPath.includes(this))return;const i=this.skipRestoreFocus;this.skipRestoreFocus=!0,this.close(),await this.updateComplete,this.skipRestoreFocus=i},this.onOpened=async()=>{this.lastFocusedElement=function(e=document){let t=e.activeElement;for(;t&&null!==(i=t)&&void 0!==i&&null!==(i=i.shadowRoot)&&void 0!==i&&i.activeElement;){var i;t=t.shadowRoot.activeElement}return t}();const e=this.items,t=D(e);t&&this.defaultFocus!==gt&&(t.item.tabIndex=-1);let i=!this.quick;switch(this.quick?this.dispatchEvent(new Event("opening")):i=!!await this.animateOpen(),this.defaultFocus){case _t:const t=F(e);t&&(t.tabIndex=0,t.focus(),await t.updateComplete);break;case yt:const i=P(e);i&&(i.tabIndex=0,i.focus(),await i.updateComplete);break;case bt:this.focus()}i||this.dispatchEvent(new Event("opened"))},this.beforeClose=async()=>{var e,t;(this.open=!1,this.skipRestoreFocus)||(null===(e=this.lastFocusedElement)||void 0===e||null===(t=e.focus)||void 0===t||t.call(e));this.quick||await this.animateClose()},this.onClosed=()=>{this.quick&&(this.dispatchEvent(new Event("closing")),this.dispatchEvent(new Event("closed")))},this.onWindowPointerdown=e=>{this.pointerPath=e.composedPath()},this.onDocumentClick=e=>{if(!this.open)return;const t=e.composedPath();this.stayOpenOnOutsideClick||t.includes(this)||t.includes(this.anchorElement)||(this.open=!1)},this.internals.role="menu",this.addEventListener("keydown",this.handleKeydown),this.addEventListener("keydown",this.captureKeydown,{capture:!0}),this.addEventListener("focusout",this.handleFocusout)}get items(){return this.listController.items}willUpdate(e){e.has("open")&&(this.open?this.removeAttribute("aria-hidden"):this.setAttribute("aria-hidden","true"))}update(e){e.has("open")&&(this.open?this.setUpGlobalEventListeners():this.cleanUpGlobalEventListeners()),e.has("positioning")&&"popover"===this.positioning&&!this.showPopover&&(this.positioning="fixed"),super.update(e)}connectedCallback(){super.connectedCallback(),this.open&&this.setUpGlobalEventListeners()}disconnectedCallback(){super.disconnectedCallback(),this.cleanUpGlobalEventListeners()}getBoundingClientRect(){return this.surfaceEl?this.surfaceEl.getBoundingClientRect():super.getBoundingClientRect()}getClientRects(){return this.surfaceEl?this.surfaceEl.getClientRects():super.getClientRects()}render(){return this.renderSurface()}renderSurface(){return o`
      <div
        class="menu ${h(this.getSurfaceClasses())}"
        style=${Ze(this.menuPositionController.surfaceStyles)}
        popover=${"popover"===this.positioning?"manual":c}>
        ${this.renderElevation()}
        <div class="items">
          <div class="item-padding"> ${this.renderMenuItems()} </div>
        </div>
      </div>
    `}renderMenuItems(){return o`<slot
      @close-menu=${this.onCloseMenu}
      @deactivate-items=${this.onDeactivateItems}
      @request-activation=${this.onRequestActivation}
      @deactivate-typeahead=${this.handleDeactivateTypeahead}
      @activate-typeahead=${this.handleActivateTypeahead}
      @stay-open-on-focusout=${this.handleStayOpenOnFocusout}
      @close-on-focusout=${this.handleCloseOnFocusout}
      @slotchange=${this.listController.onSlotchange}></slot>`}renderElevation(){return o`<md-elevation part="elevation"></md-elevation>`}getSurfaceClasses(){return{open:this.open,fixed:"fixed"===this.positioning,"has-overflow":this.hasOverflow}}captureKeydown(e){e.target===this&&!e.defaultPrevented&&mt(e.code)&&(e.preventDefault(),this.close()),this.typeaheadController.onKeydown(e)}async animateOpen(){const e=this.surfaceEl,t=this.slotEl;if(!e||!t)return!0;const i=this.openDirection;this.dispatchEvent(new Event("opening")),e.classList.toggle("animating",!0);const r=this.openCloseAnimationSignal.start(),o=e.offsetHeight,a="UP"===i,s=this.items,n=250/s.length,l=e.animate([{height:"0px"},{height:`${o}px`}],{duration:500,easing:x.EMPHASIZED}),d=t.animate([{transform:a?`translateY(-${o}px)`:""},{transform:""}],{duration:500,easing:x.EMPHASIZED}),c=e.animate([{opacity:0},{opacity:1}],50),h=[];for(let e=0;e<s.length;e++){const t=s[a?s.length-1-e:e],i=t.animate([{opacity:0},{opacity:1}],{duration:250,delay:n*e});t.classList.toggle("md-menu-hidden",!0),i.addEventListener("finish",(()=>{t.classList.toggle("md-menu-hidden",!1)})),h.push([t,i])}let p=e=>{};const u=new Promise((e=>{p=e}));return r.addEventListener("abort",(()=>{l.cancel(),d.cancel(),c.cancel(),h.forEach((([e,t])=>{e.classList.toggle("md-menu-hidden",!1),t.cancel()})),p(!0)})),l.addEventListener("finish",(()=>{e.classList.toggle("animating",!1),this.openCloseAnimationSignal.finish(),p(!1)})),await u}animateClose(){let e;const t=new Promise((t=>{e=t})),i=this.surfaceEl,r=this.slotEl;if(!i||!r)return e(!1),t;const o="UP"===this.openDirection;this.dispatchEvent(new Event("closing")),i.classList.toggle("animating",!0);const a=this.openCloseAnimationSignal.start(),s=i.offsetHeight,n=this.items,l=150,d=50/n.length,c=i.animate([{height:`${s}px`},{height:.35*s+"px"}],{duration:l,easing:x.EMPHASIZED_ACCELERATE}),h=r.animate([{transform:""},{transform:o?`translateY(-${.65*s}px)`:""}],{duration:l,easing:x.EMPHASIZED_ACCELERATE}),p=i.animate([{opacity:1},{opacity:0}],{duration:50,delay:100}),u=[];for(let e=0;e<n.length;e++){const t=n[o?e:n.length-1-e],i=t.animate([{opacity:1},{opacity:0}],{duration:50,delay:50+d*e});i.addEventListener("finish",(()=>{t.classList.toggle("md-menu-hidden",!0)})),u.push([t,i])}return a.addEventListener("abort",(()=>{c.cancel(),h.cancel(),p.cancel(),u.forEach((([e,t])=>{t.cancel(),e.classList.toggle("md-menu-hidden",!1)})),e(!1)})),c.addEventListener("finish",(()=>{i.classList.toggle("animating",!1),u.forEach((([e])=>{e.classList.toggle("md-menu-hidden",!1)})),this.openCloseAnimationSignal.finish(),this.dispatchEvent(new Event("closed")),e(!0)})),t}handleKeydown(e){this.pointerPath=[],this.listController.handleKeydown(e)}setUpGlobalEventListeners(){document.addEventListener("click",this.onDocumentClick,{capture:!0}),window.addEventListener("pointerdown",this.onWindowPointerdown),document.addEventListener("resize",this.onWindowResize,{passive:!0}),window.addEventListener("resize",this.onWindowResize,{passive:!0})}cleanUpGlobalEventListeners(){document.removeEventListener("click",this.onDocumentClick,{capture:!0}),window.removeEventListener("pointerdown",this.onWindowPointerdown),document.removeEventListener("resize",this.onWindowResize),window.removeEventListener("resize",this.onWindowResize)}onCloseMenu(){this.close()}onDeactivateItems(e){e.stopPropagation(),this.listController.onDeactivateItems()}onRequestActivation(e){e.stopPropagation(),this.listController.onRequestActivation(e)}handleDeactivateTypeahead(e){e.stopPropagation(),this.typeaheadActive=!1}handleActivateTypeahead(e){e.stopPropagation(),this.typeaheadActive=!0}handleStayOpenOnFocusout(e){e.stopPropagation(),this.stayOpenOnFocusout=!0}handleCloseOnFocusout(e){e.stopPropagation(),this.stayOpenOnFocusout=!1}close(){this.open=!1;this.slotItems.forEach((e=>{var t;null===(t=e.close)||void 0===t||t.call(e)}))}show(){this.open=!0}activateNextItem(){return this.listController.activateNextItem()??null}activatePreviousItem(){return this.listController.activatePreviousItem()??null}reposition(){this.open&&this.menuPositionController.position()}}t([d(".menu")],It.prototype,"surfaceEl",void 0),t([d("slot")],It.prototype,"slotEl",void 0),t([s()],It.prototype,"anchor",void 0),t([s()],It.prototype,"positioning",void 0),t([s({type:Boolean})],It.prototype,"quick",void 0),t([s({type:Boolean,attribute:"has-overflow"})],It.prototype,"hasOverflow",void 0),t([s({type:Boolean,reflect:!0})],It.prototype,"open",void 0),t([s({type:Number,attribute:"x-offset"})],It.prototype,"xOffset",void 0),t([s({type:Number,attribute:"y-offset"})],It.prototype,"yOffset",void 0),t([s({type:Boolean,attribute:"no-horizontal-flip"})],It.prototype,"noHorizontalFlip",void 0),t([s({type:Boolean,attribute:"no-vertical-flip"})],It.prototype,"noVerticalFlip",void 0),t([s({type:Number,attribute:"typeahead-delay"})],It.prototype,"typeaheadDelay",void 0),t([s({attribute:"anchor-corner"})],It.prototype,"anchorCorner",void 0),t([s({attribute:"menu-corner"})],It.prototype,"menuCorner",void 0),t([s({type:Boolean,attribute:"stay-open-on-outside-click"})],It.prototype,"stayOpenOnOutsideClick",void 0),t([s({type:Boolean,attribute:"stay-open-on-focusout"})],It.prototype,"stayOpenOnFocusout",void 0),t([s({type:Boolean,attribute:"skip-restore-focus"})],It.prototype,"skipRestoreFocus",void 0),t([s({attribute:"default-focus"})],It.prototype,"defaultFocus",void 0),t([s({type:Boolean,attribute:"no-navigation-wrap"})],It.prototype,"noNavigationWrap",void 0),t([i({flatten:!0})],It.prototype,"slotItems",void 0),t([v()],It.prototype,"typeaheadActive",void 0);const $t=a`:host{--md-elevation-level: var(--md-menu-container-elevation, 2);--md-elevation-shadow-color: var(--md-menu-container-shadow-color, var(--md-sys-color-shadow, #000));min-width:112px;color:unset;display:contents}md-focus-ring{--md-focus-ring-shape: var(--md-menu-container-shape, var(--md-sys-shape-corner-extra-small, 4px))}.menu{border-radius:var(--md-menu-container-shape, var(--md-sys-shape-corner-extra-small, 4px));display:none;inset:auto;border:none;padding:0px;overflow:visible;background-color:rgba(0,0,0,0);color:inherit;opacity:0;z-index:20;position:absolute;user-select:none;max-height:inherit;height:inherit;min-width:inherit;max-width:inherit;scrollbar-width:inherit}.menu::backdrop{display:none}.fixed{position:fixed}.items{display:block;list-style-type:none;margin:0;outline:none;box-sizing:border-box;background-color:var(--md-menu-container-color, var(--md-sys-color-surface-container, #f3edf7));height:inherit;max-height:inherit;overflow:auto;min-width:inherit;max-width:inherit;border-radius:inherit;scrollbar-width:inherit}.item-padding{padding-block:var(--md-menu-top-space, 8px) var(--md-menu-bottom-space, 8px)}.has-overflow:not([popover]) .items{overflow:visible}.has-overflow.animating .items,.animating .items{overflow:hidden}.has-overflow.animating .items{pointer-events:none}.animating ::slotted(.md-menu-hidden){opacity:0}slot{display:block;height:inherit;max-height:inherit}::slotted(:is(md-divider,[role=separator])){margin:8px 0}@media(forced-colors: active){.menu{border-style:solid;border-color:CanvasText;border-width:1px}}
`;let Lt=class extends It{};Lt.styles=[$t],Lt=t([n("md-menu")],Lt);class Dt extends fe{computeValidity(e){return this.selectControl||(this.selectControl=document.createElement("select")),w(o`<option value=${e.value}></option>`,this.selectControl),this.selectControl.value=e.value,this.selectControl.required=e.required,{validity:this.selectControl.validity,validationMessage:this.selectControl.validationMessage}}equals(e,t){return e.value===t.value&&e.required===t.required}copy({value:e,required:t}){return{value:e,required:t}}}var Ft;const Pt=Symbol("value"),Ot=l(Xe(ce(ue(m(r)))));class zt extends Ot{get value(){return this[Pt]}set value(e){this.lastUserSetValue=e,this.select(e)}get options(){var e;return(null===(e=this.menu)||void 0===e?void 0:e.items)??[]}get selectedIndex(){const[e,t]=(this.getSelectedOptions()??[])[0]??[];return t??-1}set selectedIndex(e){this.lastUserSetSelectedIndex=e,this.selectIndex(e)}get selectedOptions(){return(this.getSelectedOptions()??[]).map((([e])=>e))}get hasError(){return this.error||this.nativeError}constructor(){super(),this.quick=!1,this.required=!1,this.errorText="",this.label="",this.noAsterisk=!1,this.supportingText="",this.error=!1,this.menuPositioning="popover",this.clampMenuWidth=!1,this.typeaheadDelay=200,this.hasLeadingIcon=!1,this.displayText="",this.menuAlign="start",this[Ft]="",this.lastUserSetValue=null,this.lastUserSetSelectedIndex=null,this.lastSelectedOption=null,this.lastSelectedOptionRecords=[],this.nativeError=!1,this.nativeErrorText="",this.focused=!1,this.open=!1,this.defaultFocus=gt,this.prevOpen=this.open,this.selectWidth=0,this.addEventListener("focus",this.handleFocus.bind(this)),this.addEventListener("blur",this.handleBlur.bind(this))}select(e){const t=this.options.find((t=>t.value===e));t&&this.selectItem(t)}selectIndex(e){const t=this.options[e];t&&this.selectItem(t)}reset(){for(const e of this.options)e.selected=e.hasAttribute("selected");this.updateValueAndDisplayText(),this.nativeError=!1,this.nativeErrorText=""}[(Ft=Pt,je)](e){null==e||e.preventDefault();const t=this.getErrorText();var i;(this.nativeError=!!e,this.nativeErrorText=this.validationMessage,t===this.getErrorText())&&(null===(i=this.field)||void 0===i||i.reannounceError())}update(e){if(this.hasUpdated||this.initUserSelection(),this.prevOpen!==this.open&&this.open){const e=this.getBoundingClientRect();this.selectWidth=e.width}this.prevOpen=this.open,super.update(e)}render(){return o`
      <span
        class="select ${h(this.getRenderClasses())}"
        @focusout=${this.handleFocusout}>
        ${this.renderField()} ${this.renderMenu()}
      </span>
    `}async firstUpdated(e){var t;await(null===(t=this.menu)||void 0===t?void 0:t.updateComplete),this.lastSelectedOptionRecords.length||this.initUserSelection(),this.lastSelectedOptionRecords.length||this.options.length||setTimeout((()=>{this.updateValueAndDisplayText()})),super.firstUpdated(e)}getRenderClasses(){return{disabled:this.disabled,error:this.error,open:this.open}}renderField(){const e=this.ariaLabel||this.label;return Q`
      <${this.fieldTag}
          aria-haspopup="listbox"
          role="combobox"
          part="field"
          id="field"
          tabindex=${this.disabled?"-1":"0"}
          aria-label=${e||c}
          aria-describedby="description"
          aria-expanded=${this.open?"true":"false"}
          aria-controls="listbox"
          class="field"
          label=${this.label}
          ?no-asterisk=${this.noAsterisk}
          .focused=${this.focused||this.open}
          .populated=${!!this.displayText}
          .disabled=${this.disabled}
          .required=${this.required}
          .error=${this.hasError}
          ?has-start=${this.hasLeadingIcon}
          has-end
          supporting-text=${this.supportingText}
          error-text=${this.getErrorText()}
          @keydown=${this.handleKeydown}
          @click=${this.handleClick}>
         ${this.renderFieldContent()}
         <div id="description" slot="aria-describedby"></div>
      </${this.fieldTag}>`}renderFieldContent(){return[this.renderLeadingIcon(),this.renderLabel(),this.renderTrailingIcon()]}renderLeadingIcon(){return o`
      <span class="icon leading" slot="start">
        <slot name="leading-icon" @slotchange=${this.handleIconChange}></slot>
      </span>
    `}renderTrailingIcon(){return o`
      <span class="icon trailing" slot="end">
        <slot name="trailing-icon" @slotchange=${this.handleIconChange}>
          <svg height="5" viewBox="7 10 10 5" focusable="false">
            <polygon
              class="down"
              stroke="none"
              fill-rule="evenodd"
              points="7 10 12 15 17 10"></polygon>
            <polygon
              class="up"
              stroke="none"
              fill-rule="evenodd"
              points="7 15 12 10 17 15"></polygon>
          </svg>
        </slot>
      </span>
    `}renderLabel(){return o`<div id="label">${this.displayText||o`&nbsp;`}</div>`}renderMenu(){const e=this.label||this.ariaLabel;return o`<div class="menu-wrapper">
      <md-menu
        id="listbox"
        .defaultFocus=${this.defaultFocus}
        role="listbox"
        tabindex="-1"
        aria-label=${e||c}
        stay-open-on-focusout
        part="menu"
        exportparts="focus-ring: menu-focus-ring"
        anchor="field"
        style=${Ze({"--__menu-min-width":`${this.selectWidth}px`,"--__menu-max-width":this.clampMenuWidth?`${this.selectWidth}px`:void 0})}
        no-navigation-wrap
        .open=${this.open}
        .quick=${this.quick}
        .positioning=${this.menuPositioning}
        .typeaheadDelay=${this.typeaheadDelay}
        .anchorCorner=${"start"===this.menuAlign?"end-start":"end-end"}
        .menuCorner=${"start"===this.menuAlign?"start-start":"start-end"}
        @opening=${this.handleOpening}
        @opened=${this.redispatchEvent}
        @closing=${this.redispatchEvent}
        @closed=${this.handleClosed}
        @close-menu=${this.handleCloseMenu}
        @request-selection=${this.handleRequestSelection}
        @request-deselection=${this.handleRequestDeselection}>
        ${this.renderMenuContent()}
      </md-menu>
    </div>`}renderMenuContent(){return o`<slot></slot>`}handleKeydown(e){if(this.open||this.disabled||!this.menu)return;const t=this.menu.typeaheadController,i="Space"===e.code||"ArrowDown"===e.code||"ArrowUp"===e.code||"End"===e.code||"Home"===e.code||"Enter"===e.code;if(!t.isTypingAhead&&i){switch(e.preventDefault(),this.open=!0,e.code){case"Space":case"ArrowDown":case"Enter":this.defaultFocus=gt;break;case"End":this.defaultFocus=yt;break;case"ArrowUp":case"Home":this.defaultFocus=_t}return}if(1===e.key.length){var r,o;t.onKeydown(e),e.preventDefault();const{lastActiveRecord:i}=t;if(!i)return;null===(r=this.labelEl)||void 0===r||null===(o=r.setAttribute)||void 0===o||o.call(r,"aria-live","polite");this.selectItem(i[St])&&this.dispatchInteractionEvents()}}handleClick(){this.open=!this.open}handleFocus(){this.focused=!0}handleBlur(){this.focused=!1}handleFocusout(e){e.relatedTarget&&vt(e.relatedTarget,this)||(this.open=!1)}getSelectedOptions(){if(!this.menu)return this.lastSelectedOptionRecords=[],null;const e=this.menu.items;return this.lastSelectedOptionRecords=function(e){const t=[];for(let i=0;i<e.length;i++){const r=e[i];r.selected&&t.push([r,i])}return t}(e),this.lastSelectedOptionRecords}async getUpdateComplete(){var e;return await(null===(e=this.menu)||void 0===e?void 0:e.updateComplete),super.getUpdateComplete()}updateValueAndDisplayText(){const e=this.getSelectedOptions()??[];let t=!1;if(e.length){const[i]=e[0];t=this.lastSelectedOption!==i,this.lastSelectedOption=i,this[Pt]=i.value,this.displayText=i.displayText}else t=null!==this.lastSelectedOption,this.lastSelectedOption=null,this[Pt]="",this.displayText="";return t}async handleOpening(e){var t,i,r;if(null===(t=this.labelEl)||void 0===t||null===(i=t.removeAttribute)||void 0===i||i.call(t,"aria-live"),this.redispatchEvent(e),this.defaultFocus!==gt)return;const o=this.menu.items,a=null===(r=D(o))||void 0===r?void 0:r.item;let[s]=this.lastSelectedOptionRecords[0]??[null];a&&a!==s&&(a.tabIndex=-1),s=s??o[0],s&&(s.tabIndex=0,s.focus())}redispatchEvent(e){_(this,e)}handleClosed(e){this.open=!1,this.redispatchEvent(e)}handleCloseMenu(e){const t=e.detail.reason,i=e.detail.itemPath[0];this.open=!1;let r=!1;var o;"click-selection"===t.kind||"keydown"===t.kind&&(o=t.key,Object.values(ht).some((e=>e===o)))?r=this.selectItem(i):(i.tabIndex=-1,i.blur()),r&&this.dispatchInteractionEvents()}selectItem(e){return(this.getSelectedOptions()??[]).forEach((([t])=>{e!==t&&(t.selected=!1)})),e.selected=!0,this.updateValueAndDisplayText()}handleRequestSelection(e){const t=e.target;this.lastSelectedOptionRecords.some((([e])=>e===t))||this.selectItem(t)}handleRequestDeselection(e){const t=e.target;this.lastSelectedOptionRecords.some((([e])=>e===t))&&this.updateValueAndDisplayText()}initUserSelection(){this.lastUserSetValue&&!this.lastSelectedOptionRecords.length?this.select(this.lastUserSetValue):null===this.lastUserSetSelectedIndex||this.lastSelectedOptionRecords.length?this.updateValueAndDisplayText():this.selectIndex(this.lastUserSetSelectedIndex)}handleIconChange(){this.hasLeadingIcon=this.leadingIcons.length>0}dispatchInteractionEvents(){this.dispatchEvent(new Event("input",{bubbles:!0,composed:!0})),this.dispatchEvent(new Event("change",{bubbles:!0}))}getErrorText(){return this.error?this.errorText:this.nativeErrorText}[he](){return this.value}formResetCallback(){this.reset()}formStateRestoreCallback(e){this.value=e}click(){var e;null===(e=this.field)||void 0===e||e.click()}[ae](){return new Dt((()=>this))}[se](){return this.field}}zt.shadowRootOptions={...r.shadowRootOptions,delegatesFocus:!0},t([s({type:Boolean})],zt.prototype,"quick",void 0),t([s({type:Boolean})],zt.prototype,"required",void 0),t([s({type:String,attribute:"error-text"})],zt.prototype,"errorText",void 0),t([s()],zt.prototype,"label",void 0),t([s({type:Boolean,attribute:"no-asterisk"})],zt.prototype,"noAsterisk",void 0),t([s({type:String,attribute:"supporting-text"})],zt.prototype,"supportingText",void 0),t([s({type:Boolean,reflect:!0})],zt.prototype,"error",void 0),t([s({attribute:"menu-positioning"})],zt.prototype,"menuPositioning",void 0),t([s({type:Boolean,attribute:"clamp-menu-width"})],zt.prototype,"clampMenuWidth",void 0),t([s({type:Number,attribute:"typeahead-delay"})],zt.prototype,"typeaheadDelay",void 0),t([s({type:Boolean,attribute:"has-leading-icon"})],zt.prototype,"hasLeadingIcon",void 0),t([s({attribute:"display-text"})],zt.prototype,"displayText",void 0),t([s({attribute:"menu-align"})],zt.prototype,"menuAlign",void 0),t([s()],zt.prototype,"value",null),t([s({type:Number,attribute:"selected-index"})],zt.prototype,"selectedIndex",null),t([v()],zt.prototype,"nativeError",void 0),t([v()],zt.prototype,"nativeErrorText",void 0),t([v()],zt.prototype,"focused",void 0),t([v()],zt.prototype,"open",void 0),t([v()],zt.prototype,"defaultFocus",void 0),t([d(".field")],zt.prototype,"field",void 0),t([d("md-menu")],zt.prototype,"menu",void 0),t([d("#label")],zt.prototype,"labelEl",void 0),t([i({slot:"leading-icon",flatten:!0})],zt.prototype,"leadingIcons",void 0);class Bt extends zt{constructor(){super(...arguments),this.fieldTag=J`md-filled-field`}}const Ut=a`:host{--_text-field-active-indicator-color: var(--md-filled-select-text-field-active-indicator-color, var(--md-sys-color-on-surface-variant, #49454f));--_text-field-active-indicator-height: var(--md-filled-select-text-field-active-indicator-height, 1px);--_text-field-container-color: var(--md-filled-select-text-field-container-color, var(--md-sys-color-surface-container-highest, #e6e0e9));--_text-field-disabled-active-indicator-color: var(--md-filled-select-text-field-disabled-active-indicator-color, var(--md-sys-color-on-surface, #1d1b20));--_text-field-disabled-active-indicator-height: var(--md-filled-select-text-field-disabled-active-indicator-height, 1px);--_text-field-disabled-active-indicator-opacity: var(--md-filled-select-text-field-disabled-active-indicator-opacity, 0.38);--_text-field-disabled-container-color: var(--md-filled-select-text-field-disabled-container-color, var(--md-sys-color-on-surface, #1d1b20));--_text-field-disabled-container-opacity: var(--md-filled-select-text-field-disabled-container-opacity, 0.04);--_text-field-disabled-input-text-color: var(--md-filled-select-text-field-disabled-input-text-color, var(--md-sys-color-on-surface, #1d1b20));--_text-field-disabled-input-text-opacity: var(--md-filled-select-text-field-disabled-input-text-opacity, 0.38);--_text-field-disabled-label-text-color: var(--md-filled-select-text-field-disabled-label-text-color, var(--md-sys-color-on-surface, #1d1b20));--_text-field-disabled-label-text-opacity: var(--md-filled-select-text-field-disabled-label-text-opacity, 0.38);--_text-field-disabled-leading-icon-color: var(--md-filled-select-text-field-disabled-leading-icon-color, var(--md-sys-color-on-surface, #1d1b20));--_text-field-disabled-leading-icon-opacity: var(--md-filled-select-text-field-disabled-leading-icon-opacity, 0.38);--_text-field-disabled-supporting-text-color: var(--md-filled-select-text-field-disabled-supporting-text-color, var(--md-sys-color-on-surface, #1d1b20));--_text-field-disabled-supporting-text-opacity: var(--md-filled-select-text-field-disabled-supporting-text-opacity, 0.38);--_text-field-disabled-trailing-icon-color: var(--md-filled-select-text-field-disabled-trailing-icon-color, var(--md-sys-color-on-surface, #1d1b20));--_text-field-disabled-trailing-icon-opacity: var(--md-filled-select-text-field-disabled-trailing-icon-opacity, 0.38);--_text-field-error-active-indicator-color: var(--md-filled-select-text-field-error-active-indicator-color, var(--md-sys-color-error, #b3261e));--_text-field-error-focus-active-indicator-color: var(--md-filled-select-text-field-error-focus-active-indicator-color, var(--md-sys-color-error, #b3261e));--_text-field-error-focus-input-text-color: var(--md-filled-select-text-field-error-focus-input-text-color, var(--md-sys-color-on-surface, #1d1b20));--_text-field-error-focus-label-text-color: var(--md-filled-select-text-field-error-focus-label-text-color, var(--md-sys-color-error, #b3261e));--_text-field-error-focus-leading-icon-color: var(--md-filled-select-text-field-error-focus-leading-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_text-field-error-focus-supporting-text-color: var(--md-filled-select-text-field-error-focus-supporting-text-color, var(--md-sys-color-error, #b3261e));--_text-field-error-focus-trailing-icon-color: var(--md-filled-select-text-field-error-focus-trailing-icon-color, var(--md-sys-color-error, #b3261e));--_text-field-error-hover-active-indicator-color: var(--md-filled-select-text-field-error-hover-active-indicator-color, var(--md-sys-color-on-error-container, #410e0b));--_text-field-error-hover-input-text-color: var(--md-filled-select-text-field-error-hover-input-text-color, var(--md-sys-color-on-surface, #1d1b20));--_text-field-error-hover-label-text-color: var(--md-filled-select-text-field-error-hover-label-text-color, var(--md-sys-color-on-error-container, #410e0b));--_text-field-error-hover-leading-icon-color: var(--md-filled-select-text-field-error-hover-leading-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_text-field-error-hover-state-layer-color: var(--md-filled-select-text-field-error-hover-state-layer-color, var(--md-sys-color-on-surface, #1d1b20));--_text-field-error-hover-state-layer-opacity: var(--md-filled-select-text-field-error-hover-state-layer-opacity, 0.08);--_text-field-error-hover-supporting-text-color: var(--md-filled-select-text-field-error-hover-supporting-text-color, var(--md-sys-color-error, #b3261e));--_text-field-error-hover-trailing-icon-color: var(--md-filled-select-text-field-error-hover-trailing-icon-color, var(--md-sys-color-on-error-container, #410e0b));--_text-field-error-input-text-color: var(--md-filled-select-text-field-error-input-text-color, var(--md-sys-color-on-surface, #1d1b20));--_text-field-error-label-text-color: var(--md-filled-select-text-field-error-label-text-color, var(--md-sys-color-error, #b3261e));--_text-field-error-leading-icon-color: var(--md-filled-select-text-field-error-leading-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_text-field-error-supporting-text-color: var(--md-filled-select-text-field-error-supporting-text-color, var(--md-sys-color-error, #b3261e));--_text-field-error-trailing-icon-color: var(--md-filled-select-text-field-error-trailing-icon-color, var(--md-sys-color-error, #b3261e));--_text-field-focus-active-indicator-color: var(--md-filled-select-text-field-focus-active-indicator-color, var(--md-sys-color-primary, #6750a4));--_text-field-focus-active-indicator-height: var(--md-filled-select-text-field-focus-active-indicator-height, 3px);--_text-field-focus-input-text-color: var(--md-filled-select-text-field-focus-input-text-color, var(--md-sys-color-on-surface, #1d1b20));--_text-field-focus-label-text-color: var(--md-filled-select-text-field-focus-label-text-color, var(--md-sys-color-primary, #6750a4));--_text-field-focus-leading-icon-color: var(--md-filled-select-text-field-focus-leading-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_text-field-focus-supporting-text-color: var(--md-filled-select-text-field-focus-supporting-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_text-field-focus-trailing-icon-color: var(--md-filled-select-text-field-focus-trailing-icon-color, var(--md-sys-color-primary, #6750a4));--_text-field-hover-active-indicator-color: var(--md-filled-select-text-field-hover-active-indicator-color, var(--md-sys-color-on-surface, #1d1b20));--_text-field-hover-active-indicator-height: var(--md-filled-select-text-field-hover-active-indicator-height, 1px);--_text-field-hover-input-text-color: var(--md-filled-select-text-field-hover-input-text-color, var(--md-sys-color-on-surface, #1d1b20));--_text-field-hover-label-text-color: var(--md-filled-select-text-field-hover-label-text-color, var(--md-sys-color-on-surface, #1d1b20));--_text-field-hover-leading-icon-color: var(--md-filled-select-text-field-hover-leading-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_text-field-hover-state-layer-color: var(--md-filled-select-text-field-hover-state-layer-color, var(--md-sys-color-on-surface, #1d1b20));--_text-field-hover-state-layer-opacity: var(--md-filled-select-text-field-hover-state-layer-opacity, 0.08);--_text-field-hover-supporting-text-color: var(--md-filled-select-text-field-hover-supporting-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_text-field-hover-trailing-icon-color: var(--md-filled-select-text-field-hover-trailing-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_text-field-input-text-color: var(--md-filled-select-text-field-input-text-color, var(--md-sys-color-on-surface, #1d1b20));--_text-field-input-text-font: var(--md-filled-select-text-field-input-text-font, var(--md-sys-typescale-body-large-font, var(--md-ref-typeface-plain, Roboto)));--_text-field-input-text-line-height: var(--md-filled-select-text-field-input-text-line-height, var(--md-sys-typescale-body-large-line-height, 1.5rem));--_text-field-input-text-size: var(--md-filled-select-text-field-input-text-size, var(--md-sys-typescale-body-large-size, 1rem));--_text-field-input-text-weight: var(--md-filled-select-text-field-input-text-weight, var(--md-sys-typescale-body-large-weight, var(--md-ref-typeface-weight-regular, 400)));--_text-field-label-text-color: var(--md-filled-select-text-field-label-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_text-field-label-text-font: var(--md-filled-select-text-field-label-text-font, var(--md-sys-typescale-body-large-font, var(--md-ref-typeface-plain, Roboto)));--_text-field-label-text-line-height: var(--md-filled-select-text-field-label-text-line-height, var(--md-sys-typescale-body-large-line-height, 1.5rem));--_text-field-label-text-populated-line-height: var(--md-filled-select-text-field-label-text-populated-line-height, var(--md-sys-typescale-body-small-line-height, 1rem));--_text-field-label-text-populated-size: var(--md-filled-select-text-field-label-text-populated-size, var(--md-sys-typescale-body-small-size, 0.75rem));--_text-field-label-text-size: var(--md-filled-select-text-field-label-text-size, var(--md-sys-typescale-body-large-size, 1rem));--_text-field-label-text-weight: var(--md-filled-select-text-field-label-text-weight, var(--md-sys-typescale-body-large-weight, var(--md-ref-typeface-weight-regular, 400)));--_text-field-leading-icon-color: var(--md-filled-select-text-field-leading-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_text-field-leading-icon-size: var(--md-filled-select-text-field-leading-icon-size, 24px);--_text-field-supporting-text-color: var(--md-filled-select-text-field-supporting-text-color, var(--md-sys-color-on-surface-variant, #49454f));--_text-field-supporting-text-font: var(--md-filled-select-text-field-supporting-text-font, var(--md-sys-typescale-body-small-font, var(--md-ref-typeface-plain, Roboto)));--_text-field-supporting-text-line-height: var(--md-filled-select-text-field-supporting-text-line-height, var(--md-sys-typescale-body-small-line-height, 1rem));--_text-field-supporting-text-size: var(--md-filled-select-text-field-supporting-text-size, var(--md-sys-typescale-body-small-size, 0.75rem));--_text-field-supporting-text-weight: var(--md-filled-select-text-field-supporting-text-weight, var(--md-sys-typescale-body-small-weight, var(--md-ref-typeface-weight-regular, 400)));--_text-field-trailing-icon-color: var(--md-filled-select-text-field-trailing-icon-color, var(--md-sys-color-on-surface-variant, #49454f));--_text-field-trailing-icon-size: var(--md-filled-select-text-field-trailing-icon-size, 24px);--_text-field-container-shape-start-start: var(--md-filled-select-text-field-container-shape-start-start, var(--md-filled-select-text-field-container-shape, var(--md-sys-shape-corner-extra-small, 4px)));--_text-field-container-shape-start-end: var(--md-filled-select-text-field-container-shape-start-end, var(--md-filled-select-text-field-container-shape, var(--md-sys-shape-corner-extra-small, 4px)));--_text-field-container-shape-end-end: var(--md-filled-select-text-field-container-shape-end-end, var(--md-filled-select-text-field-container-shape, var(--md-sys-shape-corner-none, 0px)));--_text-field-container-shape-end-start: var(--md-filled-select-text-field-container-shape-end-start, var(--md-filled-select-text-field-container-shape, var(--md-sys-shape-corner-none, 0px)));--md-filled-field-active-indicator-color: var(--_text-field-active-indicator-color);--md-filled-field-active-indicator-height: var(--_text-field-active-indicator-height);--md-filled-field-container-color: var(--_text-field-container-color);--md-filled-field-container-shape-end-end: var(--_text-field-container-shape-end-end);--md-filled-field-container-shape-end-start: var(--_text-field-container-shape-end-start);--md-filled-field-container-shape-start-end: var(--_text-field-container-shape-start-end);--md-filled-field-container-shape-start-start: var(--_text-field-container-shape-start-start);--md-filled-field-content-color: var(--_text-field-input-text-color);--md-filled-field-content-font: var(--_text-field-input-text-font);--md-filled-field-content-line-height: var(--_text-field-input-text-line-height);--md-filled-field-content-size: var(--_text-field-input-text-size);--md-filled-field-content-weight: var(--_text-field-input-text-weight);--md-filled-field-disabled-active-indicator-color: var(--_text-field-disabled-active-indicator-color);--md-filled-field-disabled-active-indicator-height: var(--_text-field-disabled-active-indicator-height);--md-filled-field-disabled-active-indicator-opacity: var(--_text-field-disabled-active-indicator-opacity);--md-filled-field-disabled-container-color: var(--_text-field-disabled-container-color);--md-filled-field-disabled-container-opacity: var(--_text-field-disabled-container-opacity);--md-filled-field-disabled-content-color: var(--_text-field-disabled-input-text-color);--md-filled-field-disabled-content-opacity: var(--_text-field-disabled-input-text-opacity);--md-filled-field-disabled-label-text-color: var(--_text-field-disabled-label-text-color);--md-filled-field-disabled-label-text-opacity: var(--_text-field-disabled-label-text-opacity);--md-filled-field-disabled-leading-content-color: var(--_text-field-disabled-leading-icon-color);--md-filled-field-disabled-leading-content-opacity: var(--_text-field-disabled-leading-icon-opacity);--md-filled-field-disabled-supporting-text-color: var(--_text-field-disabled-supporting-text-color);--md-filled-field-disabled-supporting-text-opacity: var(--_text-field-disabled-supporting-text-opacity);--md-filled-field-disabled-trailing-content-color: var(--_text-field-disabled-trailing-icon-color);--md-filled-field-disabled-trailing-content-opacity: var(--_text-field-disabled-trailing-icon-opacity);--md-filled-field-error-active-indicator-color: var(--_text-field-error-active-indicator-color);--md-filled-field-error-content-color: var(--_text-field-error-input-text-color);--md-filled-field-error-focus-active-indicator-color: var(--_text-field-error-focus-active-indicator-color);--md-filled-field-error-focus-content-color: var(--_text-field-error-focus-input-text-color);--md-filled-field-error-focus-label-text-color: var(--_text-field-error-focus-label-text-color);--md-filled-field-error-focus-leading-content-color: var(--_text-field-error-focus-leading-icon-color);--md-filled-field-error-focus-supporting-text-color: var(--_text-field-error-focus-supporting-text-color);--md-filled-field-error-focus-trailing-content-color: var(--_text-field-error-focus-trailing-icon-color);--md-filled-field-error-hover-active-indicator-color: var(--_text-field-error-hover-active-indicator-color);--md-filled-field-error-hover-content-color: var(--_text-field-error-hover-input-text-color);--md-filled-field-error-hover-label-text-color: var(--_text-field-error-hover-label-text-color);--md-filled-field-error-hover-leading-content-color: var(--_text-field-error-hover-leading-icon-color);--md-filled-field-error-hover-state-layer-color: var(--_text-field-error-hover-state-layer-color);--md-filled-field-error-hover-state-layer-opacity: var(--_text-field-error-hover-state-layer-opacity);--md-filled-field-error-hover-supporting-text-color: var(--_text-field-error-hover-supporting-text-color);--md-filled-field-error-hover-trailing-content-color: var(--_text-field-error-hover-trailing-icon-color);--md-filled-field-error-label-text-color: var(--_text-field-error-label-text-color);--md-filled-field-error-leading-content-color: var(--_text-field-error-leading-icon-color);--md-filled-field-error-supporting-text-color: var(--_text-field-error-supporting-text-color);--md-filled-field-error-trailing-content-color: var(--_text-field-error-trailing-icon-color);--md-filled-field-focus-active-indicator-color: var(--_text-field-focus-active-indicator-color);--md-filled-field-focus-active-indicator-height: var(--_text-field-focus-active-indicator-height);--md-filled-field-focus-content-color: var(--_text-field-focus-input-text-color);--md-filled-field-focus-label-text-color: var(--_text-field-focus-label-text-color);--md-filled-field-focus-leading-content-color: var(--_text-field-focus-leading-icon-color);--md-filled-field-focus-supporting-text-color: var(--_text-field-focus-supporting-text-color);--md-filled-field-focus-trailing-content-color: var(--_text-field-focus-trailing-icon-color);--md-filled-field-hover-active-indicator-color: var(--_text-field-hover-active-indicator-color);--md-filled-field-hover-active-indicator-height: var(--_text-field-hover-active-indicator-height);--md-filled-field-hover-content-color: var(--_text-field-hover-input-text-color);--md-filled-field-hover-label-text-color: var(--_text-field-hover-label-text-color);--md-filled-field-hover-leading-content-color: var(--_text-field-hover-leading-icon-color);--md-filled-field-hover-state-layer-color: var(--_text-field-hover-state-layer-color);--md-filled-field-hover-state-layer-opacity: var(--_text-field-hover-state-layer-opacity);--md-filled-field-hover-supporting-text-color: var(--_text-field-hover-supporting-text-color);--md-filled-field-hover-trailing-content-color: var(--_text-field-hover-trailing-icon-color);--md-filled-field-label-text-color: var(--_text-field-label-text-color);--md-filled-field-label-text-font: var(--_text-field-label-text-font);--md-filled-field-label-text-line-height: var(--_text-field-label-text-line-height);--md-filled-field-label-text-populated-line-height: var(--_text-field-label-text-populated-line-height);--md-filled-field-label-text-populated-size: var(--_text-field-label-text-populated-size);--md-filled-field-label-text-size: var(--_text-field-label-text-size);--md-filled-field-label-text-weight: var(--_text-field-label-text-weight);--md-filled-field-leading-content-color: var(--_text-field-leading-icon-color);--md-filled-field-supporting-text-color: var(--_text-field-supporting-text-color);--md-filled-field-supporting-text-font: var(--_text-field-supporting-text-font);--md-filled-field-supporting-text-line-height: var(--_text-field-supporting-text-line-height);--md-filled-field-supporting-text-size: var(--_text-field-supporting-text-size);--md-filled-field-supporting-text-weight: var(--_text-field-supporting-text-weight);--md-filled-field-trailing-content-color: var(--_text-field-trailing-icon-color)}[has-start] .icon.leading{font-size:var(--_text-field-leading-icon-size);height:var(--_text-field-leading-icon-size);width:var(--_text-field-leading-icon-size)}.icon.trailing{font-size:var(--_text-field-trailing-icon-size);height:var(--_text-field-trailing-icon-size);width:var(--_text-field-trailing-icon-size)}
`,Mt=a`:host{color:unset;min-width:210px;display:flex}.field{cursor:default;outline:none}.select{position:relative;flex-direction:column}.icon.trailing svg,.icon ::slotted(*){fill:currentColor}.icon ::slotted(*){width:inherit;height:inherit;font-size:inherit}.icon slot{display:flex;height:100%;width:100%;align-items:center;justify-content:center}.icon.trailing :is(.up,.down){opacity:0;transition:opacity 75ms linear 75ms}.select:not(.open) .down,.select.open .up{opacity:1}.field,.select,md-menu{min-width:inherit;width:inherit;max-width:inherit;display:flex}md-menu{min-width:var(--__menu-min-width);max-width:var(--__menu-max-width, inherit)}.menu-wrapper{width:0px;height:0px;max-width:inherit}md-menu ::slotted(:not[disabled]){cursor:pointer}.field,.select{width:100%}:host{display:inline-flex}:host([disabled]){pointer-events:none}
`;class Nt extends Bt{}Nt.styles=[Mt,Ut],customElements.define("ew-filled-select",Nt);const Ht=a`:host{display:flex;--md-ripple-hover-color: var(--md-menu-item-hover-state-layer-color, var(--md-sys-color-on-surface, #1d1b20));--md-ripple-hover-opacity: var(--md-menu-item-hover-state-layer-opacity, 0.08);--md-ripple-pressed-color: var(--md-menu-item-pressed-state-layer-color, var(--md-sys-color-on-surface, #1d1b20));--md-ripple-pressed-opacity: var(--md-menu-item-pressed-state-layer-opacity, 0.12)}:host([disabled]){opacity:var(--md-menu-item-disabled-opacity, 0.3);pointer-events:none}md-focus-ring{z-index:1;--md-focus-ring-shape: 8px}a,button,li{background:none;border:none;padding:0;margin:0;text-align:unset;text-decoration:none}.list-item{border-radius:inherit;display:flex;flex:1;max-width:inherit;min-width:inherit;outline:none;-webkit-tap-highlight-color:rgba(0,0,0,0)}.list-item:not(.disabled){cursor:pointer}[slot=container]{pointer-events:none}md-ripple{border-radius:inherit}md-item{border-radius:inherit;flex:1;color:var(--md-menu-item-label-text-color, var(--md-sys-color-on-surface, #1d1b20));font-family:var(--md-menu-item-label-text-font, var(--md-sys-typescale-body-large-font, var(--md-ref-typeface-plain, Roboto)));font-size:var(--md-menu-item-label-text-size, var(--md-sys-typescale-body-large-size, 1rem));line-height:var(--md-menu-item-label-text-line-height, var(--md-sys-typescale-body-large-line-height, 1.5rem));font-weight:var(--md-menu-item-label-text-weight, var(--md-sys-typescale-body-large-weight, var(--md-ref-typeface-weight-regular, 400)));min-height:var(--md-menu-item-one-line-container-height, 56px);padding-top:var(--md-menu-item-top-space, 12px);padding-bottom:var(--md-menu-item-bottom-space, 12px);padding-inline-start:var(--md-menu-item-leading-space, 16px);padding-inline-end:var(--md-menu-item-trailing-space, 16px)}md-item[multiline]{min-height:var(--md-menu-item-two-line-container-height, 72px)}[slot=supporting-text]{color:var(--md-menu-item-supporting-text-color, var(--md-sys-color-on-surface-variant, #49454f));font-family:var(--md-menu-item-supporting-text-font, var(--md-sys-typescale-body-medium-font, var(--md-ref-typeface-plain, Roboto)));font-size:var(--md-menu-item-supporting-text-size, var(--md-sys-typescale-body-medium-size, 0.875rem));line-height:var(--md-menu-item-supporting-text-line-height, var(--md-sys-typescale-body-medium-line-height, 1.25rem));font-weight:var(--md-menu-item-supporting-text-weight, var(--md-sys-typescale-body-medium-weight, var(--md-ref-typeface-weight-regular, 400)))}[slot=trailing-supporting-text]{color:var(--md-menu-item-trailing-supporting-text-color, var(--md-sys-color-on-surface-variant, #49454f));font-family:var(--md-menu-item-trailing-supporting-text-font, var(--md-sys-typescale-label-small-font, var(--md-ref-typeface-plain, Roboto)));font-size:var(--md-menu-item-trailing-supporting-text-size, var(--md-sys-typescale-label-small-size, 0.6875rem));line-height:var(--md-menu-item-trailing-supporting-text-line-height, var(--md-sys-typescale-label-small-line-height, 1rem));font-weight:var(--md-menu-item-trailing-supporting-text-weight, var(--md-sys-typescale-label-small-weight, var(--md-ref-typeface-weight-medium, 500)))}:is([slot=start],[slot=end])::slotted(*){fill:currentColor}[slot=start]{color:var(--md-menu-item-leading-icon-color, var(--md-sys-color-on-surface-variant, #49454f))}[slot=end]{color:var(--md-menu-item-trailing-icon-color, var(--md-sys-color-on-surface-variant, #49454f))}.list-item{background-color:var(--md-menu-item-container-color, transparent)}.list-item.selected{background-color:var(--md-menu-item-selected-container-color, var(--md-sys-color-secondary-container, #e8def8))}.selected:not(.disabled) ::slotted(*){color:var(--md-menu-item-selected-label-text-color, var(--md-sys-color-on-secondary-container, #1d192b))}@media(forced-colors: active){:host([disabled]),:host([disabled]) slot{color:GrayText;opacity:1}.list-item{position:relative}.list-item.selected::before{content:"";position:absolute;inset:0;box-sizing:border-box;border-radius:inherit;pointer-events:none;border:3px double CanvasText}}
`;class qt{constructor(e,t){this.host=e,this.internalTypeaheadText=null,this.onClick=()=>{this.host.keepOpen||this.host.dispatchEvent(ct(this.host,{kind:pt}))},this.onKeydown=e=>{if(this.host.href&&"Enter"===e.code){const e=this.getInteractiveElement();e instanceof HTMLAnchorElement&&e.click()}if(e.defaultPrevented)return;const t=e.code;this.host.keepOpen&&"Escape"!==t||mt(t)&&(e.preventDefault(),this.host.dispatchEvent(ct(this.host,{kind:ut,key:t})))},this.getHeadlineElements=t.getHeadlineElements,this.getSupportingTextElements=t.getSupportingTextElements,this.getDefaultElements=t.getDefaultElements,this.getInteractiveElement=t.getInteractiveElement,this.host.addController(this)}get typeaheadText(){if(null!==this.internalTypeaheadText)return this.internalTypeaheadText;const e=this.getHeadlineElements(),t=[];return e.forEach((e=>{e.textContent&&e.textContent.trim()&&t.push(e.textContent.trim())})),0===t.length&&this.getDefaultElements().forEach((e=>{e.textContent&&e.textContent.trim()&&t.push(e.textContent.trim())})),0===t.length&&this.getSupportingTextElements().forEach((e=>{e.textContent&&e.textContent.trim()&&t.push(e.textContent.trim())})),t.join(" ")}get tagName(){switch(this.host.type){case"link":return"a";case"button":return"button";default:return"li"}}get role(){return"option"===this.host.type?"option":"menuitem"}hostConnected(){this.host.toggleAttribute("md-menu-item",!0)}hostUpdate(){this.host.href&&(this.host.type="link")}setTypeaheadText(e){this.internalTypeaheadText=e}}class Wt{get role(){return this.menuItemController.role}get typeaheadText(){return this.menuItemController.typeaheadText}setTypeaheadText(e){this.menuItemController.setTypeaheadText(e)}get displayText(){return null!==this.internalDisplayText?this.internalDisplayText:this.menuItemController.typeaheadText}setDisplayText(e){this.internalDisplayText=e}constructor(e,t){this.host=e,this.internalDisplayText=null,this.firstUpdate=!0,this.onClick=()=>{this.menuItemController.onClick()},this.onKeydown=e=>{this.menuItemController.onKeydown(e)},this.lastSelected=this.host.selected,this.menuItemController=new qt(e,t),e.addController(this)}hostUpdate(){this.lastSelected!==this.host.selected&&(this.host.ariaSelected=this.host.selected?"true":"false")}hostUpdated(){this.lastSelected===this.host.selected||this.firstUpdate||(this.host.selected?this.host.dispatchEvent(new Event("request-selection",{bubbles:!0,composed:!0})):this.host.dispatchEvent(new Event("request-deselection",{bubbles:!0,composed:!0}))),this.lastSelected=this.host.selected,this.firstUpdate=!1}}const Zt=l(r);class Vt extends Zt{constructor(){super(...arguments),this.disabled=!1,this.isMenuItem=!0,this.selected=!1,this.value="",this.type="option",this.selectOptionController=new Wt(this,{getHeadlineElements:()=>this.headlineElements,getSupportingTextElements:()=>this.supportingTextElements,getDefaultElements:()=>this.defaultElements,getInteractiveElement:()=>this.listItemRoot})}get typeaheadText(){return this.selectOptionController.typeaheadText}set typeaheadText(e){this.selectOptionController.setTypeaheadText(e)}get displayText(){return this.selectOptionController.displayText}set displayText(e){this.selectOptionController.setDisplayText(e)}render(){return this.renderListItem(o`
      <md-item>
        <div slot="container">
          ${this.renderRipple()} ${this.renderFocusRing()}
        </div>
        <slot name="start" slot="start"></slot>
        <slot name="end" slot="end"></slot>
        ${this.renderBody()}
      </md-item>
    `)}renderListItem(e){return o`
      <li
        id="item"
        tabindex=${this.disabled?-1:0}
        role=${this.selectOptionController.role}
        aria-label=${this.ariaLabel||c}
        aria-selected=${this.ariaSelected||c}
        aria-checked=${this.ariaChecked||c}
        aria-expanded=${this.ariaExpanded||c}
        aria-haspopup=${this.ariaHasPopup||c}
        class="list-item ${h(this.getRenderClasses())}"
        @click=${this.selectOptionController.onClick}
        @keydown=${this.selectOptionController.onKeydown}
        >${e}</li
      >
    `}renderRipple(){return o` <md-ripple
      part="ripple"
      for="item"
      ?disabled=${this.disabled}></md-ripple>`}renderFocusRing(){return o` <md-focus-ring
      part="focus-ring"
      for="item"
      inward></md-focus-ring>`}getRenderClasses(){return{disabled:this.disabled,selected:this.selected}}renderBody(){return o`
      <slot></slot>
      <slot name="overline" slot="overline"></slot>
      <slot name="headline" slot="headline"></slot>
      <slot name="supporting-text" slot="supporting-text"></slot>
      <slot
        name="trailing-supporting-text"
        slot="trailing-supporting-text"></slot>
    `}focus(){var e;null===(e=this.listItemRoot)||void 0===e||e.focus()}}Vt.shadowRootOptions={...r.shadowRootOptions,delegatesFocus:!0},t([s({type:Boolean,reflect:!0})],Vt.prototype,"disabled",void 0),t([s({type:Boolean,attribute:"md-menu-item",reflect:!0})],Vt.prototype,"isMenuItem",void 0),t([s({type:Boolean})],Vt.prototype,"selected",void 0),t([s()],Vt.prototype,"value",void 0),t([d(".list-item")],Vt.prototype,"listItemRoot",void 0),t([i({slot:"headline"})],Vt.prototype,"headlineElements",void 0),t([i({slot:"supporting-text"})],Vt.prototype,"supportingTextElements",void 0),t([function(t){return(i,r)=>{const{slot:o}=t??{},a="slot"+(o?`[name=${o}]`:":not([name])");return e(i,r,{get(){var e;const i=null===(e=this.renderRoot)||void 0===e?void 0:e.querySelector(a);return(null==i?void 0:i.assignedNodes(t))??[]}})}}({slot:""})],Vt.prototype,"defaultElements",void 0),t([s({attribute:"typeahead-text"})],Vt.prototype,"typeaheadText",null),t([s({attribute:"display-text"})],Vt.prototype,"displayText",null);class jt extends Vt{}jt.styles=[Ht],customElements.define("ew-select-option",jt);const Gt=l(r);class Kt extends Gt{constructor(){super(...arguments),this.value=0,this.max=1,this.indeterminate=!1,this.fourColor=!1}render(){const{ariaLabel:e}=this;return o`
      <div
        class="progress ${h(this.getRenderClasses())}"
        role="progressbar"
        aria-label="${e||c}"
        aria-valuemin="0"
        aria-valuemax=${this.max}
        aria-valuenow=${this.indeterminate?c:this.value}
        >${this.renderIndicator()}</div
      >
    `}getRenderClasses(){return{indeterminate:this.indeterminate,"four-color":this.fourColor}}}t([s({type:Number})],Kt.prototype,"value",void 0),t([s({type:Number})],Kt.prototype,"max",void 0),t([s({type:Boolean})],Kt.prototype,"indeterminate",void 0),t([s({type:Boolean,attribute:"four-color"})],Kt.prototype,"fourColor",void 0);class Yt extends Kt{renderIndicator(){return this.indeterminate?this.renderIndeterminateContainer():this.renderDeterminateContainer()}renderDeterminateContainer(){const e=100*(1-this.value/this.max);return o`
      <svg viewBox="0 0 4800 4800">
        <circle class="track" pathLength="100"></circle>
        <circle
          class="active-track"
          pathLength="100"
          stroke-dashoffset=${e}></circle>
      </svg>
    `}renderIndeterminateContainer(){return o` <div class="spinner">
      <div class="left">
        <div class="circle"></div>
      </div>
      <div class="right">
        <div class="circle"></div>
      </div>
    </div>`}}const Jt=a`:host{--_active-indicator-color: var(--md-circular-progress-active-indicator-color, var(--md-sys-color-primary, #6750a4));--_active-indicator-width: var(--md-circular-progress-active-indicator-width, 10);--_four-color-active-indicator-four-color: var(--md-circular-progress-four-color-active-indicator-four-color, var(--md-sys-color-tertiary-container, #ffd8e4));--_four-color-active-indicator-one-color: var(--md-circular-progress-four-color-active-indicator-one-color, var(--md-sys-color-primary, #6750a4));--_four-color-active-indicator-three-color: var(--md-circular-progress-four-color-active-indicator-three-color, var(--md-sys-color-tertiary, #7d5260));--_four-color-active-indicator-two-color: var(--md-circular-progress-four-color-active-indicator-two-color, var(--md-sys-color-primary-container, #eaddff));--_size: var(--md-circular-progress-size, 48px);display:inline-flex;vertical-align:middle;width:var(--_size);height:var(--_size);position:relative;align-items:center;justify-content:center;contain:strict;content-visibility:auto}.progress{flex:1;align-self:stretch;margin:4px}.progress,.spinner,.left,.right,.circle,svg,.track,.active-track{position:absolute;inset:0}svg{transform:rotate(-90deg)}circle{cx:50%;cy:50%;r:calc(50%*(1 - var(--_active-indicator-width)/100));stroke-width:calc(var(--_active-indicator-width)*1%);stroke-dasharray:100;fill:rgba(0,0,0,0)}.active-track{transition:stroke-dashoffset 500ms cubic-bezier(0, 0, 0.2, 1);stroke:var(--_active-indicator-color)}.track{stroke:rgba(0,0,0,0)}.progress.indeterminate{animation:linear infinite linear-rotate;animation-duration:1568.2352941176ms}.spinner{animation:infinite both rotate-arc;animation-duration:5332ms;animation-timing-function:cubic-bezier(0.4, 0, 0.2, 1)}.left{overflow:hidden;inset:0 50% 0 0}.right{overflow:hidden;inset:0 0 0 50%}.circle{box-sizing:border-box;border-radius:50%;border:solid calc(var(--_active-indicator-width)/100*(var(--_size) - 8px));border-color:var(--_active-indicator-color) var(--_active-indicator-color) rgba(0,0,0,0) rgba(0,0,0,0);animation:expand-arc;animation-iteration-count:infinite;animation-fill-mode:both;animation-duration:1333ms,5332ms;animation-timing-function:cubic-bezier(0.4, 0, 0.2, 1)}.four-color .circle{animation-name:expand-arc,four-color}.left .circle{rotate:135deg;inset:0 -100% 0 0}.right .circle{rotate:100deg;inset:0 0 0 -100%;animation-delay:-666.5ms,0ms}@media(forced-colors: active){.active-track{stroke:CanvasText}.circle{border-color:CanvasText CanvasText Canvas Canvas}}@keyframes expand-arc{0%{transform:rotate(265deg)}50%{transform:rotate(130deg)}100%{transform:rotate(265deg)}}@keyframes rotate-arc{12.5%{transform:rotate(135deg)}25%{transform:rotate(270deg)}37.5%{transform:rotate(405deg)}50%{transform:rotate(540deg)}62.5%{transform:rotate(675deg)}75%{transform:rotate(810deg)}87.5%{transform:rotate(945deg)}100%{transform:rotate(1080deg)}}@keyframes linear-rotate{to{transform:rotate(360deg)}}@keyframes four-color{0%{border-top-color:var(--_four-color-active-indicator-one-color);border-right-color:var(--_four-color-active-indicator-one-color)}15%{border-top-color:var(--_four-color-active-indicator-one-color);border-right-color:var(--_four-color-active-indicator-one-color)}25%{border-top-color:var(--_four-color-active-indicator-two-color);border-right-color:var(--_four-color-active-indicator-two-color)}40%{border-top-color:var(--_four-color-active-indicator-two-color);border-right-color:var(--_four-color-active-indicator-two-color)}50%{border-top-color:var(--_four-color-active-indicator-three-color);border-right-color:var(--_four-color-active-indicator-three-color)}65%{border-top-color:var(--_four-color-active-indicator-three-color);border-right-color:var(--_four-color-active-indicator-three-color)}75%{border-top-color:var(--_four-color-active-indicator-four-color);border-right-color:var(--_four-color-active-indicator-four-color)}90%{border-top-color:var(--_four-color-active-indicator-four-color);border-right-color:var(--_four-color-active-indicator-four-color)}100%{border-top-color:var(--_four-color-active-indicator-one-color);border-right-color:var(--_four-color-active-indicator-one-color)}}
`;class Xt extends Yt{}Xt.styles=[Jt],customElements.define("ew-circular-progress",Xt);class Qt extends r{render(){return o`
      <div>
        <ew-circular-progress
          active
          ?indeterminate=${void 0===this.progress}
          .value=${void 0!==this.progress?this.progress/100:void 0}
        ></ew-circular-progress>
        ${void 0!==this.progress?o`<div>${this.progress}%</div>`:""}
      </div>
      ${this.label}
    `}}Qt.styles=a`
    :host {
      display: flex;
      flex-direction: column;
      text-align: center;
    }
    ew-circular-progress {
      margin-bottom: 16px;
    }
  `,t([s()],Qt.prototype,"label",void 0),t([s()],Qt.prototype,"progress",void 0),customElements.define("ewt-page-progress",Qt);class ei extends r{render(){return o`
      <div class="icon">${this.icon}</div>
      ${this.label}
    `}}ei.styles=a`
    :host {
      display: flex;
      flex-direction: column;
      text-align: center;
    }
    .icon {
      font-size: 50px;
      line-height: 80px;
      color: black;
    }
  `,t([s()],ei.prototype,"icon",void 0),t([s()],ei.prototype,"label",void 0),customElements.define("ewt-page-message",ei);const ti=T`
  <svg width="24" height="24" viewBox="0 0 24 24">
    <path
      fill="currentColor"
      d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"
    />
  </svg>
`,ii=T`
  <svg viewBox="0 0 24 24">
    <path
      fill="currentColor"
      d="M17.65,6.35C16.2,4.9 14.21,4 12,4A8,8 0 0,0 4,12A8,8 0 0,0 12,20C15.73,20 18.84,17.45 19.73,14H17.65C16.83,16.33 14.61,18 12,18A6,6 0 0,1 6,12A6,6 0 0,1 12,6C13.66,6 15.14,6.69 16.22,7.78L13,11H20V4L17.65,6.35Z"
    />
  </svg>
`,ri=T`
  <svg slot="start" viewBox="0 0 24 24">
    <path d="M5,20H19V18H5M19,9H15V3H9V9H5L12,16L19,9Z" />
  </svg>
`,oi=T`
  <svg slot="start" viewBox="0 0 24 24">
    <path d="M12,21L15.6,16.2C14.6,15.45 13.35,15 12,15C10.65,15 9.4,15.45 8.4,16.2L12,21M12,3C7.95,3 4.21,4.34 1.2,6.6L3,9C5.5,7.12 8.62,6 12,6C15.38,6 18.5,7.12 21,9L22.8,6.6C19.79,4.34 16.05,3 12,3M12,9C9.3,9 6.81,9.89 4.8,11.4L6.6,13.8C8.1,12.67 9.97,12 12,12C14.03,12 15.9,12.67 17.4,13.8L19.2,11.4C17.19,9.89 14.7,9 12,9Z" />
  </svg>
`,ai=T`
  <svg slot="start" viewBox="0 0 24 24">
    <path d="M20,19V7H4V19H20M20,3A2,2 0 0,1 22,5V19A2,2 0 0,1 20,21H4A2,2 0 0,1 2,19V5C2,3.89 2.9,3 4,3H20M13,17V15H18V17H13M9.58,13L5.57,9H8.4L11.7,12.3C12.09,12.69 12.09,13.33 11.7,13.72L8.42,17H5.59L9.58,13Z" />
  </svg>
`,si=T`
  <svg slot="start" viewBox="0 0 24 24">
  <path d="M16.36,14C16.44,13.34 16.5,12.68 16.5,12C16.5,11.32 16.44,10.66 16.36,10H19.74C19.9,10.64 20,11.31 20,12C20,12.69 19.9,13.36 19.74,14M14.59,19.56C15.19,18.45 15.65,17.25 15.97,16H18.92C17.96,17.65 16.43,18.93 14.59,19.56M14.34,14H9.66C9.56,13.34 9.5,12.68 9.5,12C9.5,11.32 9.56,10.65 9.66,10H14.34C14.43,10.65 14.5,11.32 14.5,12C14.5,12.68 14.43,13.34 14.34,14M12,19.96C11.17,18.76 10.5,17.43 10.09,16H13.91C13.5,17.43 12.83,18.76 12,19.96M8,8H5.08C6.03,6.34 7.57,5.06 9.4,4.44C8.8,5.55 8.35,6.75 8,8M5.08,16H8C8.35,17.25 8.8,18.45 9.4,19.56C7.57,18.93 6.03,17.65 5.08,16M4.26,14C4.1,13.36 4,12.69 4,12C4,11.31 4.1,10.64 4.26,10H7.64C7.56,10.66 7.5,11.32 7.5,12C7.5,12.68 7.56,13.34 7.64,14M12,4.03C12.83,5.23 13.5,6.57 13.91,8H10.09C10.5,6.57 11.17,5.23 12,4.03M18.92,8H15.97C15.65,6.75 15.19,5.55 14.59,4.44C16.43,5.07 17.96,6.34 18.92,8M12,2C6.47,2 2,6.5 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z" />
  </svg>
`,ni=T`
  <svg slot="start" viewBox="0 0 24 24">
    <path d="m12.151 1.5882c-.3262 0-.6523.1291-.8996.3867l-8.3848 8.7354c-.0619.0644-.1223.1368-.1807.2154-.0588.0789-.1151.1638-.1688.2534-.2593.4325-.4552.9749-.5232 1.4555-.0026.018-.0076.0369-.0094.0548-.0121.0987-.0184.1944-.0184.2857v8.0124a1.2731 1.2731 0 001.2731 1.2731h7.8313l-3.4484-3.593a1.7399 1.7399 0 111.0803-1.125l2.6847 2.7972v-10.248a1.7399 1.7399 0 111.5276-0v7.187l2.6702-2.782a1.7399 1.7399 0 111.0566 1.1505l-3.7269 3.8831v2.7299h8.174a1.2471 1.2471 0 001.2471-1.2471v-8.0375c0-.0912-.0059-.1868-.0184-.2855-.0603-.4935-.2636-1.0617-.5326-1.5105-.0537-.0896-.1101-.1745-.1684-.253-.0588-.079-.1191-.1513-.181-.2158l-8.3848-8.7363c-.2473-.2577-.5735-.3866-.8995-.3864" />
  </svg>
`,li=T`
  <svg slot="start" viewBox="0 0 24 24">
    <path d="M15,14C17.67,14 23,15.33 23,18V20H7V18C7,15.33 12.33,14 15,14M15,12A4,4 0 0,1 11,8A4,4 0 0,1 15,4A4,4 0 0,1 19,8A4,4 0 0,1 15,12M5,9.59L7.12,7.46L8.54,8.88L6.41,11L8.54,13.12L7.12,14.54L5,12.41L2.88,14.54L1.46,13.12L3.59,11L1.46,8.88L2.88,7.46L5,9.59Z" />
  </svg>
`,di=T`
  <svg slot="start" viewBox="0 0 24 24">
    <path d="M12,21.35L10.55,20.03C5.4,15.36 2,12.27 2,8.5C2,5.41 4.42,3 7.5,3C9.24,3 10.91,3.81 12,5.08C13.09,3.81 14.76,3 16.5,3C19.58,3 22,5.41 22,8.5C22,12.27 18.6,15.36 13.45,20.03L12,21.35Z" />
  </svg>
`,ci=["I".charCodeAt(0),"M".charCodeAt(0),"P".charCodeAt(0),"R".charCodeAt(0),"O".charCodeAt(0),"V".charCodeAt(0),1];var hi,pi;!function(e){e[e.CURRENT_STATE=1]="CURRENT_STATE",e[e.ERROR_STATE=2]="ERROR_STATE",e[e.RPC=3]="RPC",e[e.RPC_RESULT=4]="RPC_RESULT"}(hi||(hi={})),function(e){e[e.READY=2]="READY",e[e.PROVISIONING=3]="PROVISIONING",e[e.PROVISIONED=4]="PROVISIONED"}(pi||(pi={}));const ui={0:"NO_ERROR",1:"INVALID_RPC_PACKET",2:"UNKNOWN_RPC_COMMAND",3:"UNABLE_TO_CONNECT",254:"TIMEOUT",255:"UNKNOWN_ERROR"};class fi extends Error{constructor(){super("Port is not ready")}}const mi=e=>"["+e.map((e=>((e,t=2)=>{let i=e.toString(16).toUpperCase();return i.startsWith("-")?"-0x"+i.substring(1).padStart(t,"0"):"0x"+i.padStart(t,"0")})(e))).join(", ")+"]";class vi extends EventTarget{constructor(e,t){if(super(),this.port=e,this.logger=t,this.error=0,null===e.readable)throw new Error("Port is not readable");if(null===e.writable)throw new Error("Port is not writable")}async initialize(e=1e3){var t;if(this.logger.log("Initializing Improv Serial"),this._processInput(),await(t=1e3,new Promise((e=>setTimeout(e,t)))),void 0===this._reader)throw new fi;try{await new Promise((async(t,i)=>{setTimeout((()=>i(new Error("Improv Wi-Fi Serial not detected"))),e),await this.requestCurrentState(),t(void 0)})),await this.requestInfo()}catch(e){throw await this.close(),e}return this.info}async close(){this._reader&&await new Promise((e=>{this._reader.cancel(),this.addEventListener("disconnect",e,{once:!0})}))}async requestCurrentState(){let e;try{await new Promise((async(t,i)=>{this.addEventListener("state-changed",t,{once:!0});e=this._sendRPCWithResponse(2,[]),e.catch((e=>{this.removeEventListener("state-changed",t),i(e)}))}))}catch(e){throw this._rpcFeedback=void 0,new Error(`Error fetching current state: ${e}`)}if(this.state!==pi.PROVISIONED)return void(this._rpcFeedback=void 0);const t=await e;this.nextUrl=t[0]}async requestInfo(e){const t=await this._sendRPCWithResponse(3,[],e);this.info={firmware:t[0],version:t[1],name:t[3],chipFamily:t[2]}}async provision(e,t,i){const r=new TextEncoder,o=r.encode(e),a=r.encode(t),s=[o.length,...o,a.length,...a],n=await this._sendRPCWithResponse(1,s,i);this.nextUrl=n[0]}async scan(){const e=(await this._sendRPCWithMultipleResponses(4,[])).map((([e,t,i])=>({name:e,rssi:parseInt(t),secured:"YES"===i})));return e.sort(((e,t)=>e.name.toLocaleLowerCase().localeCompare(t.name.toLocaleLowerCase()))),e}_sendRPC(e,t){this.writePacketToStream(hi.RPC,[e,t.length,...t])}async _sendRPCWithResponse(e,t,i){if(this._rpcFeedback)throw new Error("Only 1 RPC command that requires feedback can be active");return await this._awaitRPCResultWithTimeout(new Promise(((i,r)=>{this._rpcFeedback={command:e,resolve:i,reject:r},this._sendRPC(e,t)})),i)}async _sendRPCWithMultipleResponses(e,t,i){if(this._rpcFeedback)throw new Error("Only 1 RPC command that requires feedback can be active");return await this._awaitRPCResultWithTimeout(new Promise(((i,r)=>{this._rpcFeedback={command:e,resolve:i,reject:r,receivedData:[]},this._sendRPC(e,t)})),i)}async _awaitRPCResultWithTimeout(e,t){return t?await new Promise(((i,r)=>{const o=setTimeout((()=>this._setError(254)),t);e.finally((()=>clearTimeout(o))),e.then(i,r)})):await e}async _processInput(){this.logger.debug("Starting read loop"),this._reader=this.port.readable.getReader();try{let e,t=[],i=0;for(;;){const{value:r,done:o}=await this._reader.read();if(o)break;if(r&&0!==r.length)for(const o of r){if(!1===e){10===o&&(e=void 0);continue}if(!0===e){t.push(o),t.length===i&&(this._handleIncomingPacket(t),e=void 0,t=[]);continue}if(10===o){t=[];continue}if(t.push(o),9!==t.length)continue;if(e="IMPROV"===String.fromCharCode(...t.slice(0,6)),!e){t=[];continue}i=9+t[8]+1}}}catch(e){this.logger.error("Error while reading serial port",e)}finally{this._reader.releaseLock(),this._reader=void 0}this.logger.debug("Finished read loop"),this.dispatchEvent(new Event("disconnect"))}_handleIncomingPacket(e){const t=e.slice(6),i=t[0],r=t[1],o=t[2],a=t.slice(3,3+o);if(this.logger.debug("PROCESS",{version:i,packetType:r,packetLength:o,data:mi(a)}),1!==i)return void this.logger.error("Received unsupported version",i);let s=t[3+o],n=0;for(let t=0;t<e.length-1;t++)n+=e[t];if(n&=255,n===s)if(r===hi.CURRENT_STATE)this.state=a[0],this.dispatchEvent(new CustomEvent("state-changed",{detail:this.state}));else if(r===hi.ERROR_STATE)this._setError(a[0]);else if(r===hi.RPC_RESULT){if(!this._rpcFeedback)return void this.logger.error("Received result while not waiting for one");const e=a[0];if(e!==this._rpcFeedback.command)return void this.logger.error(`Received result for command ${e} but expected ${this._rpcFeedback.command}`);const t=[],i=a[1];let r=2;for(;r<2+i;)t.push(String.fromCodePoint(...a.slice(r+1,r+a[r]+1))),r+=a[r]+1;"receivedData"in this._rpcFeedback?t.length>0?this._rpcFeedback.receivedData.push(t):(this._rpcFeedback.resolve(this._rpcFeedback.receivedData),this._rpcFeedback=void 0):(this._rpcFeedback.resolve(t),this._rpcFeedback=void 0)}else this.logger.error("Unable to handle packet",t);else this.logger.error(`Received invalid checksum ${s}. Expected ${n}`)}async writePacketToStream(e,t){const i=new Uint8Array([...ci,e,t.length,...t,0,0]);i[i.length-2]=255&i.reduce(((e,t)=>e+t),0),i[i.length-1]=10,this.logger.debug("Writing to stream:",mi(new Array(...i)));const r=this.port.writable.getWriter();await r.write(i);try{r.releaseLock()}catch(e){console.error("Ignoring release lock error",e)}}_setError(e){this.error=e,e>0&&this._rpcFeedback&&(this._rpcFeedback.reject(ui[e]||`UNKNOWN_ERROR (${e})`),this._rpcFeedback=void 0),this.dispatchEvent(new CustomEvent("error-changed",{detail:this.error}))}}class gi extends Error{}function bi(e){let t=e.length;for(;--t>=0;)e[t]=0}const _i=256,yi=286,wi=30,xi=15,ki=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),Ei=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),Si=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),Ai=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Ci=new Array(576);bi(Ci);const Ti=new Array(60);bi(Ti);const Ri=new Array(512);bi(Ri);const Ii=new Array(256);bi(Ii);const $i=new Array(29);bi($i);const Li=new Array(wi);function Di(e,t,i,r,o){this.static_tree=e,this.extra_bits=t,this.extra_base=i,this.elems=r,this.max_length=o,this.has_stree=e&&e.length}let Fi,Pi,Oi;function zi(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}bi(Li);const Bi=e=>e<256?Ri[e]:Ri[256+(e>>>7)],Ui=(e,t)=>{e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255},Mi=(e,t,i)=>{e.bi_valid>16-i?(e.bi_buf|=t<<e.bi_valid&65535,Ui(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=i-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=i)},Ni=(e,t,i)=>{Mi(e,i[2*t],i[2*t+1])},Hi=(e,t)=>{let i=0;do{i|=1&e,e>>>=1,i<<=1}while(--t>0);return i>>>1},qi=(e,t,i)=>{const r=new Array(16);let o,a,s=0;for(o=1;o<=xi;o++)s=s+i[o-1]<<1,r[o]=s;for(a=0;a<=t;a++){let t=e[2*a+1];0!==t&&(e[2*a]=Hi(r[t]++,t))}},Wi=e=>{let t;for(t=0;t<yi;t++)e.dyn_ltree[2*t]=0;for(t=0;t<wi;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},Zi=e=>{e.bi_valid>8?Ui(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},Vi=(e,t,i,r)=>{const o=2*t,a=2*i;return e[o]<e[a]||e[o]===e[a]&&r[t]<=r[i]},ji=(e,t,i)=>{const r=e.heap[i];let o=i<<1;for(;o<=e.heap_len&&(o<e.heap_len&&Vi(t,e.heap[o+1],e.heap[o],e.depth)&&o++,!Vi(t,r,e.heap[o],e.depth));)e.heap[i]=e.heap[o],i=o,o<<=1;e.heap[i]=r},Gi=(e,t,i)=>{let r,o,a,s,n=0;if(0!==e.sym_next)do{r=255&e.pending_buf[e.sym_buf+n++],r+=(255&e.pending_buf[e.sym_buf+n++])<<8,o=e.pending_buf[e.sym_buf+n++],0===r?Ni(e,o,t):(a=Ii[o],Ni(e,a+_i+1,t),s=ki[a],0!==s&&(o-=$i[a],Mi(e,o,s)),r--,a=Bi(r),Ni(e,a,i),s=Ei[a],0!==s&&(r-=Li[a],Mi(e,r,s)))}while(n<e.sym_next);Ni(e,256,t)},Ki=(e,t)=>{const i=t.dyn_tree,r=t.stat_desc.static_tree,o=t.stat_desc.has_stree,a=t.stat_desc.elems;let s,n,l,d=-1;for(e.heap_len=0,e.heap_max=573,s=0;s<a;s++)0!==i[2*s]?(e.heap[++e.heap_len]=d=s,e.depth[s]=0):i[2*s+1]=0;for(;e.heap_len<2;)l=e.heap[++e.heap_len]=d<2?++d:0,i[2*l]=1,e.depth[l]=0,e.opt_len--,o&&(e.static_len-=r[2*l+1]);for(t.max_code=d,s=e.heap_len>>1;s>=1;s--)ji(e,i,s);l=a;do{s=e.heap[1],e.heap[1]=e.heap[e.heap_len--],ji(e,i,1),n=e.heap[1],e.heap[--e.heap_max]=s,e.heap[--e.heap_max]=n,i[2*l]=i[2*s]+i[2*n],e.depth[l]=(e.depth[s]>=e.depth[n]?e.depth[s]:e.depth[n])+1,i[2*s+1]=i[2*n+1]=l,e.heap[1]=l++,ji(e,i,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],((e,t)=>{const i=t.dyn_tree,r=t.max_code,o=t.stat_desc.static_tree,a=t.stat_desc.has_stree,s=t.stat_desc.extra_bits,n=t.stat_desc.extra_base,l=t.stat_desc.max_length;let d,c,h,p,u,f,m=0;for(p=0;p<=xi;p++)e.bl_count[p]=0;for(i[2*e.heap[e.heap_max]+1]=0,d=e.heap_max+1;d<573;d++)c=e.heap[d],p=i[2*i[2*c+1]+1]+1,p>l&&(p=l,m++),i[2*c+1]=p,c>r||(e.bl_count[p]++,u=0,c>=n&&(u=s[c-n]),f=i[2*c],e.opt_len+=f*(p+u),a&&(e.static_len+=f*(o[2*c+1]+u)));if(0!==m){do{for(p=l-1;0===e.bl_count[p];)p--;e.bl_count[p]--,e.bl_count[p+1]+=2,e.bl_count[l]--,m-=2}while(m>0);for(p=l;0!==p;p--)for(c=e.bl_count[p];0!==c;)h=e.heap[--d],h>r||(i[2*h+1]!==p&&(e.opt_len+=(p-i[2*h+1])*i[2*h],i[2*h+1]=p),c--)}})(e,t),qi(i,d,e.bl_count)},Yi=(e,t,i)=>{let r,o,a=-1,s=t[1],n=0,l=7,d=4;for(0===s&&(l=138,d=3),t[2*(i+1)+1]=65535,r=0;r<=i;r++)o=s,s=t[2*(r+1)+1],++n<l&&o===s||(n<d?e.bl_tree[2*o]+=n:0!==o?(o!==a&&e.bl_tree[2*o]++,e.bl_tree[32]++):n<=10?e.bl_tree[34]++:e.bl_tree[36]++,n=0,a=o,0===s?(l=138,d=3):o===s?(l=6,d=3):(l=7,d=4))},Ji=(e,t,i)=>{let r,o,a=-1,s=t[1],n=0,l=7,d=4;for(0===s&&(l=138,d=3),r=0;r<=i;r++)if(o=s,s=t[2*(r+1)+1],!(++n<l&&o===s)){if(n<d)do{Ni(e,o,e.bl_tree)}while(0!=--n);else 0!==o?(o!==a&&(Ni(e,o,e.bl_tree),n--),Ni(e,16,e.bl_tree),Mi(e,n-3,2)):n<=10?(Ni(e,17,e.bl_tree),Mi(e,n-3,3)):(Ni(e,18,e.bl_tree),Mi(e,n-11,7));n=0,a=o,0===s?(l=138,d=3):o===s?(l=6,d=3):(l=7,d=4)}};let Xi=!1;const Qi=(e,t,i,r)=>{Mi(e,0+(r?1:0),3),Zi(e),Ui(e,i),Ui(e,~i),i&&e.pending_buf.set(e.window.subarray(t,t+i),e.pending),e.pending+=i};var er=e=>{Xi||((()=>{let e,t,i,r,o;const a=new Array(16);for(i=0,r=0;r<28;r++)for($i[r]=i,e=0;e<1<<ki[r];e++)Ii[i++]=r;for(Ii[i-1]=r,o=0,r=0;r<16;r++)for(Li[r]=o,e=0;e<1<<Ei[r];e++)Ri[o++]=r;for(o>>=7;r<wi;r++)for(Li[r]=o<<7,e=0;e<1<<Ei[r]-7;e++)Ri[256+o++]=r;for(t=0;t<=xi;t++)a[t]=0;for(e=0;e<=143;)Ci[2*e+1]=8,e++,a[8]++;for(;e<=255;)Ci[2*e+1]=9,e++,a[9]++;for(;e<=279;)Ci[2*e+1]=7,e++,a[7]++;for(;e<=287;)Ci[2*e+1]=8,e++,a[8]++;for(qi(Ci,287,a),e=0;e<wi;e++)Ti[2*e+1]=5,Ti[2*e]=Hi(e,5);Fi=new Di(Ci,ki,257,yi,xi),Pi=new Di(Ti,Ei,0,wi,xi),Oi=new Di(new Array(0),Si,0,19,7)})(),Xi=!0),e.l_desc=new zi(e.dyn_ltree,Fi),e.d_desc=new zi(e.dyn_dtree,Pi),e.bl_desc=new zi(e.bl_tree,Oi),e.bi_buf=0,e.bi_valid=0,Wi(e)},tr=(e,t,i,r)=>{let o,a,s=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=(e=>{let t,i=4093624447;for(t=0;t<=31;t++,i>>>=1)if(1&i&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<_i;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0})(e)),Ki(e,e.l_desc),Ki(e,e.d_desc),s=(e=>{let t;for(Yi(e,e.dyn_ltree,e.l_desc.max_code),Yi(e,e.dyn_dtree,e.d_desc.max_code),Ki(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*Ai[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t})(e),o=e.opt_len+3+7>>>3,a=e.static_len+3+7>>>3,a<=o&&(o=a)):o=a=i+5,i+4<=o&&-1!==t?Qi(e,t,i,r):4===e.strategy||a===o?(Mi(e,2+(r?1:0),3),Gi(e,Ci,Ti)):(Mi(e,4+(r?1:0),3),((e,t,i,r)=>{let o;for(Mi(e,t-257,5),Mi(e,i-1,5),Mi(e,r-4,4),o=0;o<r;o++)Mi(e,e.bl_tree[2*Ai[o]+1],3);Ji(e,e.dyn_ltree,t-1),Ji(e,e.dyn_dtree,i-1)})(e,e.l_desc.max_code+1,e.d_desc.max_code+1,s+1),Gi(e,e.dyn_ltree,e.dyn_dtree)),Wi(e),r&&Zi(e)},ir={_tr_init:er,_tr_stored_block:Qi,_tr_flush_block:tr,_tr_tally:(e,t,i)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=i,0===t?e.dyn_ltree[2*i]++:(e.matches++,t--,e.dyn_ltree[2*(Ii[i]+_i+1)]++,e.dyn_dtree[2*Bi(t)]++),e.sym_next===e.sym_end),_tr_align:e=>{Mi(e,2,3),Ni(e,256,Ci),(e=>{16===e.bi_valid?(Ui(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)})(e)}};var rr=(e,t,i,r)=>{let o=65535&e|0,a=e>>>16&65535|0,s=0;for(;0!==i;){s=i>2e3?2e3:i,i-=s;do{o=o+t[r++]|0,a=a+o|0}while(--s);o%=65521,a%=65521}return o|a<<16|0};const or=new Uint32Array((()=>{let e,t=[];for(var i=0;i<256;i++){e=i;for(var r=0;r<8;r++)e=1&e?3988292384^e>>>1:e>>>1;t[i]=e}return t})());var ar=(e,t,i,r)=>{const o=or,a=r+i;e^=-1;for(let i=r;i<a;i++)e=e>>>8^o[255&(e^t[i])];return-1^e},sr={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},nr={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:lr,_tr_stored_block:dr,_tr_flush_block:cr,_tr_tally:hr,_tr_align:pr}=ir,{Z_NO_FLUSH:ur,Z_PARTIAL_FLUSH:fr,Z_FULL_FLUSH:mr,Z_FINISH:vr,Z_BLOCK:gr,Z_OK:br,Z_STREAM_END:_r,Z_STREAM_ERROR:yr,Z_DATA_ERROR:wr,Z_BUF_ERROR:xr,Z_DEFAULT_COMPRESSION:kr,Z_FILTERED:Er,Z_HUFFMAN_ONLY:Sr,Z_RLE:Ar,Z_FIXED:Cr,Z_DEFAULT_STRATEGY:Tr,Z_UNKNOWN:Rr,Z_DEFLATED:Ir}=nr,$r=258,Lr=262,Dr=42,Fr=113,Pr=666,Or=(e,t)=>(e.msg=sr[t],t),zr=e=>2*e-(e>4?9:0),Br=e=>{let t=e.length;for(;--t>=0;)e[t]=0},Ur=e=>{let t,i,r,o=e.w_size;t=e.hash_size,r=t;do{i=e.head[--r],e.head[r]=i>=o?i-o:0}while(--t);t=o,r=t;do{i=e.prev[--r],e.prev[r]=i>=o?i-o:0}while(--t)};let Mr=(e,t,i)=>(t<<e.hash_shift^i)&e.hash_mask;const Nr=e=>{const t=e.state;let i=t.pending;i>e.avail_out&&(i=e.avail_out),0!==i&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+i),e.next_out),e.next_out+=i,t.pending_out+=i,e.total_out+=i,e.avail_out-=i,t.pending-=i,0===t.pending&&(t.pending_out=0))},Hr=(e,t)=>{cr(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,Nr(e.strm)},qr=(e,t)=>{e.pending_buf[e.pending++]=t},Wr=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t},Zr=(e,t,i,r)=>{let o=e.avail_in;return o>r&&(o=r),0===o?0:(e.avail_in-=o,t.set(e.input.subarray(e.next_in,e.next_in+o),i),1===e.state.wrap?e.adler=rr(e.adler,t,o,i):2===e.state.wrap&&(e.adler=ar(e.adler,t,o,i)),e.next_in+=o,e.total_in+=o,o)},Vr=(e,t)=>{let i,r,o=e.max_chain_length,a=e.strstart,s=e.prev_length,n=e.nice_match;const l=e.strstart>e.w_size-Lr?e.strstart-(e.w_size-Lr):0,d=e.window,c=e.w_mask,h=e.prev,p=e.strstart+$r;let u=d[a+s-1],f=d[a+s];e.prev_length>=e.good_match&&(o>>=2),n>e.lookahead&&(n=e.lookahead);do{if(i=t,d[i+s]===f&&d[i+s-1]===u&&d[i]===d[a]&&d[++i]===d[a+1]){a+=2,i++;do{}while(d[++a]===d[++i]&&d[++a]===d[++i]&&d[++a]===d[++i]&&d[++a]===d[++i]&&d[++a]===d[++i]&&d[++a]===d[++i]&&d[++a]===d[++i]&&d[++a]===d[++i]&&a<p);if(r=$r-(p-a),a=p-$r,r>s){if(e.match_start=t,s=r,r>=n)break;u=d[a+s-1],f=d[a+s]}}}while((t=h[t&c])>l&&0!=--o);return s<=e.lookahead?s:e.lookahead},jr=e=>{const t=e.w_size;let i,r,o;do{if(r=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-Lr)&&(e.window.set(e.window.subarray(t,t+t-r),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,e.insert>e.strstart&&(e.insert=e.strstart),Ur(e),r+=t),0===e.strm.avail_in)break;if(i=Zr(e.strm,e.window,e.strstart+e.lookahead,r),e.lookahead+=i,e.lookahead+e.insert>=3)for(o=e.strstart-e.insert,e.ins_h=e.window[o],e.ins_h=Mr(e,e.ins_h,e.window[o+1]);e.insert&&(e.ins_h=Mr(e,e.ins_h,e.window[o+3-1]),e.prev[o&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=o,o++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<Lr&&0!==e.strm.avail_in)},Gr=(e,t)=>{let i,r,o,a=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,s=0,n=e.strm.avail_in;do{if(i=65535,o=e.bi_valid+42>>3,e.strm.avail_out<o)break;if(o=e.strm.avail_out-o,r=e.strstart-e.block_start,i>r+e.strm.avail_in&&(i=r+e.strm.avail_in),i>o&&(i=o),i<a&&(0===i&&t!==vr||t===ur||i!==r+e.strm.avail_in))break;s=t===vr&&i===r+e.strm.avail_in?1:0,dr(e,0,0,s),e.pending_buf[e.pending-4]=i,e.pending_buf[e.pending-3]=i>>8,e.pending_buf[e.pending-2]=~i,e.pending_buf[e.pending-1]=~i>>8,Nr(e.strm),r&&(r>i&&(r=i),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+r),e.strm.next_out),e.strm.next_out+=r,e.strm.avail_out-=r,e.strm.total_out+=r,e.block_start+=r,i-=r),i&&(Zr(e.strm,e.strm.output,e.strm.next_out,i),e.strm.next_out+=i,e.strm.avail_out-=i,e.strm.total_out+=i)}while(0===s);return n-=e.strm.avail_in,n&&(n>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=n&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-n,e.strm.next_in),e.strstart),e.strstart+=n,e.insert+=n>e.w_size-e.insert?e.w_size-e.insert:n),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),s?4:t!==ur&&t!==vr&&0===e.strm.avail_in&&e.strstart===e.block_start?2:(o=e.window_size-e.strstart,e.strm.avail_in>o&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,o+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),o>e.strm.avail_in&&(o=e.strm.avail_in),o&&(Zr(e.strm,e.window,e.strstart,o),e.strstart+=o,e.insert+=o>e.w_size-e.insert?e.w_size-e.insert:o),e.high_water<e.strstart&&(e.high_water=e.strstart),o=e.bi_valid+42>>3,o=e.pending_buf_size-o>65535?65535:e.pending_buf_size-o,a=o>e.w_size?e.w_size:o,r=e.strstart-e.block_start,(r>=a||(r||t===vr)&&t!==ur&&0===e.strm.avail_in&&r<=o)&&(i=r>o?o:r,s=t===vr&&0===e.strm.avail_in&&i===r?1:0,dr(e,e.block_start,i,s),e.block_start+=i,Nr(e.strm)),s?3:1)},Kr=(e,t)=>{let i,r;for(;;){if(e.lookahead<Lr){if(jr(e),e.lookahead<Lr&&t===ur)return 1;if(0===e.lookahead)break}if(i=0,e.lookahead>=3&&(e.ins_h=Mr(e,e.ins_h,e.window[e.strstart+3-1]),i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==i&&e.strstart-i<=e.w_size-Lr&&(e.match_length=Vr(e,i)),e.match_length>=3)if(r=hr(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=Mr(e,e.ins_h,e.window[e.strstart+3-1]),i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=Mr(e,e.ins_h,e.window[e.strstart+1]);else r=hr(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(r&&(Hr(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,t===vr?(Hr(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Hr(e,!1),0===e.strm.avail_out)?1:2},Yr=(e,t)=>{let i,r,o;for(;;){if(e.lookahead<Lr){if(jr(e),e.lookahead<Lr&&t===ur)return 1;if(0===e.lookahead)break}if(i=0,e.lookahead>=3&&(e.ins_h=Mr(e,e.ins_h,e.window[e.strstart+3-1]),i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==i&&e.prev_length<e.max_lazy_match&&e.strstart-i<=e.w_size-Lr&&(e.match_length=Vr(e,i),e.match_length<=5&&(e.strategy===Er||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){o=e.strstart+e.lookahead-3,r=hr(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=o&&(e.ins_h=Mr(e,e.ins_h,e.window[e.strstart+3-1]),i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,r&&(Hr(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if(r=hr(e,0,e.window[e.strstart-1]),r&&Hr(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(r=hr(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,t===vr?(Hr(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Hr(e,!1),0===e.strm.avail_out)?1:2};function Jr(e,t,i,r,o){this.good_length=e,this.max_lazy=t,this.nice_length=i,this.max_chain=r,this.func=o}const Xr=[new Jr(0,0,0,0,Gr),new Jr(4,4,8,4,Kr),new Jr(4,5,16,8,Kr),new Jr(4,6,32,32,Kr),new Jr(4,4,16,16,Yr),new Jr(8,16,32,32,Yr),new Jr(8,16,128,128,Yr),new Jr(8,32,128,256,Yr),new Jr(32,128,258,1024,Yr),new Jr(32,258,258,4096,Yr)];function Qr(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Ir,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),Br(this.dyn_ltree),Br(this.dyn_dtree),Br(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),Br(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),Br(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const eo=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.status!==Dr&&57!==t.status&&69!==t.status&&73!==t.status&&91!==t.status&&103!==t.status&&t.status!==Fr&&t.status!==Pr?1:0},to=e=>{if(eo(e))return Or(e,yr);e.total_in=e.total_out=0,e.data_type=Rr;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=2===t.wrap?57:t.wrap?Dr:Fr,e.adler=2===t.wrap?0:1,t.last_flush=-2,lr(t),br},io=e=>{const t=to(e);var i;return t===br&&((i=e.state).window_size=2*i.w_size,Br(i.head),i.max_lazy_match=Xr[i.level].max_lazy,i.good_match=Xr[i.level].good_length,i.nice_match=Xr[i.level].nice_length,i.max_chain_length=Xr[i.level].max_chain,i.strstart=0,i.block_start=0,i.lookahead=0,i.insert=0,i.match_length=i.prev_length=2,i.match_available=0,i.ins_h=0),t},ro=(e,t,i,r,o,a)=>{if(!e)return yr;let s=1;if(t===kr&&(t=6),r<0?(s=0,r=-r):r>15&&(s=2,r-=16),o<1||o>9||i!==Ir||r<8||r>15||t<0||t>9||a<0||a>Cr||8===r&&1!==s)return Or(e,yr);8===r&&(r=9);const n=new Qr;return e.state=n,n.strm=e,n.status=Dr,n.wrap=s,n.gzhead=null,n.w_bits=r,n.w_size=1<<n.w_bits,n.w_mask=n.w_size-1,n.hash_bits=o+7,n.hash_size=1<<n.hash_bits,n.hash_mask=n.hash_size-1,n.hash_shift=~~((n.hash_bits+3-1)/3),n.window=new Uint8Array(2*n.w_size),n.head=new Uint16Array(n.hash_size),n.prev=new Uint16Array(n.w_size),n.lit_bufsize=1<<o+6,n.pending_buf_size=4*n.lit_bufsize,n.pending_buf=new Uint8Array(n.pending_buf_size),n.sym_buf=n.lit_bufsize,n.sym_end=3*(n.lit_bufsize-1),n.level=t,n.strategy=a,n.method=i,io(e)};var oo=(e,t)=>{let i=t.length;if(eo(e))return yr;const r=e.state,o=r.wrap;if(2===o||1===o&&r.status!==Dr||r.lookahead)return yr;if(1===o&&(e.adler=rr(e.adler,t,i,0)),r.wrap=0,i>=r.w_size){0===o&&(Br(r.head),r.strstart=0,r.block_start=0,r.insert=0);let e=new Uint8Array(r.w_size);e.set(t.subarray(i-r.w_size,i),0),t=e,i=r.w_size}const a=e.avail_in,s=e.next_in,n=e.input;for(e.avail_in=i,e.next_in=0,e.input=t,jr(r);r.lookahead>=3;){let e=r.strstart,t=r.lookahead-2;do{r.ins_h=Mr(r,r.ins_h,r.window[e+3-1]),r.prev[e&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=e,e++}while(--t);r.strstart=e,r.lookahead=2,jr(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=2,r.match_available=0,e.next_in=s,e.input=n,e.avail_in=a,r.wrap=o,br},ao={deflateInit:(e,t)=>ro(e,t,Ir,15,8,Tr),deflateInit2:ro,deflateReset:io,deflateResetKeep:to,deflateSetHeader:(e,t)=>eo(e)||2!==e.state.wrap?yr:(e.state.gzhead=t,br),deflate:(e,t)=>{if(eo(e)||t>gr||t<0)return e?Or(e,yr):yr;const i=e.state;if(!e.output||0!==e.avail_in&&!e.input||i.status===Pr&&t!==vr)return Or(e,0===e.avail_out?xr:yr);const r=i.last_flush;if(i.last_flush=t,0!==i.pending){if(Nr(e),0===e.avail_out)return i.last_flush=-1,br}else if(0===e.avail_in&&zr(t)<=zr(r)&&t!==vr)return Or(e,xr);if(i.status===Pr&&0!==e.avail_in)return Or(e,xr);if(i.status===Dr&&0===i.wrap&&(i.status=Fr),i.status===Dr){let t=Ir+(i.w_bits-8<<4)<<8,r=-1;if(r=i.strategy>=Sr||i.level<2?0:i.level<6?1:6===i.level?2:3,t|=r<<6,0!==i.strstart&&(t|=32),t+=31-t%31,Wr(i,t),0!==i.strstart&&(Wr(i,e.adler>>>16),Wr(i,65535&e.adler)),e.adler=1,i.status=Fr,Nr(e),0!==i.pending)return i.last_flush=-1,br}if(57===i.status)if(e.adler=0,qr(i,31),qr(i,139),qr(i,8),i.gzhead)qr(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),qr(i,255&i.gzhead.time),qr(i,i.gzhead.time>>8&255),qr(i,i.gzhead.time>>16&255),qr(i,i.gzhead.time>>24&255),qr(i,9===i.level?2:i.strategy>=Sr||i.level<2?4:0),qr(i,255&i.gzhead.os),i.gzhead.extra&&i.gzhead.extra.length&&(qr(i,255&i.gzhead.extra.length),qr(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(e.adler=ar(e.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=69;else if(qr(i,0),qr(i,0),qr(i,0),qr(i,0),qr(i,0),qr(i,9===i.level?2:i.strategy>=Sr||i.level<2?4:0),qr(i,3),i.status=Fr,Nr(e),0!==i.pending)return i.last_flush=-1,br;if(69===i.status){if(i.gzhead.extra){let t=i.pending,r=(65535&i.gzhead.extra.length)-i.gzindex;for(;i.pending+r>i.pending_buf_size;){let o=i.pending_buf_size-i.pending;if(i.pending_buf.set(i.gzhead.extra.subarray(i.gzindex,i.gzindex+o),i.pending),i.pending=i.pending_buf_size,i.gzhead.hcrc&&i.pending>t&&(e.adler=ar(e.adler,i.pending_buf,i.pending-t,t)),i.gzindex+=o,Nr(e),0!==i.pending)return i.last_flush=-1,br;t=0,r-=o}let o=new Uint8Array(i.gzhead.extra);i.pending_buf.set(o.subarray(i.gzindex,i.gzindex+r),i.pending),i.pending+=r,i.gzhead.hcrc&&i.pending>t&&(e.adler=ar(e.adler,i.pending_buf,i.pending-t,t)),i.gzindex=0}i.status=73}if(73===i.status){if(i.gzhead.name){let t,r=i.pending;do{if(i.pending===i.pending_buf_size){if(i.gzhead.hcrc&&i.pending>r&&(e.adler=ar(e.adler,i.pending_buf,i.pending-r,r)),Nr(e),0!==i.pending)return i.last_flush=-1,br;r=0}t=i.gzindex<i.gzhead.name.length?255&i.gzhead.name.charCodeAt(i.gzindex++):0,qr(i,t)}while(0!==t);i.gzhead.hcrc&&i.pending>r&&(e.adler=ar(e.adler,i.pending_buf,i.pending-r,r)),i.gzindex=0}i.status=91}if(91===i.status){if(i.gzhead.comment){let t,r=i.pending;do{if(i.pending===i.pending_buf_size){if(i.gzhead.hcrc&&i.pending>r&&(e.adler=ar(e.adler,i.pending_buf,i.pending-r,r)),Nr(e),0!==i.pending)return i.last_flush=-1,br;r=0}t=i.gzindex<i.gzhead.comment.length?255&i.gzhead.comment.charCodeAt(i.gzindex++):0,qr(i,t)}while(0!==t);i.gzhead.hcrc&&i.pending>r&&(e.adler=ar(e.adler,i.pending_buf,i.pending-r,r))}i.status=103}if(103===i.status){if(i.gzhead.hcrc){if(i.pending+2>i.pending_buf_size&&(Nr(e),0!==i.pending))return i.last_flush=-1,br;qr(i,255&e.adler),qr(i,e.adler>>8&255),e.adler=0}if(i.status=Fr,Nr(e),0!==i.pending)return i.last_flush=-1,br}if(0!==e.avail_in||0!==i.lookahead||t!==ur&&i.status!==Pr){let r=0===i.level?Gr(i,t):i.strategy===Sr?((e,t)=>{let i;for(;;){if(0===e.lookahead&&(jr(e),0===e.lookahead)){if(t===ur)return 1;break}if(e.match_length=0,i=hr(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,i&&(Hr(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===vr?(Hr(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Hr(e,!1),0===e.strm.avail_out)?1:2})(i,t):i.strategy===Ar?((e,t)=>{let i,r,o,a;const s=e.window;for(;;){if(e.lookahead<=$r){if(jr(e),e.lookahead<=$r&&t===ur)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(o=e.strstart-1,r=s[o],r===s[++o]&&r===s[++o]&&r===s[++o])){a=e.strstart+$r;do{}while(r===s[++o]&&r===s[++o]&&r===s[++o]&&r===s[++o]&&r===s[++o]&&r===s[++o]&&r===s[++o]&&r===s[++o]&&o<a);e.match_length=$r-(a-o),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(i=hr(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(i=hr(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),i&&(Hr(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===vr?(Hr(e,!0),0===e.strm.avail_out?3:4):e.sym_next&&(Hr(e,!1),0===e.strm.avail_out)?1:2})(i,t):Xr[i.level].func(i,t);if(3!==r&&4!==r||(i.status=Pr),1===r||3===r)return 0===e.avail_out&&(i.last_flush=-1),br;if(2===r&&(t===fr?pr(i):t!==gr&&(dr(i,0,0,!1),t===mr&&(Br(i.head),0===i.lookahead&&(i.strstart=0,i.block_start=0,i.insert=0))),Nr(e),0===e.avail_out))return i.last_flush=-1,br}return t!==vr?br:i.wrap<=0?_r:(2===i.wrap?(qr(i,255&e.adler),qr(i,e.adler>>8&255),qr(i,e.adler>>16&255),qr(i,e.adler>>24&255),qr(i,255&e.total_in),qr(i,e.total_in>>8&255),qr(i,e.total_in>>16&255),qr(i,e.total_in>>24&255)):(Wr(i,e.adler>>>16),Wr(i,65535&e.adler)),Nr(e),i.wrap>0&&(i.wrap=-i.wrap),0!==i.pending?br:_r)},deflateEnd:e=>{if(eo(e))return yr;const t=e.state.status;return e.state=null,t===Fr?Or(e,wr):br},deflateSetDictionary:oo,deflateInfo:"pako deflate (from Nodeca project)"};const so=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var no={assign:function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const i=t.shift();if(i){if("object"!=typeof i)throw new TypeError(i+"must be non-object");for(const t in i)so(i,t)&&(e[t]=i[t])}}return e},flattenChunks:e=>{let t=0;for(let i=0,r=e.length;i<r;i++)t+=e[i].length;const i=new Uint8Array(t);for(let t=0,r=0,o=e.length;t<o;t++){let o=e[t];i.set(o,r),r+=o.length}return i}};let lo=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){lo=!1}const co=new Uint8Array(256);for(let e=0;e<256;e++)co[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;co[254]=co[254]=1;var ho={string2buf:e=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(e);let t,i,r,o,a,s=e.length,n=0;for(o=0;o<s;o++)i=e.charCodeAt(o),55296==(64512&i)&&o+1<s&&(r=e.charCodeAt(o+1),56320==(64512&r)&&(i=65536+(i-55296<<10)+(r-56320),o++)),n+=i<128?1:i<2048?2:i<65536?3:4;for(t=new Uint8Array(n),a=0,o=0;a<n;o++)i=e.charCodeAt(o),55296==(64512&i)&&o+1<s&&(r=e.charCodeAt(o+1),56320==(64512&r)&&(i=65536+(i-55296<<10)+(r-56320),o++)),i<128?t[a++]=i:i<2048?(t[a++]=192|i>>>6,t[a++]=128|63&i):i<65536?(t[a++]=224|i>>>12,t[a++]=128|i>>>6&63,t[a++]=128|63&i):(t[a++]=240|i>>>18,t[a++]=128|i>>>12&63,t[a++]=128|i>>>6&63,t[a++]=128|63&i);return t},buf2string:(e,t)=>{const i=t||e.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(e.subarray(0,t));let r,o;const a=new Array(2*i);for(o=0,r=0;r<i;){let t=e[r++];if(t<128){a[o++]=t;continue}let s=co[t];if(s>4)a[o++]=65533,r+=s-1;else{for(t&=2===s?31:3===s?15:7;s>1&&r<i;)t=t<<6|63&e[r++],s--;s>1?a[o++]=65533:t<65536?a[o++]=t:(t-=65536,a[o++]=55296|t>>10&1023,a[o++]=56320|1023&t)}}return((e,t)=>{if(t<65534&&e.subarray&&lo)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let i="";for(let r=0;r<t;r++)i+=String.fromCharCode(e[r]);return i})(a,o)},utf8border:(e,t)=>{(t=t||e.length)>e.length&&(t=e.length);let i=t-1;for(;i>=0&&128==(192&e[i]);)i--;return i<0||0===i?t:i+co[e[i]]>t?i:t}};var po=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const uo=Object.prototype.toString,{Z_NO_FLUSH:fo,Z_SYNC_FLUSH:mo,Z_FULL_FLUSH:vo,Z_FINISH:go,Z_OK:bo,Z_STREAM_END:_o,Z_DEFAULT_COMPRESSION:yo,Z_DEFAULT_STRATEGY:wo,Z_DEFLATED:xo}=nr;function ko(e){this.options=no.assign({level:yo,method:xo,chunkSize:16384,windowBits:15,memLevel:8,strategy:wo},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new po,this.strm.avail_out=0;let i=ao.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(i!==bo)throw new Error(sr[i]);if(t.header&&ao.deflateSetHeader(this.strm,t.header),t.dictionary){let e;if(e="string"==typeof t.dictionary?ho.string2buf(t.dictionary):"[object ArrayBuffer]"===uo.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,i=ao.deflateSetDictionary(this.strm,e),i!==bo)throw new Error(sr[i]);this._dict_set=!0}}ko.prototype.push=function(e,t){const i=this.strm,r=this.options.chunkSize;let o,a;if(this.ended)return!1;for(a=t===~~t?t:!0===t?go:fo,"string"==typeof e?i.input=ho.string2buf(e):"[object ArrayBuffer]"===uo.call(e)?i.input=new Uint8Array(e):i.input=e,i.next_in=0,i.avail_in=i.input.length;;)if(0===i.avail_out&&(i.output=new Uint8Array(r),i.next_out=0,i.avail_out=r),(a===mo||a===vo)&&i.avail_out<=6)this.onData(i.output.subarray(0,i.next_out)),i.avail_out=0;else{if(o=ao.deflate(i,a),o===_o)return i.next_out>0&&this.onData(i.output.subarray(0,i.next_out)),o=ao.deflateEnd(this.strm),this.onEnd(o),this.ended=!0,o===bo;if(0!==i.avail_out){if(a>0&&i.next_out>0)this.onData(i.output.subarray(0,i.next_out)),i.avail_out=0;else if(0===i.avail_in)break}else this.onData(i.output)}return!0},ko.prototype.onData=function(e){this.chunks.push(e)},ko.prototype.onEnd=function(e){e===bo&&(this.result=no.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var Eo={deflate:function(e,t){const i=new ko(t);if(i.push(e,!0),i.err)throw i.msg||sr[i.err];return i.result}};const So=16209;var Ao=function(e,t){let i,r,o,a,s,n,l,d,c,h,p,u,f,m,v,g,b,_,y,w,x,k,E,S;const A=e.state;i=e.next_in,E=e.input,r=i+(e.avail_in-5),o=e.next_out,S=e.output,a=o-(t-e.avail_out),s=o+(e.avail_out-257),n=A.dmax,l=A.wsize,d=A.whave,c=A.wnext,h=A.window,p=A.hold,u=A.bits,f=A.lencode,m=A.distcode,v=(1<<A.lenbits)-1,g=(1<<A.distbits)-1;e:do{u<15&&(p+=E[i++]<<u,u+=8,p+=E[i++]<<u,u+=8),b=f[p&v];t:for(;;){if(_=b>>>24,p>>>=_,u-=_,_=b>>>16&255,0===_)S[o++]=65535&b;else{if(!(16&_)){if(0==(64&_)){b=f[(65535&b)+(p&(1<<_)-1)];continue t}if(32&_){A.mode=16191;break e}e.msg="invalid literal/length code",A.mode=So;break e}y=65535&b,_&=15,_&&(u<_&&(p+=E[i++]<<u,u+=8),y+=p&(1<<_)-1,p>>>=_,u-=_),u<15&&(p+=E[i++]<<u,u+=8,p+=E[i++]<<u,u+=8),b=m[p&g];i:for(;;){if(_=b>>>24,p>>>=_,u-=_,_=b>>>16&255,!(16&_)){if(0==(64&_)){b=m[(65535&b)+(p&(1<<_)-1)];continue i}e.msg="invalid distance code",A.mode=So;break e}if(w=65535&b,_&=15,u<_&&(p+=E[i++]<<u,u+=8,u<_&&(p+=E[i++]<<u,u+=8)),w+=p&(1<<_)-1,w>n){e.msg="invalid distance too far back",A.mode=So;break e}if(p>>>=_,u-=_,_=o-a,w>_){if(_=w-_,_>d&&A.sane){e.msg="invalid distance too far back",A.mode=So;break e}if(x=0,k=h,0===c){if(x+=l-_,_<y){y-=_;do{S[o++]=h[x++]}while(--_);x=o-w,k=S}}else if(c<_){if(x+=l+c-_,_-=c,_<y){y-=_;do{S[o++]=h[x++]}while(--_);if(x=0,c<y){_=c,y-=_;do{S[o++]=h[x++]}while(--_);x=o-w,k=S}}}else if(x+=c-_,_<y){y-=_;do{S[o++]=h[x++]}while(--_);x=o-w,k=S}for(;y>2;)S[o++]=k[x++],S[o++]=k[x++],S[o++]=k[x++],y-=3;y&&(S[o++]=k[x++],y>1&&(S[o++]=k[x++]))}else{x=o-w;do{S[o++]=S[x++],S[o++]=S[x++],S[o++]=S[x++],y-=3}while(y>2);y&&(S[o++]=S[x++],y>1&&(S[o++]=S[x++]))}break}}break}}while(i<r&&o<s);y=u>>3,i-=y,u-=y<<3,p&=(1<<u)-1,e.next_in=i,e.next_out=o,e.avail_in=i<r?r-i+5:5-(i-r),e.avail_out=o<s?s-o+257:257-(o-s),A.hold=p,A.bits=u};const Co=15,To=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Ro=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Io=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),$o=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var Lo=(e,t,i,r,o,a,s,n)=>{const l=n.bits;let d,c,h,p,u,f,m=0,v=0,g=0,b=0,_=0,y=0,w=0,x=0,k=0,E=0,S=null;const A=new Uint16Array(16),C=new Uint16Array(16);let T,R,I,$=null;for(m=0;m<=Co;m++)A[m]=0;for(v=0;v<r;v++)A[t[i+v]]++;for(_=l,b=Co;b>=1&&0===A[b];b--);if(_>b&&(_=b),0===b)return o[a++]=20971520,o[a++]=20971520,n.bits=1,0;for(g=1;g<b&&0===A[g];g++);for(_<g&&(_=g),x=1,m=1;m<=Co;m++)if(x<<=1,x-=A[m],x<0)return-1;if(x>0&&(0===e||1!==b))return-1;for(C[1]=0,m=1;m<Co;m++)C[m+1]=C[m]+A[m];for(v=0;v<r;v++)0!==t[i+v]&&(s[C[t[i+v]]++]=v);if(0===e?(S=$=s,f=20):1===e?(S=To,$=Ro,f=257):(S=Io,$=$o,f=0),E=0,v=0,m=g,u=a,y=_,w=0,h=-1,k=1<<_,p=k-1,1===e&&k>852||2===e&&k>592)return 1;for(;;){T=m-w,s[v]+1<f?(R=0,I=s[v]):s[v]>=f?(R=$[s[v]-f],I=S[s[v]-f]):(R=96,I=0),d=1<<m-w,c=1<<y,g=c;do{c-=d,o[u+(E>>w)+c]=T<<24|R<<16|I|0}while(0!==c);for(d=1<<m-1;E&d;)d>>=1;if(0!==d?(E&=d-1,E+=d):E=0,v++,0==--A[m]){if(m===b)break;m=t[i+s[v]]}if(m>_&&(E&p)!==h){for(0===w&&(w=_),u+=g,y=m-w,x=1<<y;y+w<b&&(x-=A[y+w],!(x<=0));)y++,x<<=1;if(k+=1<<y,1===e&&k>852||2===e&&k>592)return 1;h=E&p,o[h]=_<<24|y<<16|u-a|0}}return 0!==E&&(o[u+E]=m-w<<24|64<<16|0),n.bits=_,0};const{Z_FINISH:Do,Z_BLOCK:Fo,Z_TREES:Po,Z_OK:Oo,Z_STREAM_END:zo,Z_NEED_DICT:Bo,Z_STREAM_ERROR:Uo,Z_DATA_ERROR:Mo,Z_MEM_ERROR:No,Z_BUF_ERROR:Ho,Z_DEFLATED:qo}=nr,Wo=16180,Zo=16190,Vo=16191,jo=16192,Go=16194,Ko=16199,Yo=16200,Jo=16206,Xo=16209,Qo=e=>(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24);function ea(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const ta=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<Wo||t.mode>16211?1:0},ia=e=>{if(ta(e))return Uo;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=Wo,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,Oo},ra=e=>{if(ta(e))return Uo;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,ia(e)},oa=(e,t)=>{let i;if(ta(e))return Uo;const r=e.state;return t<0?(i=0,t=-t):(i=5+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?Uo:(null!==r.window&&r.wbits!==t&&(r.window=null),r.wrap=i,r.wbits=t,ra(e))},aa=(e,t)=>{if(!e)return Uo;const i=new ea;e.state=i,i.strm=e,i.window=null,i.mode=Wo;const r=oa(e,t);return r!==Oo&&(e.state=null),r};let sa,na,la=!0;const da=e=>{if(la){sa=new Int32Array(512),na=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(Lo(1,e.lens,0,288,sa,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;Lo(2,e.lens,0,32,na,0,e.work,{bits:5}),la=!1}e.lencode=sa,e.lenbits=9,e.distcode=na,e.distbits=5},ca=(e,t,i,r)=>{let o;const a=e.state;return null===a.window&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new Uint8Array(a.wsize)),r>=a.wsize?(a.window.set(t.subarray(i-a.wsize,i),0),a.wnext=0,a.whave=a.wsize):(o=a.wsize-a.wnext,o>r&&(o=r),a.window.set(t.subarray(i-r,i-r+o),a.wnext),(r-=o)?(a.window.set(t.subarray(i-r,i),0),a.wnext=r,a.whave=a.wsize):(a.wnext+=o,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=o))),0};var ha=(e,t)=>{let i,r,o,a,s,n,l,d,c,h,p,u,f,m,v,g,b,_,y,w,x,k,E=0;const S=new Uint8Array(4);let A,C;const T=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(ta(e)||!e.output||!e.input&&0!==e.avail_in)return Uo;i=e.state,i.mode===Vo&&(i.mode=jo),s=e.next_out,o=e.output,l=e.avail_out,a=e.next_in,r=e.input,n=e.avail_in,d=i.hold,c=i.bits,h=n,p=l,k=Oo;e:for(;;)switch(i.mode){case Wo:if(0===i.wrap){i.mode=jo;break}for(;c<16;){if(0===n)break e;n--,d+=r[a++]<<c,c+=8}if(2&i.wrap&&35615===d){0===i.wbits&&(i.wbits=15),i.check=0,S[0]=255&d,S[1]=d>>>8&255,i.check=ar(i.check,S,2,0),d=0,c=0,i.mode=16181;break}if(i.head&&(i.head.done=!1),!(1&i.wrap)||(((255&d)<<8)+(d>>8))%31){e.msg="incorrect header check",i.mode=Xo;break}if((15&d)!==qo){e.msg="unknown compression method",i.mode=Xo;break}if(d>>>=4,c-=4,x=8+(15&d),0===i.wbits&&(i.wbits=x),x>15||x>i.wbits){e.msg="invalid window size",i.mode=Xo;break}i.dmax=1<<i.wbits,i.flags=0,e.adler=i.check=1,i.mode=512&d?16189:Vo,d=0,c=0;break;case 16181:for(;c<16;){if(0===n)break e;n--,d+=r[a++]<<c,c+=8}if(i.flags=d,(255&i.flags)!==qo){e.msg="unknown compression method",i.mode=Xo;break}if(57344&i.flags){e.msg="unknown header flags set",i.mode=Xo;break}i.head&&(i.head.text=d>>8&1),512&i.flags&&4&i.wrap&&(S[0]=255&d,S[1]=d>>>8&255,i.check=ar(i.check,S,2,0)),d=0,c=0,i.mode=16182;case 16182:for(;c<32;){if(0===n)break e;n--,d+=r[a++]<<c,c+=8}i.head&&(i.head.time=d),512&i.flags&&4&i.wrap&&(S[0]=255&d,S[1]=d>>>8&255,S[2]=d>>>16&255,S[3]=d>>>24&255,i.check=ar(i.check,S,4,0)),d=0,c=0,i.mode=16183;case 16183:for(;c<16;){if(0===n)break e;n--,d+=r[a++]<<c,c+=8}i.head&&(i.head.xflags=255&d,i.head.os=d>>8),512&i.flags&&4&i.wrap&&(S[0]=255&d,S[1]=d>>>8&255,i.check=ar(i.check,S,2,0)),d=0,c=0,i.mode=16184;case 16184:if(1024&i.flags){for(;c<16;){if(0===n)break e;n--,d+=r[a++]<<c,c+=8}i.length=d,i.head&&(i.head.extra_len=d),512&i.flags&&4&i.wrap&&(S[0]=255&d,S[1]=d>>>8&255,i.check=ar(i.check,S,2,0)),d=0,c=0}else i.head&&(i.head.extra=null);i.mode=16185;case 16185:if(1024&i.flags&&(u=i.length,u>n&&(u=n),u&&(i.head&&(x=i.head.extra_len-i.length,i.head.extra||(i.head.extra=new Uint8Array(i.head.extra_len)),i.head.extra.set(r.subarray(a,a+u),x)),512&i.flags&&4&i.wrap&&(i.check=ar(i.check,r,u,a)),n-=u,a+=u,i.length-=u),i.length))break e;i.length=0,i.mode=16186;case 16186:if(2048&i.flags){if(0===n)break e;u=0;do{x=r[a+u++],i.head&&x&&i.length<65536&&(i.head.name+=String.fromCharCode(x))}while(x&&u<n);if(512&i.flags&&4&i.wrap&&(i.check=ar(i.check,r,u,a)),n-=u,a+=u,x)break e}else i.head&&(i.head.name=null);i.length=0,i.mode=16187;case 16187:if(4096&i.flags){if(0===n)break e;u=0;do{x=r[a+u++],i.head&&x&&i.length<65536&&(i.head.comment+=String.fromCharCode(x))}while(x&&u<n);if(512&i.flags&&4&i.wrap&&(i.check=ar(i.check,r,u,a)),n-=u,a+=u,x)break e}else i.head&&(i.head.comment=null);i.mode=16188;case 16188:if(512&i.flags){for(;c<16;){if(0===n)break e;n--,d+=r[a++]<<c,c+=8}if(4&i.wrap&&d!==(65535&i.check)){e.msg="header crc mismatch",i.mode=Xo;break}d=0,c=0}i.head&&(i.head.hcrc=i.flags>>9&1,i.head.done=!0),e.adler=i.check=0,i.mode=Vo;break;case 16189:for(;c<32;){if(0===n)break e;n--,d+=r[a++]<<c,c+=8}e.adler=i.check=Qo(d),d=0,c=0,i.mode=Zo;case Zo:if(0===i.havedict)return e.next_out=s,e.avail_out=l,e.next_in=a,e.avail_in=n,i.hold=d,i.bits=c,Bo;e.adler=i.check=1,i.mode=Vo;case Vo:if(t===Fo||t===Po)break e;case jo:if(i.last){d>>>=7&c,c-=7&c,i.mode=Jo;break}for(;c<3;){if(0===n)break e;n--,d+=r[a++]<<c,c+=8}switch(i.last=1&d,d>>>=1,c-=1,3&d){case 0:i.mode=16193;break;case 1:if(da(i),i.mode=Ko,t===Po){d>>>=2,c-=2;break e}break;case 2:i.mode=16196;break;case 3:e.msg="invalid block type",i.mode=Xo}d>>>=2,c-=2;break;case 16193:for(d>>>=7&c,c-=7&c;c<32;){if(0===n)break e;n--,d+=r[a++]<<c,c+=8}if((65535&d)!=(d>>>16^65535)){e.msg="invalid stored block lengths",i.mode=Xo;break}if(i.length=65535&d,d=0,c=0,i.mode=Go,t===Po)break e;case Go:i.mode=16195;case 16195:if(u=i.length,u){if(u>n&&(u=n),u>l&&(u=l),0===u)break e;o.set(r.subarray(a,a+u),s),n-=u,a+=u,l-=u,s+=u,i.length-=u;break}i.mode=Vo;break;case 16196:for(;c<14;){if(0===n)break e;n--,d+=r[a++]<<c,c+=8}if(i.nlen=257+(31&d),d>>>=5,c-=5,i.ndist=1+(31&d),d>>>=5,c-=5,i.ncode=4+(15&d),d>>>=4,c-=4,i.nlen>286||i.ndist>30){e.msg="too many length or distance symbols",i.mode=Xo;break}i.have=0,i.mode=16197;case 16197:for(;i.have<i.ncode;){for(;c<3;){if(0===n)break e;n--,d+=r[a++]<<c,c+=8}i.lens[T[i.have++]]=7&d,d>>>=3,c-=3}for(;i.have<19;)i.lens[T[i.have++]]=0;if(i.lencode=i.lendyn,i.lenbits=7,A={bits:i.lenbits},k=Lo(0,i.lens,0,19,i.lencode,0,i.work,A),i.lenbits=A.bits,k){e.msg="invalid code lengths set",i.mode=Xo;break}i.have=0,i.mode=16198;case 16198:for(;i.have<i.nlen+i.ndist;){for(;E=i.lencode[d&(1<<i.lenbits)-1],v=E>>>24,g=E>>>16&255,b=65535&E,!(v<=c);){if(0===n)break e;n--,d+=r[a++]<<c,c+=8}if(b<16)d>>>=v,c-=v,i.lens[i.have++]=b;else{if(16===b){for(C=v+2;c<C;){if(0===n)break e;n--,d+=r[a++]<<c,c+=8}if(d>>>=v,c-=v,0===i.have){e.msg="invalid bit length repeat",i.mode=Xo;break}x=i.lens[i.have-1],u=3+(3&d),d>>>=2,c-=2}else if(17===b){for(C=v+3;c<C;){if(0===n)break e;n--,d+=r[a++]<<c,c+=8}d>>>=v,c-=v,x=0,u=3+(7&d),d>>>=3,c-=3}else{for(C=v+7;c<C;){if(0===n)break e;n--,d+=r[a++]<<c,c+=8}d>>>=v,c-=v,x=0,u=11+(127&d),d>>>=7,c-=7}if(i.have+u>i.nlen+i.ndist){e.msg="invalid bit length repeat",i.mode=Xo;break}for(;u--;)i.lens[i.have++]=x}}if(i.mode===Xo)break;if(0===i.lens[256]){e.msg="invalid code -- missing end-of-block",i.mode=Xo;break}if(i.lenbits=9,A={bits:i.lenbits},k=Lo(1,i.lens,0,i.nlen,i.lencode,0,i.work,A),i.lenbits=A.bits,k){e.msg="invalid literal/lengths set",i.mode=Xo;break}if(i.distbits=6,i.distcode=i.distdyn,A={bits:i.distbits},k=Lo(2,i.lens,i.nlen,i.ndist,i.distcode,0,i.work,A),i.distbits=A.bits,k){e.msg="invalid distances set",i.mode=Xo;break}if(i.mode=Ko,t===Po)break e;case Ko:i.mode=Yo;case Yo:if(n>=6&&l>=258){e.next_out=s,e.avail_out=l,e.next_in=a,e.avail_in=n,i.hold=d,i.bits=c,Ao(e,p),s=e.next_out,o=e.output,l=e.avail_out,a=e.next_in,r=e.input,n=e.avail_in,d=i.hold,c=i.bits,i.mode===Vo&&(i.back=-1);break}for(i.back=0;E=i.lencode[d&(1<<i.lenbits)-1],v=E>>>24,g=E>>>16&255,b=65535&E,!(v<=c);){if(0===n)break e;n--,d+=r[a++]<<c,c+=8}if(g&&0==(240&g)){for(_=v,y=g,w=b;E=i.lencode[w+((d&(1<<_+y)-1)>>_)],v=E>>>24,g=E>>>16&255,b=65535&E,!(_+v<=c);){if(0===n)break e;n--,d+=r[a++]<<c,c+=8}d>>>=_,c-=_,i.back+=_}if(d>>>=v,c-=v,i.back+=v,i.length=b,0===g){i.mode=16205;break}if(32&g){i.back=-1,i.mode=Vo;break}if(64&g){e.msg="invalid literal/length code",i.mode=Xo;break}i.extra=15&g,i.mode=16201;case 16201:if(i.extra){for(C=i.extra;c<C;){if(0===n)break e;n--,d+=r[a++]<<c,c+=8}i.length+=d&(1<<i.extra)-1,d>>>=i.extra,c-=i.extra,i.back+=i.extra}i.was=i.length,i.mode=16202;case 16202:for(;E=i.distcode[d&(1<<i.distbits)-1],v=E>>>24,g=E>>>16&255,b=65535&E,!(v<=c);){if(0===n)break e;n--,d+=r[a++]<<c,c+=8}if(0==(240&g)){for(_=v,y=g,w=b;E=i.distcode[w+((d&(1<<_+y)-1)>>_)],v=E>>>24,g=E>>>16&255,b=65535&E,!(_+v<=c);){if(0===n)break e;n--,d+=r[a++]<<c,c+=8}d>>>=_,c-=_,i.back+=_}if(d>>>=v,c-=v,i.back+=v,64&g){e.msg="invalid distance code",i.mode=Xo;break}i.offset=b,i.extra=15&g,i.mode=16203;case 16203:if(i.extra){for(C=i.extra;c<C;){if(0===n)break e;n--,d+=r[a++]<<c,c+=8}i.offset+=d&(1<<i.extra)-1,d>>>=i.extra,c-=i.extra,i.back+=i.extra}if(i.offset>i.dmax){e.msg="invalid distance too far back",i.mode=Xo;break}i.mode=16204;case 16204:if(0===l)break e;if(u=p-l,i.offset>u){if(u=i.offset-u,u>i.whave&&i.sane){e.msg="invalid distance too far back",i.mode=Xo;break}u>i.wnext?(u-=i.wnext,f=i.wsize-u):f=i.wnext-u,u>i.length&&(u=i.length),m=i.window}else m=o,f=s-i.offset,u=i.length;u>l&&(u=l),l-=u,i.length-=u;do{o[s++]=m[f++]}while(--u);0===i.length&&(i.mode=Yo);break;case 16205:if(0===l)break e;o[s++]=i.length,l--,i.mode=Yo;break;case Jo:if(i.wrap){for(;c<32;){if(0===n)break e;n--,d|=r[a++]<<c,c+=8}if(p-=l,e.total_out+=p,i.total+=p,4&i.wrap&&p&&(e.adler=i.check=i.flags?ar(i.check,o,p,s-p):rr(i.check,o,p,s-p)),p=l,4&i.wrap&&(i.flags?d:Qo(d))!==i.check){e.msg="incorrect data check",i.mode=Xo;break}d=0,c=0}i.mode=16207;case 16207:if(i.wrap&&i.flags){for(;c<32;){if(0===n)break e;n--,d+=r[a++]<<c,c+=8}if(4&i.wrap&&d!==(4294967295&i.total)){e.msg="incorrect length check",i.mode=Xo;break}d=0,c=0}i.mode=16208;case 16208:k=zo;break e;case Xo:k=Mo;break e;case 16210:return No;default:return Uo}return e.next_out=s,e.avail_out=l,e.next_in=a,e.avail_in=n,i.hold=d,i.bits=c,(i.wsize||p!==e.avail_out&&i.mode<Xo&&(i.mode<Jo||t!==Do))&&ca(e,e.output,e.next_out,p-e.avail_out),h-=e.avail_in,p-=e.avail_out,e.total_in+=h,e.total_out+=p,i.total+=p,4&i.wrap&&p&&(e.adler=i.check=i.flags?ar(i.check,o,p,e.next_out-p):rr(i.check,o,p,e.next_out-p)),e.data_type=i.bits+(i.last?64:0)+(i.mode===Vo?128:0)+(i.mode===Ko||i.mode===Go?256:0),(0===h&&0===p||t===Do)&&k===Oo&&(k=Ho),k},pa={inflateReset:ra,inflateReset2:oa,inflateResetKeep:ia,inflateInit:e=>aa(e,15),inflateInit2:aa,inflate:ha,inflateEnd:e=>{if(ta(e))return Uo;let t=e.state;return t.window&&(t.window=null),e.state=null,Oo},inflateGetHeader:(e,t)=>{if(ta(e))return Uo;const i=e.state;return 0==(2&i.wrap)?Uo:(i.head=t,t.done=!1,Oo)},inflateSetDictionary:(e,t)=>{const i=t.length;let r,o,a;return ta(e)?Uo:(r=e.state,0!==r.wrap&&r.mode!==Zo?Uo:r.mode===Zo&&(o=1,o=rr(o,t,i,0),o!==r.check)?Mo:(a=ca(e,t,i,i),a?(r.mode=16210,No):(r.havedict=1,Oo)))},inflateInfo:"pako inflate (from Nodeca project)"};var ua=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const fa=Object.prototype.toString,{Z_NO_FLUSH:ma,Z_FINISH:va,Z_OK:ga,Z_STREAM_END:ba,Z_NEED_DICT:_a,Z_STREAM_ERROR:ya,Z_DATA_ERROR:wa,Z_MEM_ERROR:xa}=nr;function ka(e){this.options=no.assign({chunkSize:65536,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new po,this.strm.avail_out=0;let i=pa.inflateInit2(this.strm,t.windowBits);if(i!==ga)throw new Error(sr[i]);if(this.header=new ua,pa.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=ho.string2buf(t.dictionary):"[object ArrayBuffer]"===fa.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(i=pa.inflateSetDictionary(this.strm,t.dictionary),i!==ga)))throw new Error(sr[i])}ka.prototype.push=function(e,t){const i=this.strm,r=this.options.chunkSize,o=this.options.dictionary;let a,s,n;if(this.ended)return!1;for(s=t===~~t?t:!0===t?va:ma,"[object ArrayBuffer]"===fa.call(e)?i.input=new Uint8Array(e):i.input=e,i.next_in=0,i.avail_in=i.input.length;;){for(0===i.avail_out&&(i.output=new Uint8Array(r),i.next_out=0,i.avail_out=r),a=pa.inflate(i,s),a===_a&&o&&(a=pa.inflateSetDictionary(i,o),a===ga?a=pa.inflate(i,s):a===wa&&(a=_a));i.avail_in>0&&a===ba&&i.state.wrap>0&&0!==e[i.next_in];)pa.inflateReset(i),a=pa.inflate(i,s);switch(a){case ya:case wa:case _a:case xa:return this.onEnd(a),this.ended=!0,!1}if(n=i.avail_out,i.next_out&&(0===i.avail_out||a===ba))if("string"===this.options.to){let e=ho.utf8border(i.output,i.next_out),t=i.next_out-e,o=ho.buf2string(i.output,e);i.next_out=t,i.avail_out=r-t,t&&i.output.set(i.output.subarray(e,e+t),0),this.onData(o)}else this.onData(i.output.length===i.next_out?i.output:i.output.subarray(0,i.next_out));if(a!==ga||0!==n){if(a===ba)return a=pa.inflateEnd(this.strm),this.onEnd(a),this.ended=!0,!0;if(0===i.avail_in)break}}return!0},ka.prototype.onData=function(e){this.chunks.push(e)},ka.prototype.onEnd=function(e){e===ga&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=no.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var Ea={Inflate:ka};const{deflate:Sa}=Eo,{Inflate:Aa}=Ea;var Ca,Ta,Ra=Sa,Ia=Aa;class $a{constructor(e,t=!1,i=!0){this.device=e,this.tracing=t,this.slipReaderEnabled=!1,this.baudrate=0,this.traceLog="",this.lastTraceTime=Date.now(),this.buffer=new Uint8Array(0),this.SLIP_END=192,this.SLIP_ESC=219,this.SLIP_ESC_END=220,this.SLIP_ESC_ESC=221,this._DTR_state=!1,this.slipReaderEnabled=i}getInfo(){const e=this.device.getInfo();return e.usbVendorId&&e.usbProductId?`WebSerial VendorID 0x${e.usbVendorId.toString(16)} ProductID 0x${e.usbProductId.toString(16)}`:""}getPid(){return this.device.getInfo().usbProductId}trace(e){const t=`${`TRACE ${(Date.now()-this.lastTraceTime).toFixed(3)}`} ${e}`;console.log(t),this.traceLog+=t+"\n"}async returnTrace(){try{await navigator.clipboard.writeText(this.traceLog),console.log("Text copied to clipboard!")}catch(e){console.error("Failed to copy text:",e)}}hexify(e){return Array.from(e).map((e=>e.toString(16).padStart(2,"0"))).join("").padEnd(16," ")}hexConvert(e,t=!0){if(t&&e.length>16){let t="",i=e;for(;i.length>0;){const e=i.slice(0,16),r=String.fromCharCode(...e).split("").map((e=>" "===e||e>=" "&&e<="~"&&"  "!==e?e:".")).join("");i=i.slice(16),t+=`\n    ${this.hexify(e.slice(0,8))} ${this.hexify(e.slice(8))} | ${r}`}return t}return this.hexify(e)}slipWriter(e){const t=[];t.push(192);for(let i=0;i<e.length;i++)219===e[i]?t.push(219,221):192===e[i]?t.push(219,220):t.push(e[i]);return t.push(192),new Uint8Array(t)}async write(e){const t=this.slipWriter(e);if(this.device.writable){const e=this.device.writable.getWriter();this.tracing&&(console.log("Write bytes"),this.trace(`Write ${t.length} bytes: ${this.hexConvert(t)}`)),await e.write(t),e.releaseLock()}}appendArray(e,t){const i=new Uint8Array(e.length+t.length);return i.set(e),i.set(t,e.length),i}async*readLoop(e){if(this.reader)try{for(;;){const t=new Promise(((t,i)=>setTimeout((()=>i(new Error("Read timeout exceeded"))),e))),i=await Promise.race([this.reader.read(),t]);if(null===i)break;const{value:r,done:o}=i;if(o||!r)break;yield r}}catch(e){console.error("Error reading from serial port:",e)}finally{this.buffer=new Uint8Array(0)}}async newRead(e,t){if(this.buffer.length>=e){const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}for(;this.buffer.length<e;){const e=this.readLoop(t),{value:i,done:r}=await e.next();if(r||!i)break;this.buffer=this.appendArray(this.buffer,i)}const i=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),i}async flushInput(){var e;this.reader&&!await this.reader.closed&&(await this.reader.cancel(),this.reader.releaseLock(),this.reader=null===(e=this.device.readable)||void 0===e?void 0:e.getReader())}async flushOutput(){var e,t;this.buffer=new Uint8Array(0),await(null===(e=this.device.writable)||void 0===e?void 0:e.getWriter().close()),null===(t=this.device.writable)||void 0===t||t.getWriter().releaseLock()}inWaiting(){return this.buffer.length}detectPanicHandler(e){const t=new TextDecoder("utf-8").decode(e),i=t.match(/G?uru Meditation Error: (?:Core \d panic'ed \(([a-zA-Z ]*)\))?/)||t.match(/F?atal exception \(\d+\): (?:([a-zA-Z ]*)?.*epc)?/);if(i){const e=i[1]||i[2];throw new Error("Guru Meditation Error detected"+(e?` (${e})`:""))}}async*read(e){var t;this.reader||(this.reader=null===(t=this.device.readable)||void 0===t?void 0:t.getReader());let i=null,r=!1,o=!1;for(;;){const t=this.inWaiting(),a=await this.newRead(t>0?t:1,e);if(!a||0===a.length){const e=null===i?o?"Serial data stream stopped: Possible serial noise or corruption.":"No serial data received.":"Packet content transfer stopped";throw this.trace(e),new Error(e)}this.trace(`Read ${a.length} bytes: ${this.hexConvert(a)}`);let s=0;for(;s<a.length;){const t=a[s++];if(null===i){if(t!==this.SLIP_END){this.trace(`Read invalid data: ${this.hexConvert(a)}`);const i=await this.newRead(this.inWaiting(),e);throw this.trace(`Remaining data in serial buffer: ${this.hexConvert(i)}`),this.detectPanicHandler(new Uint8Array([...a,...i||[]])),new Error(`Invalid head of packet (0x${t.toString(16)}): Possible serial noise or corruption.`)}i=new Uint8Array(0)}else if(r)if(r=!1,t===this.SLIP_ESC_END)i=this.appendArray(i,new Uint8Array([this.SLIP_END]));else{if(t!==this.SLIP_ESC_ESC){this.trace(`Read invalid data: ${this.hexConvert(a)}`);const i=await this.newRead(this.inWaiting(),e);throw this.trace(`Remaining data in serial buffer: ${this.hexConvert(i)}`),this.detectPanicHandler(new Uint8Array([...a,...i||[]])),new Error(`Invalid SLIP escape (0xdb, 0x${t.toString(16)})`)}i=this.appendArray(i,new Uint8Array([this.SLIP_ESC]))}else t===this.SLIP_ESC?r=!0:t===this.SLIP_END?(this.trace(`Received full packet: ${this.hexConvert(i)}`),this.buffer=this.appendArray(this.buffer,a.slice(s)),yield i,i=null,o=!0):i=this.appendArray(i,new Uint8Array([t]))}}}async*rawRead(){if(this.reader)try{for(;;){const{value:e,done:t}=await this.reader.read();if(t||!e)break;this.tracing&&(console.log("Raw Read bytes"),this.trace(`Read ${e.length} bytes: ${this.hexConvert(e)}`)),yield e}}catch(e){console.error("Error reading from serial port:",e)}finally{this.buffer=new Uint8Array(0)}}async setRTS(e){await this.device.setSignals({requestToSend:e}),await this.setDTR(this._DTR_state)}async setDTR(e){this._DTR_state=e,await this.device.setSignals({dataTerminalReady:e})}async connect(e=115200,t={}){var i;await this.device.open({baudRate:e,dataBits:null==t?void 0:t.dataBits,stopBits:null==t?void 0:t.stopBits,bufferSize:null==t?void 0:t.bufferSize,parity:null==t?void 0:t.parity,flowControl:null==t?void 0:t.flowControl}),this.baudrate=e,this.reader=null===(i=this.device.readable)||void 0===i?void 0:i.getReader()}async sleep(e){return new Promise((t=>setTimeout(t,e)))}async waitForUnlock(e){for(;this.device.readable&&this.device.readable.locked||this.device.writable&&this.device.writable.locked;)await this.sleep(e)}async disconnect(){var e,t;(null===(e=this.device.readable)||void 0===e?void 0:e.locked)&&await(null===(t=this.reader)||void 0===t?void 0:t.cancel()),await this.waitForUnlock(400),await this.device.close(),this.reader=void 0}}function La(e){return new Promise((t=>setTimeout(t,e)))}class Da{constructor(e,t){this.resetDelay=t,this.transport=e}async reset(){await this.transport.setDTR(!1),await this.transport.setRTS(!0),await La(100),await this.transport.setDTR(!0),await this.transport.setRTS(!1),await La(this.resetDelay),await this.transport.setDTR(!1)}}class Fa{constructor(e){this.transport=e}async reset(){await this.transport.setRTS(!1),await this.transport.setDTR(!1),await La(100),await this.transport.setDTR(!0),await this.transport.setRTS(!1),await La(100),await this.transport.setRTS(!0),await this.transport.setDTR(!1),await this.transport.setRTS(!0),await La(100),await this.transport.setRTS(!1),await this.transport.setDTR(!1)}}class Pa{constructor(e,t=!1){this.transport=e,this.usingUsbOtg=t,this.transport=e}async reset(){this.usingUsbOtg?(await La(200),await this.transport.setRTS(!1),await La(200)):(await La(100),await this.transport.setRTS(!1))}}class Oa{constructor(e,t){this.transport=e,this.sequenceString=t,this.transport=e}async reset(){const e={D:async e=>await this.transport.setDTR(e),R:async e=>await this.transport.setRTS(e),W:async e=>await La(e)};try{if(!function(e){const t=["D","R","W"],i=e.split("|");for(const e of i){const i=e[0],r=e.slice(1);if(!t.includes(i))return!1;if("D"===i||"R"===i){if("0"!==r&&"1"!==r)return!1}else if("W"===i){const e=parseInt(r);if(isNaN(e)||e<=0)return!1}}return!0}(this.sequenceString))return;const t=this.sequenceString.split("|");for(const i of t){const t=i[0],r=i.slice(1);"W"===t?await e.W(Number(r)):"D"!==t&&"R"!==t||await e[t]("1"===r)}}catch(e){throw new Error("Invalid custom reset sequence")}}}function za(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Ba=za(Ta?Ca:(Ta=1,Ca=function(e){return atob(e)}));async function Ua(e){let t;switch(e){case"ESP32":t=await import("./stub_flasher_32-BLbsWvxO.js");break;case"ESP32-C2":t=await import("./stub_flasher_32c2-wLQhZItC.js");break;case"ESP32-C3":t=await import("./stub_flasher_32c3-DmSvHQKL.js");break;case"ESP32-C5":t=await import("./stub_flasher_32c5-qLfkKOM9.js");break;case"ESP32-C6":t=await import("./stub_flasher_32c6-ZuxjUVr4.js");break;case"ESP32-C61":t=await import("./stub_flasher_32c61-DeKkw9vN.js");break;case"ESP32-H2":t=await import("./stub_flasher_32h2-CZ4EIL3w.js");break;case"ESP32-P4":t=await import("./stub_flasher_32p4-BvuBbdjO.js");break;case"ESP32-S2":t=await import("./stub_flasher_32s2-CrsP1231.js");break;case"ESP32-S3":t=await import("./stub_flasher_32s3-CiJyd6Fk.js");break;case"ESP8266":t=await import("./stub_flasher_8266-CQFcqJ_a.js")}if(t)return{bss_start:t.bss_start,data:t.data,data_start:t.data_start,entry:t.entry,text:t.text,text_start:t.text_start,decodedData:Ma(t.data),decodedText:Ma(t.text)}}function Ma(e){const t=Ba(e).split("").map((function(e){return e.charCodeAt(0)}));return new Uint8Array(t)}function Na(e,t,i=255){const r=e.length%t;if(0!==r){const o=new Uint8Array(t-r).fill(i),a=new Uint8Array(e.length+o.length);return a.set(e),a.set(o,e.length),a}return e}class Ha{constructor(e){var t,i,r,o,a,s,n,l;this.ESP_RAM_BLOCK=6144,this.ESP_FLASH_BEGIN=2,this.ESP_FLASH_DATA=3,this.ESP_FLASH_END=4,this.ESP_MEM_BEGIN=5,this.ESP_MEM_END=6,this.ESP_MEM_DATA=7,this.ESP_WRITE_REG=9,this.ESP_READ_REG=10,this.ESP_SPI_ATTACH=13,this.ESP_CHANGE_BAUDRATE=15,this.ESP_FLASH_DEFL_BEGIN=16,this.ESP_FLASH_DEFL_DATA=17,this.ESP_FLASH_DEFL_END=18,this.ESP_SPI_FLASH_MD5=19,this.ESP_ERASE_FLASH=208,this.ESP_ERASE_REGION=209,this.ESP_READ_FLASH=210,this.ESP_RUN_USER_CODE=211,this.ESP_IMAGE_MAGIC=233,this.ESP_CHECKSUM_MAGIC=239,this.ROM_INVALID_RECV_MSG=5,this.DEFAULT_TIMEOUT=3e3,this.ERASE_REGION_TIMEOUT_PER_MB=3e4,this.ERASE_WRITE_TIMEOUT_PER_MB=4e4,this.MD5_TIMEOUT_PER_MB=8e3,this.CHIP_ERASE_TIMEOUT=12e4,this.FLASH_READ_TIMEOUT=1e5,this.MAX_TIMEOUT=2*this.CHIP_ERASE_TIMEOUT,this.CHIP_DETECT_MAGIC_REG_ADDR=1073745920,this.DETECTED_FLASH_SIZES={18:"256KB",19:"512KB",20:"1MB",21:"2MB",22:"4MB",23:"8MB",24:"16MB"},this.DETECTED_FLASH_SIZES_NUM={18:256,19:512,20:1024,21:2048,22:4096,23:8192,24:16384},this.USB_JTAG_SERIAL_PID=4097,this.romBaudrate=115200,this.debugLogging=!1,this.syncStubDetected=!1,this.flashSizeBytes=function(e){let t=-1;return-1!==e.indexOf("KB")?t=1024*parseInt(e.slice(0,e.indexOf("KB"))):-1!==e.indexOf("MB")&&(t=1024*parseInt(e.slice(0,e.indexOf("MB")))*1024),t},this.IS_STUB=!1,this.FLASH_WRITE_SIZE=16384,this.transport=e.transport,this.baudrate=e.baudrate,this.resetConstructors={classicReset:(e,t)=>new Da(e,t),customReset:(e,t)=>new Oa(e,t),hardReset:(e,t)=>new Pa(e,t),usbJTAGSerialReset:e=>new Fa(e)},e.serialOptions&&(this.serialOptions=e.serialOptions),e.romBaudrate&&(this.romBaudrate=e.romBaudrate),e.terminal&&(this.terminal=e.terminal,this.terminal.clean()),void 0!==e.debugLogging&&(this.debugLogging=e.debugLogging),e.port&&(this.transport=new $a(e.port)),void 0!==e.enableTracing&&(this.transport.tracing=e.enableTracing),(null===(t=e.resetConstructors)||void 0===t?void 0:t.classicReset)&&(this.resetConstructors.classicReset=null===(i=e.resetConstructors)||void 0===i?void 0:i.classicReset),(null===(r=e.resetConstructors)||void 0===r?void 0:r.customReset)&&(this.resetConstructors.customReset=null===(o=e.resetConstructors)||void 0===o?void 0:o.customReset),(null===(a=e.resetConstructors)||void 0===a?void 0:a.hardReset)&&(this.resetConstructors.hardReset=null===(s=e.resetConstructors)||void 0===s?void 0:s.hardReset),(null===(n=e.resetConstructors)||void 0===n?void 0:n.usbJTAGSerialReset)&&(this.resetConstructors.usbJTAGSerialReset=null===(l=e.resetConstructors)||void 0===l?void 0:l.usbJTAGSerialReset),this.info("esptool.js"),this.info("Serial port "+this.transport.getInfo())}_sleep(e){return new Promise((t=>setTimeout(t,e)))}write(e,t=!0){this.terminal?t?this.terminal.writeLine(e):this.terminal.write(e):console.log(e)}error(e,t=!0){this.write(`Error: ${e}`,t)}info(e,t=!0){this.write(e,t)}debug(e,t=!0){this.debugLogging&&this.write(`Debug: ${e}`,t)}_shortToBytearray(e){return new Uint8Array([255&e,e>>8&255])}_intToByteArray(e){return new Uint8Array([255&e,e>>8&255,e>>16&255,e>>24&255])}_byteArrayToShort(e,t){return e|t>>8}_byteArrayToInt(e,t,i,r){return e|t<<8|i<<16|r<<24}_appendBuffer(e,t){const i=new Uint8Array(e.byteLength+t.byteLength);return i.set(new Uint8Array(e),0),i.set(new Uint8Array(t),e.byteLength),i.buffer}_appendArray(e,t){const i=new Uint8Array(e.length+t.length);return i.set(e,0),i.set(t,e.length),i}ui8ToBstr(e){let t="";for(let i=0;i<e.length;i++)t+=String.fromCharCode(e[i]);return t}bstrToUi8(e){const t=new Uint8Array(e.length);for(let i=0;i<e.length;i++)t[i]=e.charCodeAt(i);return t}async flushInput(){try{await this.transport.flushInput()}catch(e){this.error(e.message)}}async readPacket(e=null,t=this.DEFAULT_TIMEOUT){for(let i=0;i<100;i++){const{value:i}=await this.transport.read(t).next();if(!i||i.length<8)continue;const r=i[0];if(1!==r)continue;const o=i[1],a=this._byteArrayToInt(i[4],i[5],i[6],i[7]),s=i.slice(8);if(1==r){if(null==e||o==e)return[a,s];if(0!=s[0]&&s[1]==this.ROM_INVALID_RECV_MSG)throw await this.flushInput(),new gi("unsupported command error")}}throw new gi("invalid response")}async command(e=null,t=new Uint8Array(0),i=0,r=!0,o=this.DEFAULT_TIMEOUT){if(null!=e){this.transport.tracing&&this.transport.trace(`command op:0x${e.toString(16).padStart(2,"0")} data len=${t.length} wait_response=${r?1:0} timeout=${(o/1e3).toFixed(3)} data=${this.transport.hexConvert(t)}`);const a=new Uint8Array(8+t.length);let s;for(a[0]=0,a[1]=e,a[2]=this._shortToBytearray(t.length)[0],a[3]=this._shortToBytearray(t.length)[1],a[4]=this._intToByteArray(i)[0],a[5]=this._intToByteArray(i)[1],a[6]=this._intToByteArray(i)[2],a[7]=this._intToByteArray(i)[3],s=0;s<t.length;s++)a[8+s]=t[s];await this.transport.write(a)}return r?this.readPacket(e,o):[0,new Uint8Array(0)]}async readReg(e,t=this.DEFAULT_TIMEOUT){const i=this._intToByteArray(e);return(await this.command(this.ESP_READ_REG,i,void 0,void 0,t))[0]}async writeReg(e,t,i=4294967295,r=0,o=0){let a=this._appendArray(this._intToByteArray(e),this._intToByteArray(t));a=this._appendArray(a,this._intToByteArray(i)),a=this._appendArray(a,this._intToByteArray(r)),o>0&&(a=this._appendArray(a,this._intToByteArray(this.chip.UART_DATE_REG_ADDR)),a=this._appendArray(a,this._intToByteArray(0)),a=this._appendArray(a,this._intToByteArray(0)),a=this._appendArray(a,this._intToByteArray(o))),await this.checkCommand("write target memory",this.ESP_WRITE_REG,a)}async sync(){this.debug("Sync");const e=new Uint8Array(36);let t;for(e[0]=7,e[1]=7,e[2]=18,e[3]=32,t=0;t<32;t++)e[4+t]=85;try{let t=await this.command(8,e,void 0,void 0,100);this.syncStubDetected=0===t[0];for(let e=0;e<7;e++)t=await this.command(),this.syncStubDetected=this.syncStubDetected&&0===t[0];return t}catch(e){throw this.debug("Sync err "+e),e}}async _connectAttempt(e="default_reset",t){this.debug("_connect_attempt "+e),t&&await t.reset();const i=this.transport.inWaiting(),r=await this.transport.newRead(i>0?i:1,this.DEFAULT_TIMEOUT),o=Array.from(r,(e=>String.fromCharCode(e))).join("").match(/boot:(0x[0-9a-fA-F]+)(.*waiting for download)?/);let a=!1,s="",n=!1;o&&(a=!0,s=o[1],n=!!o[2]);let l="";for(let e=0;e<5;e++)try{this.debug(`Sync connect attempt ${e}`);const t=await this.sync();return this.debug(t[0].toString()),"success"}catch(e){this.debug(`Error at sync ${e}`),l=e instanceof Error?e.message:"string"==typeof e?e:JSON.stringify(e)}return a&&(l=`Wrong boot mode detected (${s}).\n        This chip needs to be in download mode.`,n&&(l="Download mode successfully detected, but getting no sync reply:\n           The serial TX path seems to be down.")),l}constructResetSequence(e){if("no_reset"!==e)if("usb_reset"===e||this.transport.getPid()===this.USB_JTAG_SERIAL_PID){if(this.resetConstructors.usbJTAGSerialReset)return this.debug("using USB JTAG Serial Reset"),[this.resetConstructors.usbJTAGSerialReset(this.transport)]}else{const e=50,t=e+500;if(this.resetConstructors.classicReset)return this.debug("using Classic Serial Reset"),[this.resetConstructors.classicReset(this.transport,e),this.resetConstructors.classicReset(this.transport,t)]}return[]}async connect(e="default_reset",t=7,i=!0){let r;this.info("Connecting...",!1),await this.transport.connect(this.romBaudrate,this.serialOptions);const o=this.constructResetSequence(e);for(let i=0;i<t;i++){const t=o.length>0?o[i%o.length]:null;if(r=await this._connectAttempt(e,t),"success"===r)break}if("success"!==r)throw new gi("Failed to connect with the device");if(this.debug("Connect attempt successful."),this.info("\n\r",!1),i){const e=await this.readReg(this.CHIP_DETECT_MAGIC_REG_ADDR)>>>0;this.debug("Chip Magic "+e.toString(16));const t=await async function(e){switch(e){case 15736195:{const{ESP32ROM:e}=await import("./esp32-DlivVhIs.js");return new e}case 203546735:case 1867591791:case 2084675695:{const{ESP32C2ROM:e}=await import("./esp32c2-CzvrfIFN.js");return new e}case 1763790959:case 456216687:case 1216438383:case 1130455151:{const{ESP32C3ROM:e}=await import("./esp32c3-f8fwIr7_.js");return new e}case 752910447:{const{ESP32C6ROM:e}=await import("./esp32c6-CEDebHbz.js");return new e}case 606167151:case 871374959:case 1333878895:{const{ESP32C61ROM:e}=await import("./esp32c61-BCSbE5wE.js");return new e}case 285294703:case 1675706479:case 1607549039:{const{ESP32C5ROM:e}=await import("./esp32c5-D10lI8kj.js");return new e}case 3619110528:case 2548236392:{const{ESP32H2ROM:e}=await import("./esp32h2-CakTbIIf.js");return new e}case 9:{const{ESP32S3ROM:e}=await import("./esp32s3-vxLttl29.js");return new e}case 1990:{const{ESP32S2ROM:e}=await import("./esp32s2-Bl3uMkxu.js");return new e}case 4293968129:{const{ESP8266ROM:e}=await import("./esp8266-Dk4lBEaC.js");return new e}case 0:case 182303440:case 117676761:{const{ESP32P4ROM:e}=await import("./esp32p4-DD6i9EGh.js");return new e}default:return null}}(e);if(null===this.chip)throw new gi(`Unexpected CHIP magic value ${e}. Failed to autodetect chip type.`);this.chip=t}}async detectChip(e="default_reset"){await this.connect(e),this.info("Detecting chip type... ",!1),null!=this.chip?this.info(this.chip.CHIP_NAME):this.info("unknown!")}async checkCommand(e="",t=null,i=new Uint8Array(0),r=0,o=this.DEFAULT_TIMEOUT){this.debug("check_command "+e);const a=await this.command(t,i,r,void 0,o);return a[1].length>4?a[1]:a[0]}async memBegin(e,t,i,r){if(this.IS_STUB){const t=r,i=r+e,o=await Ua(this.chip.CHIP_NAME);if(o){const e=[[o.bss_start||o.data_start,o.data_start+o.decodedData.length],[o.text_start,o.text_start+o.decodedText.length]];for(const[r,o]of e)if(t<o&&i>r)throw new gi(`Software loader is resident at 0x${r.toString(16).padStart(8,"0")}-0x${o.toString(16).padStart(8,"0")}.\n            Can't load binary at overlapping address range 0x${t.toString(16).padStart(8,"0")}-0x${i.toString(16).padStart(8,"0")}.\n            Either change binary loading address, or use the no-stub option to disable the software loader.`)}}this.debug("mem_begin "+e+" "+t+" "+i+" "+r.toString(16));let o=this._appendArray(this._intToByteArray(e),this._intToByteArray(t));o=this._appendArray(o,this._intToByteArray(i)),o=this._appendArray(o,this._intToByteArray(r)),await this.checkCommand("enter RAM download mode",this.ESP_MEM_BEGIN,o)}checksum(e,t=this.ESP_CHECKSUM_MAGIC){for(let i=0;i<e.length;i++)t^=e[i];return t}async memBlock(e,t){let i=this._appendArray(this._intToByteArray(e.length),this._intToByteArray(t));i=this._appendArray(i,this._intToByteArray(0)),i=this._appendArray(i,this._intToByteArray(0)),i=this._appendArray(i,e);const r=this.checksum(e);await this.checkCommand("write to target RAM",this.ESP_MEM_DATA,i,r)}async memFinish(e){const t=0===e?1:0,i=this._appendArray(this._intToByteArray(t),this._intToByteArray(e));await this.checkCommand("leave RAM download mode",this.ESP_MEM_END,i,void 0,200)}async flashSpiAttach(e){const t=this._intToByteArray(e);await this.checkCommand("configure SPI flash pins",this.ESP_SPI_ATTACH,t)}timeoutPerMb(e,t){const i=e*(t/1e6);return i<3e3?3e3:i}async flashBegin(e,t){const i=Math.floor((e+this.FLASH_WRITE_SIZE-1)/this.FLASH_WRITE_SIZE),r=this.chip.getEraseSize(t,e),o=new Date,a=o.getTime();let s=3e3;0==this.IS_STUB&&(s=this.timeoutPerMb(this.ERASE_REGION_TIMEOUT_PER_MB,e)),this.debug("flash begin "+r+" "+i+" "+this.FLASH_WRITE_SIZE+" "+t+" "+e);let n=this._appendArray(this._intToByteArray(r),this._intToByteArray(i));n=this._appendArray(n,this._intToByteArray(this.FLASH_WRITE_SIZE)),n=this._appendArray(n,this._intToByteArray(t)),0==this.IS_STUB&&(n=this._appendArray(n,this._intToByteArray(0))),await this.checkCommand("enter Flash download mode",this.ESP_FLASH_BEGIN,n,void 0,s);const l=o.getTime();return 0!=e&&0==this.IS_STUB&&this.info("Took "+(l-a)/1e3+"."+(l-a)%1e3+"s to erase flash block"),i}async flashDeflBegin(e,t,i){const r=Math.floor((t+this.FLASH_WRITE_SIZE-1)/this.FLASH_WRITE_SIZE),o=Math.floor((e+this.FLASH_WRITE_SIZE-1)/this.FLASH_WRITE_SIZE),a=new Date,s=a.getTime();let n,l;this.IS_STUB?(n=e,l=this.DEFAULT_TIMEOUT):(n=o*this.FLASH_WRITE_SIZE,l=this.timeoutPerMb(this.ERASE_REGION_TIMEOUT_PER_MB,n)),this.info("Compressed "+e+" bytes to "+t+"...");let d=this._appendArray(this._intToByteArray(n),this._intToByteArray(r));d=this._appendArray(d,this._intToByteArray(this.FLASH_WRITE_SIZE)),d=this._appendArray(d,this._intToByteArray(i)),"ESP32-S2"!==this.chip.CHIP_NAME&&"ESP32-S3"!==this.chip.CHIP_NAME&&"ESP32-C3"!==this.chip.CHIP_NAME&&"ESP32-C2"!==this.chip.CHIP_NAME||!1!==this.IS_STUB||(d=this._appendArray(d,this._intToByteArray(0))),await this.checkCommand("enter compressed flash mode",this.ESP_FLASH_DEFL_BEGIN,d,void 0,l);const c=a.getTime();return 0!=e&&!1===this.IS_STUB&&this.info("Took "+(c-s)/1e3+"."+(c-s)%1e3+"s to erase flash block"),r}async flashBlock(e,t,i){let r=this._appendArray(this._intToByteArray(e.length),this._intToByteArray(t));r=this._appendArray(r,this._intToByteArray(0)),r=this._appendArray(r,this._intToByteArray(0)),r=this._appendArray(r,e);const o=this.checksum(e);await this.checkCommand("write to target Flash after seq "+t,this.ESP_FLASH_DATA,r,o,i)}async flashDeflBlock(e,t,i){let r=this._appendArray(this._intToByteArray(e.length),this._intToByteArray(t));r=this._appendArray(r,this._intToByteArray(0)),r=this._appendArray(r,this._intToByteArray(0)),r=this._appendArray(r,e);const o=this.checksum(e);this.debug("flash_defl_block "+e[0].toString(16)+" "+e[1].toString(16)),await this.checkCommand("write compressed data to flash after seq "+t,this.ESP_FLASH_DEFL_DATA,r,o,i)}async flashFinish(e=!1){const t=e?0:1,i=this._intToByteArray(t);await this.checkCommand("leave Flash mode",this.ESP_FLASH_END,i)}async flashDeflFinish(e=!1){const t=e?0:1,i=this._intToByteArray(t);await this.checkCommand("leave compressed flash mode",this.ESP_FLASH_DEFL_END,i)}async runSpiflashCommand(e,t,i){const r=this.chip.SPI_REG_BASE,o=r+0,a=r+this.chip.SPI_USR_OFFS,s=r+this.chip.SPI_USR1_OFFS,n=r+this.chip.SPI_USR2_OFFS,l=r+this.chip.SPI_W0_OFFS;let d;d=null!=this.chip.SPI_MOSI_DLEN_OFFS?async(e,t)=>{const i=r+this.chip.SPI_MOSI_DLEN_OFFS,o=r+this.chip.SPI_MISO_DLEN_OFFS;e>0&&await this.writeReg(i,e-1),t>0&&await this.writeReg(o,t-1)}:async(e,t)=>{const i=s,r=(0===t?0:t-1)<<8|(0===e?0:e-1)<<17;await this.writeReg(i,r)};const c=1<<18;if(i>32)throw new gi("Reading more than 32 bits back from a SPI flash operation is unsupported");if(t.length>64)throw new gi("Writing more than 64 bytes of data with one SPI command is unsupported");const h=8*t.length,p=await this.readReg(a),u=await this.readReg(n);let f,m=1<<31;i>0&&(m|=268435456),h>0&&(m|=134217728),await d(h,i),await this.writeReg(a,m);let v=7<<28|e;if(await this.writeReg(n,v),0==h)await this.writeReg(l,0);else{if(t.length%4!=0){const e=new Uint8Array(t.length%4);t=this._appendArray(t,e)}let e=l;for(f=0;f<t.length-4;f+=4)v=this._byteArrayToInt(t[f],t[f+1],t[f+2],t[f+3]),await this.writeReg(e,v),e+=4}for(await this.writeReg(o,c),f=0;f<10&&(v=await this.readReg(o)&c,0!=v);f++);if(10===f)throw new gi("SPI command did not complete in time");const g=await this.readReg(l);return await this.writeReg(a,p),await this.writeReg(n,u),g}async readFlashId(){const e=new Uint8Array(0);return await this.runSpiflashCommand(159,e,24)}async eraseFlash(){this.info("Erasing flash (this may take a while)...");let e=new Date;const t=e.getTime(),i=await this.checkCommand("erase flash",this.ESP_ERASE_FLASH,void 0,void 0,this.CHIP_ERASE_TIMEOUT);e=new Date;const r=e.getTime();return this.info("Chip erase completed successfully in "+(r-t)/1e3+"s"),i}toHex(e){return Array.prototype.map.call(e,(e=>("00"+e.toString(16)).slice(-2))).join("")}async flashMd5sum(e,t){const i=this.timeoutPerMb(this.MD5_TIMEOUT_PER_MB,t);let r=this._appendArray(this._intToByteArray(e),this._intToByteArray(t));r=this._appendArray(r,this._intToByteArray(0)),r=this._appendArray(r,this._intToByteArray(0));let o=await this.checkCommand("calculate md5sum",this.ESP_SPI_FLASH_MD5,r,void 0,i);o instanceof Uint8Array&&o.length>16&&(o=o.slice(0,16));return this.toHex(o)}async readFlash(e,t,i=null){let r=this._appendArray(this._intToByteArray(e),this._intToByteArray(t));r=this._appendArray(r,this._intToByteArray(4096)),r=this._appendArray(r,this._intToByteArray(1024));const o=await this.checkCommand("read flash",this.ESP_READ_FLASH,r);if(0!=o)throw new gi("Failed to read memory: "+o);let a=new Uint8Array(0);for(;a.length<t;){const{value:e}=await this.transport.read(this.FLASH_READ_TIMEOUT).next();if(!(e instanceof Uint8Array))throw new gi("Failed to read memory: "+e);e.length>0&&(a=this._appendArray(a,e),await this.transport.write(this._intToByteArray(a.length)),i&&i(e,a.length,t))}return a}async runStub(){if(this.syncStubDetected)return this.info("Stub is already running. No upload is necessary."),this.chip;this.info("Uploading stub...");const e=await Ua(this.chip.CHIP_NAME);if(void 0===e)throw this.debug("Error loading Stub json"),new Error("Error loading Stub json");const t=[e.decodedText,e.decodedData];for(let i=0;i<t.length;i++)if(t[i]){const r=0===i?e.text_start:e.data_start,o=t[i].length,a=Math.floor((o+this.ESP_RAM_BLOCK-1)/this.ESP_RAM_BLOCK);await this.memBegin(o,a,this.ESP_RAM_BLOCK,r);for(let e=0;e<a;e++){const r=e*this.ESP_RAM_BLOCK,o=r+this.ESP_RAM_BLOCK;await this.memBlock(t[i].slice(r,o),e)}}this.info("Running stub..."),await this.memFinish(e.entry);const{value:i}=await this.transport.read(this.DEFAULT_TIMEOUT).next(),r=String.fromCharCode(...i);if("OHAI"!==r)throw new gi(`Failed to start stub. Unexpected response ${r}`);return this.info("Stub running..."),this.IS_STUB=!0,this.chip}async changeBaud(){this.info("Changing baudrate to "+this.baudrate);const e=this.IS_STUB?this.romBaudrate:0,t=this._appendArray(this._intToByteArray(this.baudrate),this._intToByteArray(e));await this.command(this.ESP_CHANGE_BAUDRATE,t),this.info("Changed"),await this.transport.disconnect(),await this._sleep(50),await this.transport.connect(this.baudrate,this.serialOptions)}async main(e="default_reset"){await this.detectChip(e);const t=await this.chip.getChipDescription(this);return this.info("Chip is "+t),this.info("Features: "+await this.chip.getChipFeatures(this)),this.info("Crystal is "+await this.chip.getCrystalFreq(this)+"MHz"),this.info("MAC: "+await this.chip.readMac(this)),await this.chip.readMac(this),void 0!==this.chip.postConnect&&await this.chip.postConnect(this),await this.runStub(),this.romBaudrate!==this.baudrate&&await this.changeBaud(),t}parseFlashSizeArg(e){if(void 0===this.chip.FLASH_SIZES[e])throw new gi("Flash size "+e+" is not supported by this chip type. Supported sizes: "+this.chip.FLASH_SIZES);return this.chip.FLASH_SIZES[e]}_updateImageFlashParams(e,t,i,r,o){if(this.debug("_update_image_flash_params "+i+" "+r+" "+o),e.length<8)return e;if(t!=this.chip.BOOTLOADER_FLASH_OFFSET)return e;if("keep"===i&&"keep"===r&&"keep"===o)return this.info("Not changing the image"),e;const a=parseInt(e[0]);let s=parseInt(e[2]);const n=parseInt(e[3]);if(a!==this.ESP_IMAGE_MAGIC)return this.info("Warning: Image file at 0x"+t.toString(16)+" doesn't look like an image file, so not changing any flash settings."),e;if("keep"!==r){s={qio:0,qout:1,dio:2,dout:3}[r]}let l=15&n;if("keep"!==o){l={"40m":0,"26m":1,"20m":2,"80m":15}[o]}let d=240&n;"keep"!==i&&(d=this.parseFlashSizeArg(i));const c=s<<8|l+d;return this.info("Flash params set to "+c.toString(16)),parseInt(e[2])!==s<<8&&(e=e.substring(0,2)+(s<<8).toString()+e.substring(3)),parseInt(e[3])!==l+d&&(e=e.substring(0,3)+(l+d).toString()+e.substring(4)),e}async writeFlash(e){if(this.debug("EspLoader program"),"keep"!==e.flashSize){const t=this.flashSizeBytes(e.flashSize);for(let i=0;i<e.fileArray.length;i++)if(e.fileArray[i].data.length+e.fileArray[i].address>t)throw new gi(`File ${i+1} doesn't fit in the available flash`)}let t,i;!0===this.IS_STUB&&!0===e.eraseAll&&await this.eraseFlash();for(let r=0;r<e.fileArray.length;r++){if(this.debug("Data Length "+e.fileArray[r].data.length),t=e.fileArray[r].data,this.debug("Image Length "+t.length),0===t.length){this.debug("Warning: File is empty");continue}t=this.ui8ToBstr(Na(this.bstrToUi8(t),4)),i=e.fileArray[r].address,t=this._updateImageFlashParams(t,i,e.flashSize,e.flashMode,e.flashFreq);let o=null;e.calculateMD5Hash&&(o=e.calculateMD5Hash(t),this.debug("Image MD5 "+o));const a=t.length;let s;if(e.compress){const e=this.bstrToUi8(t);t=this.ui8ToBstr(Ra(e,{level:9})),s=await this.flashDeflBegin(a,t.length,i)}else s=await this.flashBegin(a,i);let n=0,l=0;const d=t.length;e.reportProgress&&e.reportProgress(r,0,d);let c=new Date;const h=c.getTime();let p=5e3;const u=new Ia({chunkSize:1});let f=0;for(u.onData=function(e){f+=e.byteLength};t.length>0;){this.debug("Write loop "+i+" "+n+" "+s),this.info("Writing at 0x"+(i+f).toString(16)+"... ("+Math.floor(100*(n+1)/s)+"%)");const o=this.bstrToUi8(t.slice(0,this.FLASH_WRITE_SIZE));if(!e.compress)throw new gi("Yet to handle Non Compressed writes");{const e=f;u.push(o,!1);const t=f-e;let i=3e3;this.timeoutPerMb(this.ERASE_WRITE_TIMEOUT_PER_MB,t)>3e3&&(i=this.timeoutPerMb(this.ERASE_WRITE_TIMEOUT_PER_MB,t)),!1===this.IS_STUB&&(p=i),await this.flashDeflBlock(o,n,p),this.IS_STUB&&(p=i)}l+=o.length,t=t.slice(this.FLASH_WRITE_SIZE,t.length),n++,e.reportProgress&&e.reportProgress(r,l,d)}this.IS_STUB&&await this.readReg(this.CHIP_DETECT_MAGIC_REG_ADDR,p),c=new Date;const m=c.getTime()-h;if(e.compress&&this.info("Wrote "+a+" bytes ("+l+" compressed) at 0x"+i.toString(16)+" in "+m/1e3+" seconds."),o){const e=await this.flashMd5sum(i,a);if(new String(e).valueOf()!=new String(o).valueOf())throw this.info("File  md5: "+o),this.info("Flash md5: "+e),new gi("MD5 of file does not match data in flash!");this.info("Hash of data verified.")}}this.info("Leaving..."),this.IS_STUB&&(await this.flashBegin(0,0),e.compress?await this.flashDeflFinish():await this.flashFinish())}async flashId(){this.debug("flash_id");const e=await this.readFlashId();this.info("Manufacturer: "+(255&e).toString(16));const t=e>>16&255;this.info("Device: "+(e>>8&255).toString(16)+t.toString(16)),this.info("Detected flash size: "+this.DETECTED_FLASH_SIZES[t])}async getFlashSize(){this.debug("flash_id");const e=await this.readFlashId()>>16&255;return this.DETECTED_FLASH_SIZES_NUM[e]}async softReset(e){if(this.IS_STUB){if("ESP8266"!=this.chip.CHIP_NAME)throw new gi("Soft resetting is currently only supported on ESP8266");e?(await this.flashBegin(0,0),await this.flashFinish(!0)):await this.command(this.ESP_RUN_USER_CODE,void 0,void 0,!1)}else{if(e)return;await this.flashBegin(0,0),await this.flashFinish(!1)}}async after(e="hard_reset",t){switch(e){case"hard_reset":if(this.resetConstructors.hardReset){this.info("Hard resetting via RTS pin...");const e=this.resetConstructors.hardReset(this.transport,t);await e.reset()}break;case"soft_reset":this.info("Soft resetting..."),await this.softReset(!1);break;case"no_reset_stub":this.info("Staying in flasher stub.");break;default:this.info("Staying in bootloader."),this.IS_STUB&&this.softReset(!0)}}}const qa=async e=>{console.log("Triggering reset"),await e.device.setSignals({dataTerminalReady:!1,requestToSend:!0}),await we(250),await e.device.setSignals({dataTerminalReady:!1,requestToSend:!1}),await we(250),await new Promise((e=>setTimeout(e,1e3)))},Wa=(e,t="")=>{const i=new Blob([e],{type:"text/plain"}),r=URL.createObjectURL(i);((e,t="")=>{const i=document.createElement("a");i.target="_blank",i.href=e,i.download=t,document.body.appendChild(i),i.dispatchEvent(new MouseEvent("click")),document.body.removeChild(i)})(r,t),setTimeout((()=>URL.revokeObjectURL(r)),0)};class Za{constructor(e){this.port=e}async transferFile(e,t){try{if(this.port.readable&&this.port.writable||await this.port.open({baudRate:115200}),!this.port.writable||!this.port.readable)throw new Error("Serial port is not open or does not support reading/writing.");const i=this.port.writable.getWriter(),r=this.port.readable.getReader();try{const o=`create_file("${t}")\n`;await i.write((new TextEncoder).encode(o)),await this._waitForResponse(r,"OK");const a=await e.arrayBuffer(),s=this._splitIntoChunks(new Uint8Array(a),512);for(let e=0;e<s.length;e++){const o=`write_chunk("${t}", "${btoa(String.fromCharCode(...s[e]))}", ${e===s.length-1?"true":"false"})\n`;await i.write((new TextEncoder).encode(o)),await this._waitForResponse(r,"OK")}return console.log(`Fichier ${e.name} transféré avec succès vers ${t}`),!0}finally{i.releaseLock(),r.releaseLock()}}catch(e){return console.error("Erreur lors du transfert:",e),!1}}async _waitForResponse(e,t){const i=new TextDecoder;let r="";const o=setTimeout((()=>{throw new Error("Timeout waiting for response")}),5e3);try{for(;;){const{value:a,done:s}=await e.read();if(s)break;if(r+=i.decode(a),r.includes(t))return void clearTimeout(o)}}catch(e){throw clearTimeout(o),e}}_splitIntoChunks(e,t){const i=[];for(let r=0;r<e.length;r+=t)i.push(e.slice(r,r+t));return i}}const Va=async e=>{const t=new URL(e,location.toString()).toString(),i=await fetch(t),r=await i.json();return"new_install_skip_erase"in r&&(console.warn('Manifest option "new_install_skip_erase" is deprecated. Use "new_install_prompt_erase" instead.'),r.new_install_skip_erase&&(r.new_install_prompt_erase=!0)),r};console.log("ESP Web Tools 10.1.1 by Open Home Foundation; https://esphome.github.io/esp-web-tools/");class ja extends r{constructor(){super(...arguments),this.logger=console,this._state="DASHBOARD",this._installErase=!1,this._installConfirmed=!1,this._provisionForce=!1,this._wasProvisioned=!1,this._busy=!1,this._selectedSsid=null,this._bodyOverflow=null,this._appInstallProgress=0,this._appInstallStatus="",this._handleDisconnect=()=>{this._state="ERROR",this._error="Disconnected"}}render(){if(console.log("Méthode render appelée avec l'état:",this._state),!this.port)return o``;let e,t,i=!1;return void 0===this._client&&"INSTALL"!==this._state&&"LOGS"!==this._state&&"FILE_BROWSER"!==this._state?this._error?[e,t]=this._renderError(this._error):t=this._renderProgress("Connecting"):"INSTALL"===this._state?[e,t,i]=this._renderInstall():"ASK_ERASE"===this._state?[e,t]=this._renderAskErase():"ERROR"===this._state?[e,t]=this._renderError(this._error):"DASHBOARD"===this._state?([e,t,i]=this._client?this._renderDashboard():this._renderDashboardNoImprov(),console.log("État DASHBOARD détecté"),console.log("this._client:",this._client),this._client?(console.log("Appel de _renderDashboard"),[e,t,i]=this._renderDashboard()):(console.log("Appel de _renderDashboardNoImprov"),[e,t,i]=this._renderDashboardNoImprov())):"PROVISION"===this._state?[e,t]=this._renderProvision():"LOGS"===this._state?[e,t]=this._renderLogs():"FILE_BROWSER"===this._state?[e,t]=this._renderFileBrowser():"INSTALL_APP"===this._state&&([e,t,i]=this._renderInstallApp()),o`
      <ew-dialog
        open
        .heading=${e}
        @cancel=${this._preventDefault}
        @closed=${this._handleClose}
      >
        ${e?o`<div slot="headline">${e}</div>`:""}
        ${i?o`
              <ew-icon-button slot="headline" @click=${this._closeDialog}>
                ${ti}
              </ew-icon-button>
            `:""}
        ${t}
      </ew-dialog>
    `}_renderProgress(e,t){return o`
      <ewt-page-progress
        slot="content"
        .label=${e}
        .progress=${t}
      ></ewt-page-progress>
    `}_renderError(e){return["Error",o`
      <ewt-page-message
        slot="content"
        .icon=${"⚠️"}
        .label=${e}
      ></ewt-page-message>
      <div slot="actions">
        <ew-text-button @click=${this._closeDialog}>Close</ew-text-button>
      </div>
    `]}_renderDashboard(){const e=this._manifest.name;let t;return t=o`
    <div slot="content">
      <ew-list>
        <ew-list-item>
          <div slot="headline">Connected to ${this._info.name}</div>
          <div slot="supporting-text">
            ${this._info.firmware}&nbsp;${this._info.version}
            (${this._info.chipFamily})
          </div>
        </ew-list-item>
        
        ${this._isSameVersion?"":o`
              <ew-list-item
                type="button"
                @click=${()=>{this._isSameFirmware?this._startInstall(!1):this._manifest.new_install_prompt_erase?this._state="ASK_ERASE":this._startInstall(!0)}}
              >
                ${ri}
                <div slot="headline">
                  ${this._isSameFirmware?`Update ${this._manifest.name}`:`Install ${this._manifest.name}`}
                </div>
              </ew-list-item>
            `}
          
        ${void 0===this._client.nextUrl?"":o`
              <ew-list-item
                type="link"
                href=${this._client.nextUrl}
                target="_blank"
              >
                ${si}
                <div slot="headline">Visit Device</div>
              </ew-list-item>
            `}
            
        ${this._manifest.home_assistant_domain&&this._client.state===pi.PROVISIONED?o`
              <ew-list-item
                type="link"
                href=${`https://my.home-assistant.io/redirect/config_flow_start/?domain=${this._manifest.home_assistant_domain}`}
                target="_blank"
              >
                ${ni}
                <div slot="headline">Add to Home Assistant</div>
              </ew-list-item>
            `:""}
            
        <ew-list-item
          type="button"
          @click=${()=>{this._state="PROVISION",this._client.state===pi.PROVISIONED&&(this._provisionForce=!0)}}
        >
          ${oi}
          <div slot="headline">
            ${this._client.state===pi.READY?"Connect to Wi-Fi":"Change Wi-Fi"}
          </div>
        </ew-list-item>
        
        <ew-list-item
          type="button"
          @click=${async()=>{const e=this._client;e&&(await this._closeClientWithoutEvents(e),await we(100)),this._client=void 0,this._state="LOGS"}}
        >
          ${ai}
          <div slot="headline">Logs & Console</div>
        </ew-list-item>
        
        <ew-list-item
          type="button"
          @click=${async()=>{const e=this._client;e&&(await this._closeClientWithoutEvents(e),await we(100)),this._client=void 0,this._state="FILE_BROWSER"}}
        >
          <div slot="start">📁</div>
          <div slot="headline">File Browser</div>
        </ew-list-item>
        
        ${this._isSameFirmware&&this._manifest.funding_url?o`
              <ew-list-item
                type="link"
                href=${this._manifest.funding_url}
                target="_blank"
              >
                ${di}
                <div slot="headline">Fund Development</div>
              </ew-list-item>
            `:""}
          
        ${this._isSameVersion?o`
              <ew-list-item
                type="button"
                class="danger"
                @click=${()=>this._startInstall(!0)}
              >
                ${li}
                <div slot="headline">Erase User Data</div>
              </ew-list-item>
            `:""}

        <ew-list-item
          type="button"
          @click=${()=>{this.manifestPath?this._installAppFromManifest():this._state="INSTALL_APP"}}
          >
            <div slot="start">📦</div>
            <div slot="headline">Install App</div>
        </ew-list-item>
        
      </ew-list>
    </div>
  `,[e,t,!0]}_renderDashboardNoImprov(){const e=this._manifest.name;let t;return t=o`
      <div slot="content">
        <ew-list>
          <ew-list-item
            type="button"
            @click=${()=>{this._manifest.new_install_prompt_erase?this._state="ASK_ERASE":this._startInstall(!0)}}
          >
            ${ri}
            <div slot="headline">${`Install ${this._manifest.name}`}</div>
          </ew-list-item>
          
          <ew-list-item
            type="button"
            @click=${async()=>{this._client=void 0,this._state="LOGS"}}
          >
            ${ai}
            <div slot="headline">Logs & Console</div>
          </ew-list-item>
          
          <ew-list-item
            type="button"
            @click=${async()=>{this._client=void 0,this._state="FILE_BROWSER"}}
          >
            <div slot="start">📁</div>
            <div slot="headline">File Browser</div>
          </ew-list-item>
          
        <ew-list-item
          type="button"
          @click=${()=>{this.manifestPath?this._installAppFromManifest():this._state="INSTALL_APP"}}
          >
            <div slot="start">📦</div>
            <div slot="headline">Install App</div>
        </ew-list-item>
          
        </ew-list>
      </div>
    `,[e,t,!0]}_renderProvision(){var e;let t,i="Configure Wi-Fi";if(this._busy)return[i,this._renderProgress(void 0===this._ssids?"Scanning for networks":"Trying to connect")];if(this._provisionForce||this._client.state!==pi.PROVISIONED){let i;switch(this._client.error){case 3:i="Unable to connect";break;case 254:i="Timeout";break;case 0:case 2:break;default:i=`Unknown error (${this._client.error})`}const r=null===(e=this._ssids)||void 0===e?void 0:e.find((e=>e.name===this._selectedSsid));t=o`
        <ew-icon-button slot="headline" @click=${this._updateSsids}>
          ${ii}
        </ew-icon-button>
        <div slot="content">
          <div>Connect your device to the network to start using it.</div>
          ${i?o`<p class="error">${i}</p>`:""}
          ${null!==this._ssids?o`
                <ew-filled-select
                  menu-positioning="fixed"
                  label="Network"
                  @change=${e=>{const t=e.target.selectedIndex;this._selectedSsid=t===this._ssids.length?null:this._ssids[t].name}}
                >
                  ${this._ssids.map((e=>o`
                      <ew-select-option
                        .selected=${r===e}
                        .value=${e.name}
                      >
                        ${e.name}
                      </ew-select-option>
                    `))}
                  <ew-divider></ew-divider>
                  <ew-select-option .selected=${!r}>
                    Join other…
                  </ew-select-option>
                </ew-filled-select>
              `:""}
          ${r?"":o`
                  <ew-filled-text-field
                    label="Network Name"
                    name="ssid"
                  ></ew-filled-text-field>
                `}
          ${!r||r.secured?o`
                <ew-filled-text-field
                  label="Password"
                  name="password"
                  type="password"
                ></ew-filled-text-field>
              `:""}
        </div>
        <div slot="actions">
          <ew-text-button
            @click=${()=>{this._state="DASHBOARD"}}
          >
            ${this._installState&&this._installErase?"Skip":"Back"}
          </ew-text-button>
          <ew-text-button @click=${this._doProvision}>Connect</ew-text-button>
        </div>
      `}else{i=void 0;const e=!this._wasProvisioned&&(void 0!==this._client.nextUrl||"home_assistant_domain"in this._manifest);t=o`
        <div slot="content">
          <ewt-page-message
            .icon=${"🎉"}
            label="Device connected to the network!"
          ></ewt-page-message>
          ${e?o`
                <ew-list>
                  ${void 0===this._client.nextUrl?"":o`
                        <ew-list-item
                          type="link"
                          href=${this._client.nextUrl}
                          target="_blank"
                          @click=${()=>{this._state="DASHBOARD"}}
                        >
                          ${si}
                          <div slot="headline">Visit Device</div>
                        </ew-list-item>
                      `}
                  ${this._manifest.home_assistant_domain?o`
                        <ew-list-item
                          type="link"
                          href=${`https://my.home-assistant.io/redirect/config_flow_start/?domain=${this._manifest.home_assistant_domain}`}
                          target="_blank"
                          @click=${()=>{this._state="DASHBOARD"}}
                        >
                          ${ni}
                          <div slot="headline">Add to Home Assistant</div>
                        </ew-list-item>
                      `:""}
                  <ew-list-item
                    type="button"
                    @click=${()=>{this._state="DASHBOARD"}}
                  >
                    <div slot="start" class="fake-icon"></div>
                    <div slot="headline">Skip</div>
                  </ew-list-item>
                </ew-list>
              `:""}
        </div>

        ${e?"":o`
              <div slot="actions">
                <ew-text-button
                  @click=${()=>{this._state="DASHBOARD"}}
                >
                  Continue
                </ew-text-button>
              </div>
            `}
      `}return[i,t]}_renderAskErase(){return["Erase device",o`
      <div slot="content">
        <div>
          Do you want to erase the device before installing
          ${this._manifest.name}? All data on the device will be lost.
        </div>
        <label class="formfield">
          <ew-checkbox touch-target="wrapper" class="danger"></ew-checkbox>
          Erase device
        </label>
      </div>
      <div slot="actions">
        <ew-text-button
          @click=${()=>{this._state="DASHBOARD"}}
        >
          Back
        </ew-text-button>
        <ew-text-button
          @click=${()=>{const e=this.shadowRoot.querySelector("ew-checkbox");this._startInstall(e.checked)}}
        >
          Next
        </ew-text-button>
      </div>
    `]}_renderInstall(){let e,t;const i=!this._installErase&&this._isSameFirmware;if(!this._installConfirmed&&this._isSameVersion)e="Erase User Data",t=o`
        <div slot="content">
          Do you want to reset your device and erase all user data from your
          device?
        </div>
        <div slot="actions">
          <ew-text-button class="danger" @click=${this._confirmInstall}>
            Erase User Data
          </ew-text-button>
        </div>
      `;else if(this._installConfirmed)if(this._installState&&"initializing"!==this._installState.state&&"preparing"!==this._installState.state)if("erasing"===this._installState.state)e="Installing",t=this._renderProgress("Erasing");else if("writing"===this._installState.state||"finished"===this._installState.state&&void 0===this._client){let i,r;e="Installing","finished"===this._installState.state?r="Wrapping up":this._installState.details.percentage<4?r="Installing":i=this._installState.details.percentage,t=this._renderProgress(o`
          ${r?o`${r}<br />`:""}
          <br />
          This will take
          ${"ESP8266"===this._installState.chipFamily?"a minute":"2 minutes"}.<br />
          Keep this page visible to prevent slow down
        `,i)}else if("finished"===this._installState.state){e=void 0;const i=null!==this._client;t=o`
        <ewt-page-message
          slot="content"
          .icon=${"🎉"}
          label="Installation complete!"
        ></ewt-page-message>

        <div slot="actions">
          <ew-text-button
            @click=${()=>{this._state=i&&this._installErase?"PROVISION":"DASHBOARD"}}
          >
            Next
          </ew-text-button>
        </div>
      `}else"error"===this._installState.state&&(e="Installation failed",t=o`
        <ewt-page-message
          slot="content"
          .icon=${"⚠️"}
          .label=${this._installState.message}
        ></ewt-page-message>
        <div slot="actions">
          <ew-text-button
            @click=${async()=>{this._initialize(),this._state="DASHBOARD"}}
          >
            Back
          </ew-text-button>
        </div>
      `);else e="Installing",t=this._renderProgress("Preparing installation");else{e="Confirm Installation";const r=i?"update to":"install";t=o`
        <div slot="content">
          ${i?o`Your device is running
                ${this._info.firmware}&nbsp;${this._info.version}.<br /><br />`:""}
          Do you want to ${r}
          ${this._manifest.name}&nbsp;${this._manifest.version}?
          ${this._installErase?o`<br /><br />All data on the device will be erased.`:""}
        </div>
        <div slot="actions">
          <ew-text-button
            @click=${()=>{this._state="DASHBOARD"}}
          >
            Back
          </ew-text-button>
          <ew-text-button @click=${this._confirmInstall}>
            Install
          </ew-text-button>
        </div>
      `}return[e,t,!1]}_renderLogs(){let e;return e=o`
      <div slot="content">
        <ewt-console .port=${this.port} .logger=${this.logger}></ewt-console>
      </div>
      <div slot="actions">
        <ew-text-button
          @click=${async()=>{await this.shadowRoot.querySelector("ewt-console").reset()}}
        >
          Reset Device
        </ew-text-button>
        <ew-text-button
          @click=${()=>{Wa(this.shadowRoot.querySelector("ewt-console").logs(),"esp-web-tools-logs.txt"),this.shadowRoot.querySelector("ewt-console").reset()}}
        >
          Download Logs
        </ew-text-button>
        <ew-text-button
          @click=${async()=>{await this.shadowRoot.querySelector("ewt-console").disconnect(),this._state="DASHBOARD",this._initialize()}}
        >
          Back
        </ew-text-button>
      </div>
    `,["Logs",e]}_renderFileBrowser(){let e;return e=o`
    <div slot="content">
      <ewt-file-browser .port=${this.port} .logger=${this.logger}></ewt-file-browser>
    </div>
    <div slot="actions">
      <ew-text-button @click=${async()=>{await this.shadowRoot.querySelector("ewt-file-browser").disconnect(),this._state="DASHBOARD",this._initialize()}}>Back</ew-text-button>
    </div>
  `,["File Browser",e]}_renderInstallApp(){let e;return e=o`
      <div slot="content">
        <p>Select an app file to install in the /apps/ folder:</p>
        <input 
          type="file" 
          id="app-file-input" 
          style="display: none;" 
          @change=${this._handleAppFileChange}
        >
        <ew-text-button @click=${()=>{var e,t;null===(t=null===(e=this.shadowRoot)||void 0===e?void 0:e.querySelector("#app-file-input"))||void 0===t||t.click()}}>
          Select App File
        </ew-text-button>
        
        ${this._selectedAppFile?o`
          <div>Selected: ${this._selectedAppFile.name}</div>
          
          <div class="progress-container">
            <div class="progress-bar">
              <div class="progress" style="width: ${this._appInstallProgress}%"></div>
            </div>
            <div>${this._appInstallStatus}</div>
          </div>
        `:""}
      </div>
      
      <div slot="actions">
        <ew-text-button @click=${()=>{this._state="DASHBOARD",this._selectedAppFile=void 0,this._appInstallProgress=0,this._appInstallStatus=""}}>
          Back
        </ew-text-button>
        <ew-text-button 
          ?disabled=${!this._selectedAppFile} 
          @click=${this._installApp}
        >
          Install
        </ew-text-button>
      </div>
    `,["Install App",e,!0]}willUpdate(e){e.has("_state")&&(console.log("Changement d'état détecté:",{from:e.get("_state"),to:this._state}),"ERROR"!==this._state&&(this._error=void 0),"PROVISION"===this._state?this._updateSsids():this._provisionForce=!1,"INSTALL"===this._state&&(this._installConfirmed=!1,this._installState=void 0))}async _updateSsids(e=0){const t=this._ssids;let i;this._ssids=void 0,this._busy=!0;try{i=await this._client.scan()}catch(e){return void 0===this._ssids&&(this._ssids=null,this._selectedSsid=null),void(this._busy=!1)}if(0===i.length&&e<3)return console.log("SCHEDULE RETRY",e),void setTimeout((()=>this._updateSsids(e+1)),1e3);t?this._selectedSsid&&!i.find((e=>e.name===this._selectedSsid))&&(this._selectedSsid=i[0].name):this._selectedSsid=i.length?i[0].name:null,this._ssids=i,this._busy=!1}firstUpdated(e){super.firstUpdated(e),this._bodyOverflow=document.body.style.overflow,document.body.style.overflow="hidden",this._initialize()}updated(e){super.updated(e),e.has("_state")&&this.setAttribute("state",this._state),"PROVISION"===this._state&&(e.has("_selectedSsid")&&null===this._selectedSsid?this._focusFormElement("ew-filled-text-field[name=ssid]"):e.has("_ssids")&&this._focusFormElement(),e.has("manifestPath")&&this.manifestPath&&(e.get("manifestPath")||this._initialize()))}_focusFormElement(e="ew-filled-text-field, ew-filled-select"){const t=this.shadowRoot.querySelector(e);t&&t.updateComplete.then((()=>setTimeout((()=>t.focus()),100)))}async _initialize(e=!1){if(null===this.port.readable||null===this.port.writable)return this._state="ERROR",void(this._error="Serial port is not readable/writable. Close any other application using it and try again.");try{this._manifest=await Va(this.manifestPath)}catch(e){return this._state="ERROR",void(this._error="Failed to download manifest")}if(0===this._manifest.new_install_improv_wait_time)return void(this._client=null);const t=new vi(this.port,this.logger);t.addEventListener("state-changed",(()=>{this.requestUpdate()})),t.addEventListener("error-changed",(()=>this.requestUpdate()));try{const i=e?void 0!==this._manifest.new_install_improv_wait_time?1e3*this._manifest.new_install_improv_wait_time:1e4:1e3;this._info=await t.initialize(i),this._client=t,t.addEventListener("disconnect",this._handleDisconnect)}catch(e){this._info=void 0,e instanceof fi?(this._state="ERROR",this._error="Serial port is not ready. Close any other application using it and try again."):(this._client=null,this.logger.error("Improv initialization failed.",e))}}_startInstall(e){this._state="INSTALL",this._installErase=e,this._installConfirmed=!1}async _confirmInstall(){this._installConfirmed=!0,this._installState=void 0,this._client&&await this._closeClientWithoutEvents(this._client),this._client=void 0,await this.port.close(),(async(e,t,i,r,o)=>{let a,s;const n=t=>e({...t,manifest:r,build:a,chipFamily:s}),l=new $a(t),d=new Ha({transport:l,baudrate:115200,romBaudrate:115200,enableTracing:!1});window.esploader=d,n({state:"initializing",message:"Initializing...",details:{done:!1}});try{await d.main(),await d.flashId()}catch(e){return console.error(e),n({state:"error",message:"Failed to initialize. Try resetting your device or holding the BOOT button while clicking INSTALL.",details:{error:"failed_initialize",details:e}}),await qa(l),void await l.disconnect()}if(s=d.chip.CHIP_NAME,n({state:"initializing",message:`Initialized. Found ${s}`,details:{done:!0}}),a=r.builds.find((e=>e.chipFamily===s)),!a)return n({state:"error",message:`Your ${s} board is not supported.`,details:{error:"not_supported",details:s}}),await qa(l),void await l.disconnect();n({state:"preparing",message:"Preparing installation...",details:{done:!1}});const c=new URL(i,location.toString()).toString(),h=a.parts.map((async e=>{const t=new URL(e.path,c).toString(),i=await fetch(t);if(!i.ok)throw new Error(`Downlading firmware ${e.path} failed: ${i.status}`);const r=new FileReader,o=await i.blob();return new Promise((e=>{r.addEventListener("load",(()=>e(r.result))),r.readAsBinaryString(o)}))})),p=[];let u=0;for(let e=0;e<h.length;e++)try{const t=await h[e];p.push({data:t,address:a.parts[e].offset}),u+=t.length}catch(e){return n({state:"error",message:e.message,details:{error:"failed_firmware_download",details:e.message}}),await qa(l),void await l.disconnect()}n({state:"preparing",message:"Installation prepared",details:{done:!0}}),o&&(n({state:"erasing",message:"Erasing device...",details:{done:!1}}),await d.eraseFlash(),n({state:"erasing",message:"Device erased",details:{done:!0}})),n({state:"writing",message:"Writing progress: 0%",details:{bytesTotal:u,bytesWritten:0,percentage:0}});let f=0;try{await d.writeFlash({fileArray:p,flashSize:"keep",flashMode:"keep",flashFreq:"keep",eraseAll:!1,compress:!0,reportProgress:(e,t,i)=>{const r=t/i*p[e].data.length,o=Math.floor((f+r)/u*100);t!==i?n({state:"writing",message:`Writing progress: ${o}%`,details:{bytesTotal:u,bytesWritten:f+t,percentage:o}}):f+=r}})}catch(e){return n({state:"error",message:e.message,details:{error:"write_failed",details:e}}),await qa(l),void await l.disconnect()}n({state:"writing",message:"Writing complete",details:{bytesTotal:u,bytesWritten:f,percentage:100}}),await qa(l),console.log("DISCONNECT"),await l.disconnect(),n({state:"finished",message:"All done!"})})((e=>{this._installState=e,"finished"===e.state?we(100).then((()=>this.port.open({baudRate:115200,bufferSize:8192}))).then((()=>this._initialize(!0))).then((()=>this.requestUpdate())):"error"===e.state&&we(100).then((()=>this.port.open({baudRate:115200,bufferSize:8192})))}),this.port,this.manifestPath,this._manifest,this._installErase)}async _doProvision(){var e;this._busy=!0,this._wasProvisioned=this._client.state===pi.PROVISIONED;const t=null===this._selectedSsid?this.shadowRoot.querySelector("ew-filled-text-field[name=ssid]").value:this._selectedSsid,i=(null===(e=this.shadowRoot.querySelector("ew-filled-text-field[name=password]"))||void 0===e?void 0:e.value)||"";try{await this._client.provision(t,i,3e4)}catch(e){return}finally{this._busy=!1,this._provisionForce=!1}}_closeDialog(){this.shadowRoot.querySelector("ew-dialog").close()}async _handleClose(){this._client&&await this._closeClientWithoutEvents(this._client),((e,t,i,r)=>{r=r||{};const o=new CustomEvent(t,{bubbles:void 0===r.bubbles||r.bubbles,cancelable:Boolean(r.cancelable),composed:void 0===r.composed||r.composed,detail:i});e.dispatchEvent(o)})(this,"closed"),document.body.style.overflow=this._bodyOverflow,this.parentNode.removeChild(this)}get _isSameFirmware(){var e;return!!this._info&&((null===(e=this.overrides)||void 0===e?void 0:e.checkSameFirmware)?this.overrides.checkSameFirmware(this._manifest,this._info):this._info.firmware===this._manifest.name)}get _isSameVersion(){return this._isSameFirmware&&this._info.version===this._manifest.version}async _closeClientWithoutEvents(e){e.removeEventListener("disconnect",this._handleDisconnect),await e.close()}_preventDefault(e){e.preventDefault()}async _installAppFromManifest(){if(this.manifestPath){console.log("Téléchargement du manifest depuis:",this.manifestPath),this._appInstallStatus="Downloading manifest...",this._appInstallProgress=0;try{const e=await Va(this.manifestPath);console.log("Manifest téléchargé avec succès"),console.log("Contenu du manifest:",e),this._appInstallStatus="Preparing installation...",this._appInstallProgress=10;const t=e.name||e.id||"app",i=`/apps/${t}/`;let r;await this._ensurePathExists(i),this._appInstallProgress=20;try{const e=new URL(this.manifestPath,window.location.origin);console.log("URL absolue du manifest:",e.href);const t=e.pathname.split("/");t.pop();const i=t.indexOf("public");-1!==i&&t.splice(i,1);const o=t.join("/");r=`${e.origin}${o}/`,console.log("URL de base reconstruite:",r)}catch(e){console.error("Erreur lors de la reconstruction de l'URL de base:",e);const t=this.manifestPath.split("/");t.pop();const i=t.indexOf("public");-1!==i&&t.splice(i,1);const o=t.join("/");r=o.replace("/apps/","/storage/apps/")+"/",console.log("URL de base (secours):",r)}const o=e.files||[],a=o.length;if(0===a)return console.warn("Aucun fichier trouvé dans le manifest. L'installation va échouer."),void(this._appInstallStatus="Error: No files found in manifest");console.log(`${a} fichiers à télécharger`);for(let e=0;e<a;e++){const t=o[e];let s;this._appInstallStatus=`Downloading ${t.name} (${e+1}/${a})...`;try{s=new URL(t.url,r).href}catch(e){s=r+t.url}console.log(`Téléchargement de ${t.name} depuis ${s}`);const n=await fetch(s);if(!n.ok)throw new Error(`Failed to download ${t.name}: ${n.statusText}`);const l=await n.blob();if(console.log(`Fichier ${t.name} téléchargé, taille: ${l.size} octets`),t.name.endsWith(".txt")||t.name.endsWith(".json")||t.name.endsWith(".lua")){const e=await l.text();console.log(`Aperçu du contenu de ${t.name}:`,e.substring(0,100)+(e.length>100?"...":""))}await this._uploadBlobToFolder(l,t.name,i)?console.log(`Fichier ${t.name} traité avec succès`):console.error(`Échec du traitement du fichier ${t.name}`),this._appInstallProgress=20+(e+1)/a*70}this._appInstallProgress=100,this._appInstallStatus="Installation terminée!";const s=document.createElement("div");s.style.position="fixed",s.style.top="50%",s.style.left="50%",s.style.transform="translate(-50%, -50%)",s.style.backgroundColor="white",s.style.padding="20px",s.style.borderRadius="10px",s.style.boxShadow="0 4px 8px rgba(0,0,0,0.1)",s.style.zIndex="1000",s.style.maxWidth="80%",s.style.maxHeight="80vh",s.style.overflowY="auto",s.innerHTML=`\n        <h3>Installation terminée!</h3>\n        <p>${a} fichiers ont été téléchargés:</p>\n        <ul>\n          ${o.map((e=>`<li>${e.name}</li>`)).join("")}\n        </ul>\n        <p><strong>Instructions:</strong></p>\n        <ol>\n          <li>Tous les fichiers ont été téléchargés sur votre ordinateur</li>\n          <li>Connectez-vous à votre ESP32</li>\n          <li>Transférez ces fichiers vers le dossier <strong>/apps/${t}/</strong> sur l'ESP32</li>\n          <li>Redémarrez votre ESP32 pour lancer l'application</li>\n        </ol>\n        <button id="close-summary" style="margin-top: 10px; padding: 8px 16px; background: #4CAF50; color: white; border: none; border-radius: 4px; cursor: pointer;">Fermer</button>\n      `,document.body.appendChild(s);const n=document.getElementById("close-summary");n&&n.addEventListener("click",(()=>{document.body.removeChild(s)})),setTimeout((()=>{this._state="DASHBOARD",this._appInstallProgress=0,this._appInstallStatus=""}),15e3)}catch(e){console.error("Failed to install app from manifest:",e),this._appInstallStatus=`Error: ${e instanceof Error?e.message:String(e)}`}}else console.error("Aucune URL de manifest fournie")}async _uploadBlobToFolder(e,t,i){try{console.log(`Début du transfert du fichier ${t} vers ${i}`);const r=new Za(this.port),o=new File([e],t,{type:e.type});console.log(`Fichier converti: ${o.name}, taille: ${o.size} octets`);const a=`${i}${t}`;console.log(`Chemin cible: ${a}`),console.log(`Transfert du fichier vers ${a}...`);if(await r.transferFile(o,a))return console.log(`Fichier ${t} transféré avec succès vers ${i}`),!0;throw new Error("Le transfert a échoué")}catch(e){throw console.error(`Erreur lors du transfert du fichier ${t}:`,e),new Error(`Failed to transfer ${t}: ${e instanceof Error?e.message:String(e)}`)}}_handleAppFileChange(e){const t=e.target;t.files&&t.files.length>0&&(this._selectedAppFile=t.files[0])}async _installApp(){if(this._selectedAppFile){this._appInstallStatus="Preparing...",this._appInstallProgress=0;try{this._appInstallStatus="Creating /apps/ folder...",await this._ensureAppsFolderExists(),this._appInstallProgress=20,this._appInstallStatus=`Uploading ${this._selectedAppFile.name}...`,await this._uploadFileToApps(this._selectedAppFile),this._appInstallProgress=100,this._appInstallStatus="Installation complete!",setTimeout((()=>{this._state="DASHBOARD",this._selectedAppFile=void 0,this._appInstallProgress=0,this._appInstallStatus=""}),2e3)}catch(e){console.error("Failed to install app:",e),this._appInstallStatus=`Error: ${e instanceof Error?e.message:String(e)}`}}}async _ensureAppsFolderExists(){try{(await fetch("/api/files/mkdir",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:"/apps/"})})).ok||console.log("Folder /apps/ already exists or was created")}catch(e){throw console.warn("Could not verify /apps/ folder:",e),e}}async _ensurePathExists(e){try{(await fetch("/api/files/mkdir",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:e})})).ok||console.log(`Folder ${e} already exists or was created`)}catch(t){throw console.warn(`Could not verify folder ${e}:`,t),t}}async _uploadFileToApps(e){const t=new FormData;t.append("file",e),t.append("path","/apps/");try{const i=await fetch("/api/files/upload",{method:"POST",body:t});if(!i.ok)throw new Error(`Failed to upload ${e.name}: ${i.statusText}`);console.log(`File ${e.name} uploaded to /apps/`)}catch(t){throw console.error(`Error uploading ${e.name}:`,t),t}}}ja.styles=[R,a`
      :host {
        --mdc-dialog-max-width: 390px;
      }
      div[slot="headline"] {
        padding-right: 48px;
      }
      ew-icon-button[slot="headline"] {
        position: absolute;
        right: 4px;
        top: 8px;
      }
      ew-icon-button[slot="headline"] svg {
        padding: 8px;
        color: var(--text-color);
      }
      .dialog-nav svg {
        color: var(--text-color);
      }
      .table-row {
        display: flex;
      }
      .table-row.last {
        margin-bottom: 16px;
      }
      .table-row svg {
        width: 20px;
        margin-right: 8px;
      }
      ew-filled-text-field,
      ew-filled-select {
        display: block;
        margin-top: 16px;
      }
      label.formfield {
        display: inline-flex;
        align-items: center;
        padding-right: 8px;
      }
      ew-list {
        margin: 0 -24px;
        padding: 0;
      }
      ew-list-item svg {
        height: 24px;
      }
      ewt-page-message + ew-list {
        padding-top: 16px;
      }
      .fake-icon {
        width: 24px;
      }
      .error {
        color: var(--danger-color);
      }
      .danger {
        --mdc-theme-primary: var(--danger-color);
        --mdc-theme-secondary: var(--danger-color);
        --md-sys-color-primary: var(--danger-color);
        --md-sys-color-on-surface: var(--danger-color);
      }
      button.link {
        background: none;
        color: inherit;
        border: none;
        padding: 0;
        font: inherit;
        text-align: left;
        text-decoration: underline;
        cursor: pointer;
      }
      :host([state="LOGS"]) ew-dialog {
        max-width: 90vw;
        max-height: 90vh;
      }
      ewt-console {
        width: calc(80vw - 48px);
        height: calc(90vh - 168px);
      }
      .progress-container {
        margin: 15px 0;
      }
      .progress-bar {
        height: 20px;
        background-color: #e0e0e0;
        border-radius: 10px;
        overflow: hidden;
      }
      .progress {
        height: 100%;
        background-color: #4CAF50;
        width: 0%;
        transition: width 0.3s;
      }
    `],t([v()],ja.prototype,"_client",void 0),t([v()],ja.prototype,"_state",void 0),t([v()],ja.prototype,"_installErase",void 0),t([v()],ja.prototype,"_installConfirmed",void 0),t([v()],ja.prototype,"_installState",void 0),t([v()],ja.prototype,"_provisionForce",void 0),t([v()],ja.prototype,"_error",void 0),t([v()],ja.prototype,"_busy",void 0),t([v()],ja.prototype,"_ssids",void 0),t([v()],ja.prototype,"_selectedSsid",void 0),t([v()],ja.prototype,"_selectedAppFile",void 0),t([v()],ja.prototype,"_appInstallProgress",void 0),t([v()],ja.prototype,"_appInstallStatus",void 0),customElements.define("ewt-install-dialog",ja);export{ja as EwtInstallDialog};
